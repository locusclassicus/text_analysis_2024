# –ü—Ä–∏–ª–æ–∂–µ–Ω–∏—è Shiny

## –°–æ–∑–¥–∞–Ω–∏–µ –¥–∏—Ä–µ–∫—Ç–æ—Ä–∏–∏ –∏ —Ñ–∞–π–ª–∞ –ø—Ä–∏–ª–æ–∂–µ–Ω–∏—è

1. `File` -> `New Project` -> `New Directory` -> `Shiny Application`

2. –§–∞–π–ª `App.R` —Å–æ–¥–µ—Ä–∂–∏—Ç —Å–∫—Ä–∏–ø—Ç, –∫–æ—Ç–æ—Ä—ã–π 

- –æ–ø—Ä–µ–¥–µ–ª—è–µ—Ç –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å—Å–∫–∏–π –∏–Ω—Ç–µ—Ä—Ñ–µ–π—Å - —Å—Ç—Ä–∞–Ω–∏—Ü—É html, —Å –∫–æ—Ç–æ—Ä–æ–π –±—É–¥–µ—Ç –≤–∑–∞–∏–º–æ–¥–µ–π—Å—Ç–≤–æ–≤–∞—Ç—å –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å
- —Ñ–æ—Ä–º–∏—Ä—É–µ—Ç –ø–æ–≤–µ–¥–µ–Ω–∏–µ –ø—Ä–∏–ª–æ–∂–µ–Ω–∏—è –ø—É—Ç–µ–º –æ–ø—Ä–µ–¥–µ–ª–µ–Ω–∏—è —Ñ—É–Ω–∫—Ü–∏–∏ server
- –≤—ã–∑—ã–≤–∞–µ—Ç —Ñ—É–Ω–∫—Ü–∏—é `shiny(ui, server)` –¥–ª—è —Å–±–æ—Ä–∫–∏ –∏ –∑–∞–ø—É—Å–∫–∞ –ø—Ä–∏–ª–æ–∂–µ–Ω–∏—è

–ó–∞–ø—É—Å—Ç–∏—Ç—å –ø—Ä–∏–ª–æ–∂–µ–Ω–∏–µ –º–æ–∂–Ω–æ –∫–Ω–æ–ø–∫–æ–π `Run App`. 

:::{.callout-note icon=false}
–ü—Ä–∏ –∑–∞–ø—É—â–µ–Ω–Ω–æ–º –ø—Ä–∏–ª–æ–∂–µ–Ω–∏–∏ –æ–±–æ–ª–æ—á–∫–∞ R –ø–µ—Ä–µ—Ö–æ–¥–∏—Ç –≤ —Å–æ—Å—Ç–æ—è–Ω–∏–µ –∑–∞–Ω—è—Ç–æ—Å—Ç–∏: –∫–æ–º–∞–Ω–¥–Ω–∞—è —Å—Ç—Ä–æ–∫–∞ –Ω–µ –≤–∏–¥–Ω–∞, –∞ –Ω–∞ –ø–∞–Ω–µ–ª–∏ –∏–Ω—Å—Ç—Ä—É–º–µ–Ω—Ç–æ–≤ –≤ –∫–æ–Ω—Å–æ–ª–∏ –ø–æ–∫–∞–∑—ã–≤–∞–µ—Ç—Å—è –∏–∫–æ–Ω–∫–∞ —Å —Å–∏–º–≤–æ–ª–æ–º –æ—Å—Ç–∞–Ω–æ–≤–∫–∏.
:::

## –≠–ª–µ–º–µ–Ω—Ç—ã –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å—Å–∫–æ–≥–æ –∏–Ω—Ç–µ—Ä—Ñ–µ–π—Å–∞ 

### –ú–∞–∫–µ—Ç –∏ –∑–∞–≥–æ–ª–æ–≤–∫–∏

–í —Å–æ–∑–¥–∞–Ω–Ω–æ–º –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏ —Ñ–∞–π–ª–µ –≤—ã –≤–∏–¥–∏—Ç–µ —Å–ª–µ–¥—É—é—â–µ–µ.

```{r eval=FALSE}
ui <- fluidPage(

    # Application title
    titlePanel("Old Faithful Geyser Data"),

    # Sidebar with a slider input for number of bins 
    sidebarLayout(
        sidebarPanel(
            sliderInput("bins",
                        "Number of bins:",
                        min = 1,
                        max = 50,
                        value = 30)
        ),

        # Show a plot of the generated distribution
        mainPanel(
           plotOutput("distPlot")
        )
    )
)
```

–ó–¥–µ—Å—å: 

- `fluidPage()` - —Ñ—É–Ω–∫—Ü–∏—è —Ä–∞–∑–º–µ—Ç–∫–∏, –æ—Ç–≤–µ—á–∞—é—â–∞—è –∑–∞ –≤–∏–∑—É–∞–ª—å–Ω—É—é —Å—Ç—Ä—É–∫—Ç—É—Ä—É –ø—Ä–∏–ª–æ–∂–µ–Ω–∏—è. –í–Ω—É—Ç—Ä—å –∫–ª–∞–¥—ë–º –≤—Å—ë, —á—Ç–æ —Ö–æ—Ç–∏–º —É–≤–∏–¥–µ—Ç—å –Ω–∞ —ç–∫—Ä–∞–Ω–µ. –û–±—ã—á–Ω–æ —ç—Ç–æ –∫–∞–∫–æ–π-—Ç–æ Input, —Å –∫–æ—Ç–æ—Ä—ã–º –≤–∑–∞–∏–º–æ–¥–µ–π—Å—Ç–≤—É–µ—Ç –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å, –∏ –∫–∞–∫–æ–π-—Ç–æ Output.

- `titlePanel()` –æ—Ç–≤–µ—á–∞–µ—Ç –∑–∞ –∑–∞–≥–æ–ª–æ–≤–æ–∫. 

- `sidebarLayout(...)` –¥–µ–ª–∏—Ç —ç–∫—Ä–∞–Ω –Ω–∞ –¥–≤–µ –æ—Å–Ω–æ–≤–Ω—ã–µ —á–∞—Å—Ç–∏: —É–∑–∫–∞—è –ø–∞–Ω–µ–ª—å —Å —ç–ª–µ–º–µ–Ω—Ç–∞–º–∏ —É–ø—Ä–∞–≤–ª–µ–Ω–∏—è (—Å–ª–µ–≤–∞) –∏ –≥–ª–∞–≤–Ω–∞—è –ø–∞–Ω–µ–ª—å.

- `sidebarPanel(...)` –æ—Ç–≤–µ—á–∞–µ—Ç –∑–∞ –±–æ–∫–æ–≤—É—é –ø–∞–Ω–µ–ª—å. –í –Ω–µ–π –º—ã –≤–∏–¥–∏–º`sliderInput()` - —ç—Ç–æ –ø–æ–ª–∑—É–Ω–æ–∫.

- `mainPanel(...)` - —ç—Ç–æ –≥–ª–∞–≤–Ω–∞—è, –±–æ–ª—å—à–∞—è –ø–∞–Ω–µ–ª—å. –í –Ω–µ–π –±—É–¥–µ—Ç —á—Ç–æ-—Ç–æ –æ—Ç–æ–±—Ä–∞–∂–∞—Ç—å—Å—è. –ù–∞–ø—Ä–∏–º–µ—Ä, –≥—Ä–∞—Ñ–∏–∫: `plotOutput()`.

:::{.callout-warning icon=false}

- –ò—Å–ø—Ä–∞–≤—å—Ç–µ –∑–∞–≥–æ–ª–æ–≤–æ–∫ –Ω–∞ `"üì∞ –ö–ª–∞—Å—Å–∏—Ñ–∏–∫–∞—Ç–æ—Ä –Ω–æ–≤–æ—Å—Ç–µ–π"`. –¢–∞–∫ –±—É–¥–µ—Ç –Ω–∞–∑—ã–≤–∞—Ç—å—Å—è –Ω–∞—à–µ –ø—Ä–∏–ª–æ–∂–µ–Ω–∏–µ. 
- –î–æ–±–∞–≤—å—Ç–µ –∑–∞–≥–æ–ª–æ–≤–æ–∫ –±–æ–∫–æ–≤–æ–π –ø–∞–Ω–µ–ª–∏, –∏—Å–ø–æ–ª—å–∑—É—è [—Ç–µ–≥–∏](https://shiny.posit.co/r/articles/build/tag-glossary/): `tags$h4("–í—Å—Ç–∞–≤—å—Ç–µ –∏–ª–∏ –Ω–∞–ø–µ—á–∞—Ç–∞–π—Ç–µ –Ω–æ–≤–æ—Å—Ç—å:")`. –¢–µ–≥–∏ Shiny —Å–æ–æ—Ç–≤–µ—Ç—Å—Ç–≤—É—é—Ç —Ç–µ–≥–∞–º html.
- –î–æ–±–∞–≤—å—Ç–µ –∑–∞–≥–æ–ª–æ–≤–æ–∫ –≥–ª–∞–≤–Ω–æ–π –ø–∞–Ω–µ–ª–∏ `tags$h3("–†–µ–∑—É–ª—å—Ç–∞—Ç –∫–ª–∞—Å—Å–∏—Ñ–∏–∫–∞—Ü–∏–∏)`.
- –ù–µ –∑–∞–±—ã–≤–∞–π—Ç–µ –ø—Ä–æ –∑–∞–ø—è—Ç—ã–µ –º–µ–∂–¥—É —Ñ—É–Ω–∫—Ü–∏—è–º–∏! (RStudio –±—É–¥–µ—Ç –Ω–∞–ø–æ–º–∏–Ω–∞—Ç—å).
- –ò–∑–º–µ–Ω–∏—Ç–µ —à–∏—Ä–∏–Ω—É –±–æ–∫–æ–≤–æ–π –ø–∞–Ω–µ–ª–∏. –ü–æ—Å–º–æ—Ç—Ä–∏—Ç–µ –¥–æ–∫—É–º–µ–Ω—Ç–∞—Ü–∏—é –∫ —Ñ—É–Ω–∫—Ü–∏–∏ `sidebarLayout()`.
:::

–ó–∞–ø—É—Å—Ç–∏—Ç–µ –ø—Ä–∏–ª–æ–∂–µ–Ω–∏–µ –µ—â–µ —Ä–∞–∑ –∏ –ø–æ—Å–º–æ—Ç—Ä–∏—Ç–µ, —á—Ç–æ –ø–æ–ª—É—á–∏–ª–æ—Å—å.

### –≠–ª–µ–º–µ–Ω—Ç—ã –≤–≤–æ–¥–∞

–ü–æ–ª–Ω—ã–π —Å–ø–∏—Å–æ–∫ —ç–ª–µ–º–µ–Ω—Ç–æ–≤ –≤–≤–æ–¥–∞ –¥–æ—Å—Ç—É–ø–µ–Ω –ø–æ [—Å—Å—ã–ª–∫–µ](https://shiny.posit.co/r/components/).

–ù–µ–±–æ–ª—å—à–∏–µ —Ñ—Ä–∞–≥–º–µ–Ω—Ç—ã —Ç–µ–∫—Å—Ç–∞ —É–¥–æ–±–Ω–æ –æ–±—Ä–∞–±–∞—Ç—ã–≤–∞—Ç—å –ø—Ä–∏ –ø–æ–º–æ—â–∏ —Ñ—É–Ω–∫—Ü–∏–∏ `textInput()`, –∞ –µ—Å–ª–∏ –≤—ã —Ö–æ—Ç–∏—Ç–µ, —á—Ç–æ–±—ã –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å –≤–≤–µ–ª –æ–¥–∏–Ω –∏–ª–∏ –Ω–µ—Å–∫–æ–ª—å–∫–æ –∞–±–∑–∞—Ü–µ–≤, –∏—Å–ø–æ–ª—å–∑—É–π—Ç–µ `textAreaInput()`. –î–ª—è –Ω–∞—à–µ–≥–æ –∫–ª–∞—Å—Å–∏—Ñ–∏–∫–∞—Ç–æ—Ä–∞ –ø–æ–¥–æ–π–¥–µ—Ç –ø–æ—Å–ª–µ–¥–Ω—è—è. –î–æ–±–∞–≤—å—Ç–µ –µ–µ –≤–º–µ—Å—Ç–æ –ø–æ–ª–∑—É–Ω–∫–∞:

```{r eval=FALSE}
textAreaInput("user_text", 
              NULL, 
              placeholder = "–í–≤–µ–¥–∏—Ç–µ —Ç–µ–∫—Å—Ç –Ω–æ–≤–æ—Å—Ç–∏ –∑–¥–µ—Å—å...", 
              rows = 6)
```

–î–ª—è —Å—Ä–∞–≤–Ω–µ–Ω–∏—è –¥–æ–±–∞–≤—å—Ç–µ —Ä—è–¥–æ–º (—á—É—Ç—å –ø–æ–∑–∂–µ –º—ã —ç—Ç–æ —É–±–µ—Ä–µ–º):

```{r eval=FALSE}
textInput("user_name", 
          # –∑–∞–º–µ—Ç—å—Ç–µ –ø–æ–ª–æ–∂–µ–Ω–∏–µ –≤–æ–ø—Ä–æ—Å–∞
          "–ö–∞–∫ –≤–∞—Å –∑–æ–≤—É—Ç?")
```


:::{.callout-warning icon=false}
–°–Ω–æ–≤–∞ –ø–æ—Å–º–æ—Ç—Ä–∏—Ç–µ, —á—Ç–æ –ø–æ–ª—É—á–∏–ª–æ—Å—å. –û–±—Ä–∞—Ç–∏—Ç–µ –≤–Ω–∏–º–∞–Ω–∏–µ –Ω–∞ —Ç–æ, —á—Ç–æ –ø—Ä–æ–∏—Å—Ö–æ–¥–∏—Ç –ø—Ä–∏ —ç—Ç–æ–º —Å –≤—ã–≤–æ–¥–æ–º. 
:::

### –ö–Ω–æ–ø–∫–∏

–î–ª—è –ø–æ–¥—Ç–≤–µ—Ä–∂–¥–µ–Ω–∏—è –¥–µ–π—Å—Ç–≤–∏—è –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—é –º–æ–∂–Ω–æ –¥–∞—Ç—å –≤ —Ä–∞—Å–ø—Ä–æ—Ä—è–∂–µ–Ω–∏–µ –∫–Ω–æ–ø–∫—É –∏–ª–∏ —Å—Å—ã–ª–∫—É —Å –ø–æ–º–æ—â—å—é —Ñ—É–Ω–∫—Ü–∏–π `actionButton()` –∏–ª–∏ `actionLink()`.

–î–æ–±–∞–≤—å—Ç–µ –ø–æ–¥ –æ–±–ª–∞—Å—Ç—å—é –≤–≤–æ–¥–∞ —Ç–µ–∫—Å—Ç–∞:

```{r eval=FALSE}
actionButton("predict_btn", "üîç –ü—Ä–µ–¥—Å–∫–∞–∑–∞—Ç—å –∫–∞—Ç–µ–≥–æ—Ä–∏—é", class = "btn-primary")
```

–û–±—ã—á–Ω–æ –∫–Ω–æ–ø–∫–∏ –∏ —Å—Å—ã–ª–∫–∏ —Ä–∞–±–æ—Ç–∞—é –≤ –ø–∞—Ä–µ —Å —Ñ—É–Ω–∫—Ü–∏—è–º–∏ `observeEvent()` –∏–ª–∏ `eventReactive()`. 

–§—É–Ω–∫—Ü–∏—è `observeEvent()` –∏—Å–ø–æ–ª—å–∑—É–µ—Ç—Å—è –¥–ª—è –≤—ã–ø–æ–ª–Ω–µ–Ω–∏—è "–ø–æ–±–æ—á–Ω—ã—Ö –¥–µ–π—Å—Ç–≤–∏–π", –Ω–∞–ø—Ä–∏–º–µ—Ä, –ø–µ—á–∞—Ç–∏ –≤ –∫–æ–Ω—Å–æ–ª—å, –∑–∞–ø–∏—Å–∏ —Ñ–∞–π–ª–∞, –∑–∞–ø—É—Å–∫–∞ —Ñ—É–Ω–∫—Ü–∏–π –±–µ–∑ –ø—Ä—è–º–æ–≥–æ –≤—ã–≤–æ–¥–∞ –≤ –∏–Ω—Ç–µ—Ä—Ñ–µ–π—Å. –≠—Ç–æ —Ñ—É–Ω–∫—Ü–∏—è –¥–ª—è –¥–µ–π—Å—Ç–≤–∏–π, –æ–Ω–∞ –Ω–µ –≤–æ–∑–≤—Ä–∞—â–∞–µ—Ç –¥–∞–Ω–Ω—ã—Ö. 

–§—É–Ω–∫—Ü–∏—è `eventReactive()` –∏—Å–ø–æ–ª—å–∑—É–µ—Ç—Å—è –¥–ª—è —Å–æ–∑–¥–∞–Ω–∏—è —Ä–µ–∞–∫—Ç–∏–≤–Ω–æ–≥–æ –∑–Ω–∞—á–µ–Ω–∏—è (–∫–æ—Ç–æ—Ä–æ–µ –≤–æ–∑–≤—Ä–∞—â–∞–µ—Ç –∑–Ω–∞—á–µ–Ω–∏–µ, –∏ —ç—Ç–∏–º –∑–Ω–∞—á–µ–Ω–∏–µ–º –º–æ–∂–Ω–æ –ø–æ–ª—å–∑–æ–≤–∞—Ç—å—Å—è –≤ –¥—Ä—É–≥–∏—Ö —á–∞—Å—Ç—è—Ö Shiny, –Ω–∞–ø—Ä–∏–º–µ—Ä –¥–ª—è –ø–æ—Å—Ç—Ä–æ–µ–Ω–∏—è –≥—Ä–∞—Ñ–∏–∫–∞). 

–í –ø–æ—Å–ª–µ–¥–Ω–∏—Ö –≤–µ—Ä—Å–∏—è—Ö Shiny –æ–±–µ —Ñ—É–Ω–∫—Ü–∏–∏ –∑–∞–º–µ–Ω—è–µ—Ç `bindEvent()`. –ü–æ–∫–∞ –º—ã –Ω–µ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–ª–∏ —ç—Ç–∏ —Ñ—É–Ω–∫—Ü–∏–∏, —Ç–∞–∫ —á—Ç–æ –Ω–∞—à–∞ –∫–Ω–æ–ø–∫–∞ –±–µ–∑–¥–µ–π—Å—Ç–≤—É–µ—Ç.

–í—ã –º–æ–∂–µ—Ç–µ –Ω–∞—Å—Ç—Ä–æ–∏—Ç—å –≤–Ω–µ—à–Ω–∏–π –≤–∏–¥ –∫–Ω–æ–ø–æ–∫ –ø–æ —Å–≤–æ–µ–º—É –∂–µ–ª–∞–Ω–∏—é, –ø–µ—Ä–µ–¥–∞–≤ –≤ –∫–∞—á–µ—Å—Ç–≤–µ –∞—Ä–≥—É–º–µ–Ω—Ç–∞ `class` –æ–¥–Ω–æ –∏–∑ —Å–ª–µ–¥—É—é—â–∏—Ö –∑–Ω–∞—á–µ–Ω–∏–π: `"btn-primary"`, `"btn-success"`,`"btn-info"`,`"btn-warning"`,`"btn-danger"`. –í—ã —Ç–∞–∫–∂–µ –º–æ–∂–µ—Ç–µ –∏–∑–º–µ–Ω–∏—Ç—å —Ä–∞–∑–º–µ—Ä –∫–Ω–æ–ø–∫–∏ –ø—Ä–∏ –ø–æ–º–æ—â–∏ –∑–Ω–∞—á–µ–Ω–∏–π `"btn-lg"`, `"btn-lg"` –∏–ª–∏ `"btn-lg"`. 
–ù–∞–∫–æ–Ω–µ—Ü, –≤—ã –º–æ–∂–µ—Ç–µ –∑–∞—Å—Ç–∞–≤–∏—Ç—å –∫–Ω–æ–ø–∫—É –∑–∞–Ω—è—Ç—å –≤—Å—é —Å–≤–æ–±–æ–¥–Ω—É—é —à–∏—Ä–∏–Ω—É –≤–Ω—É—Ç—Ä–∏ —ç–ª–µ–º–µ–Ω—Ç–∞, –≤ –∫–æ—Ç–æ—Ä—ã–π –æ–Ω–∞ –≤—Å—Ç—Ä–æ–µ–Ω–∞, –∏—Å–ø–æ–ª—å–∑—É—è –∑–Ω–∞—á–µ–Ω–∏–µ `"btn-block"`.


### –≠–ª–µ–º–µ–Ω—Ç—ã –≤—ã–≤–æ–¥–∞

–≠–ª–µ–º–µ–Ω—Ç—ã –≤—ã–≤–æ–¥–∞ (output) –ø—Ä–µ–¥—Å—Ç–∞–≤–ª—è—é—Ç —Å–æ–±–æ–π —Å–≤–æ–µ–æ–±—Ä–∞–∑–Ω—ã–µ –∑–∞–≥–ª—É—à–∫–∏ –≤ –∏–Ω—Ç–µ—Ä—Ñ–µ–π—Å–µ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è, –∫–æ—Ç–æ—Ä—ã–µ –ø—Ä–∏ –Ω–µ–æ–±—Ö–æ–¥–∏–º–æ—Å—Ç–∏ –∑–∞–ø–æ–ª–Ω—è—é—Ç—Å—è —Å –ø–æ–º–æ—â—å—é —Ñ—É–Ω–∫—Ü–∏–∏ `server()`. 

–ö–∞–∫ –∏ —ç–ª–µ–º–µ–Ω—Ç—ã –≤–≤–æ–¥–∞, —ç–ª–µ–º–µ–Ω—Ç—ã –≤—ã–≤–æ–¥–∞ –ø—Ä–∏–Ω–∏–º–∞—é—Ç –∏–¥–µ–Ω—Ç–∏—Ñ–∏–∫–∞—Ç–æ—Ä –≤ –∫–∞—á–µ—Å—Ç–≤–µ –æ–±—è–∑–∞—Ç–µ–ª—å–Ω–æ–≥–æ –ø–µ—Ä–≤–æ–≥–æ –∞—Ä–≥—É–º–µ–Ω—Ç–∞. –ï—Å–ª–∏ –≤ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å—Å–∫–æ–º –∏–Ω—Ç–µ—Ä—Ñ–µ–π—Å–µ –µ—Å—Ç—å —ç–ª–µ–º–µ–Ω—Ç —Å –∏–¥–µ–Ω—Ç–∏—Ñ–∏–∫–∞—Ç–æ—Ä–æ–º "plot" (–∏–ª–∏ –ª—é–±—ã–º –¥—Ä—É–≥–∏–º!), –≤ —Å–µ—Ä–≤–µ—Ä–Ω–æ–π —á–∞—Å—Ç–∏ –ø—Ä–∏–ª–æ–∂–µ–Ω–∏—è –æ–±—Ä–∞—â–∞—Ç—å—Å—è –∫ –Ω–µ–º—É –º–æ–∂–Ω–æ –±—É–¥–µ—Ç –ø–æ –∏–º–µ–Ω–∏ `output$plot`.

–ö–∞–∂–¥–∞—è —Ñ—É–Ω–∫—Ü–∏—è –≤—ã–≤–æ–¥–∞ –≤ –∫–ª–∏–µ–Ω—Ç—Å–∫–æ–π —á–∞—Å—Ç–∏ —Å–æ–ø–æ—Å—Ç–∞–≤–ª—è–µ—Ç—Å—è —Å —Ñ—É–Ω–∫—Ü–∏–µ–π –æ—Ç–æ–±—Ä–∞–∂–µ–Ω–∏—è –≤ —Å–µ—Ä–≤–µ—Ä–Ω–æ–π. –°—É—â–µ—Å—Ç–≤—É–µ—Ç —Ç—Ä–∏ –æ—Å–Ω–æ–≤–Ω—ã—Ö —Ç–∏–ø–∞ –≤—ã–≤–æ–¥–∞: —Ç–µ–∫—Å—Ç, —Ç–∞–±–ª–∏—Ü—ã, –≥—Ä–∞—Ñ–∏–∫–∏.

–ù–∞—á–Ω–µ–º —Å —Ç–µ–∫—Å—Ç–∞. –î–æ–±–∞–≤—å—Ç–µ –≤ —Å–µ—Ä–≤–µ—Ä–Ω—É—é —á–∞—Å—Ç—å (–≤–º–µ—Å—Ç–æ —Ñ—É–Ω–∫—Ü–∏–∏, –∫–æ—Ç–æ—Ä–∞—è –≥–µ–Ω–µ—Ä–∏—Ä—É–µ—Ç –≥–∏—Å—Ç–æ–≥—Ä–∞–º–º—É):

```{r eval=FALSE}
output$user_name <- renderText(paste("–ü—Ä–∏–≤–µ—Ç, ", input$user_name, "!"))
```

–§—É–Ω–∫—Ü–∏—è `renderText()` —Å–æ–±–∏—Ä–∞–µ—Ç —Ä–µ–∑—É–ª—å—Ç–∞—Ç –≤ —Å—Ç—Ä–æ–∫—É –∏ –æ–±—ã—á–Ω–æ –ø—Ä–∏–º–µ–Ω—è–µ—Ç—Å—è –≤ –ø–∞—Ä–µ —Å —Ñ—É–Ω–∫—Ü–∏–µ–π `textOutput()`. –î–æ–±–∞–≤—å—Ç–µ –≤—ã–≤–æ–¥ –Ω–∞ –≥–ª–∞–≤–Ω—É—é –ø–∞–Ω–µ–ª—å –≤ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å—Å–∫–æ–º –∏–Ω—Ç–µ—Ä—Ñ–µ–π—Å–µ –≤–º–µ—Å—Ç–æ `plotOutput()`:

```{r eval=FALSE}
textOutput("user_name")
```


:::{.callout-warning icon=false}
–ó–∞–ø—É—Å—Ç–∏—Ç–µ –∏—Å–ø—Ä–∞–≤–ª–µ–Ω–Ω–æ–µ –ø—Ä–∏–ª–æ–∂–µ–Ω–∏–µ. –ï—Å–ª–∏ –≤—Å–µ –≤–µ—Ä–Ω–æ, —Ç–æ –æ–Ω–æ –¥–æ–ª–∂–Ω–æ –ø–æ–ø—Ä–∏–≤–µ—Ç—Å—Ç–≤–æ–≤–∞—Ç—å –≤–∞—Å –ø–æ –∏–º–µ–Ω–∏. 
:::

–û–±—Ä–∞—Ç–∏—Ç–µ –≤–Ω–∏–º–∞–Ω–∏–µ: –∫–Ω–æ–ø–∫–∞ –≤—Å–µ –µ—â–µ –±–µ–∑–¥–µ–π—Å—Ç–≤—É–µ—Ç, –≤—ã–≤–æ–¥ –æ–±–Ω–æ–≤–ª—è–µ—Ç—Å—è _—Ä–µ–∞–∫—Ç–∏–≤–Ω–æ_.

:::{.callout-note icon=false}

–†–µ–∞–∫—Ç–∏–≤–Ω–æ–µ –ø—Ä–æ–≥—Ä–∞–º–º–∏—Ä–æ–≤–∞–Ω–∏–µ -  —ç—Ç–æ —Å—Ç–∏–ª—å –ø—Ä–æ–≥—Ä–∞–º–º–∏—Ä–æ–≤–∞–Ω–∏—è, –ø—Ä–∏ –∫–æ—Ç–æ—Ä–æ–º –¥–∞–Ω–Ω—ã–µ –∏ –≤—ã—á–∏—Å–ª–µ–Ω–∏—è –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏ –æ–±–Ω–æ–≤–ª—è—é—Ç—Å—è –≤ –æ—Ç–≤–µ—Ç –Ω–∞ –∏–∑–º–µ–Ω–µ–Ω–∏—è –≤—Ö–æ–¥–Ω—ã—Ö –¥–∞–Ω–Ω—ã—Ö. –í —Ç–∞–∫–æ–º –ø–æ–¥—Ö–æ–¥–µ –≤—ã –æ–ø–∏—Å—ã–≤–∞–µ—Ç–µ, –∫–∞–∫–∏–µ —ç–ª–µ–º–µ–Ω—Ç—ã –ø—Ä–∏–ª–æ–∂–µ–Ω–∏—è –∑–∞–≤–∏—Å—è—Ç –æ—Ç –∫–∞–∫–∏—Ö –≤—Ö–æ–¥–æ–≤, –∞ Shiny —Å–∞–º —Å–ª–µ–¥–∏—Ç –∑–∞ –∏–∑–º–µ–Ω–µ–Ω–∏—è–º–∏ –∏ –ø–µ—Ä–µ—Å—á–∏—Ç—ã–≤–∞–µ—Ç —Ç–æ, —á—Ç–æ  –Ω—É–∂–Ω–æ –æ–±–Ω–æ–≤–∏—Ç—å.

:::

–î–ª—è —Ç–æ–≥–æ, —á—Ç–æ–±—ã –∫–Ω–æ–ø–∫–∞ "–∑–∞—Ä–∞–±–æ—Ç–∞–ª–∞", –Ω–µ–æ–±—Ö–æ–¥–∏–º–æ –≤–Ω–µ—Å—Ç–∏ –∏–∑–º–µ–Ω–µ–Ω–∏—è –≤ —Å–µ—Ä–≤–µ—Ä–Ω—É—é —á–∞—Å—Ç—å:

```{r eval=FALSE}
server <- function(input, output) {
  output$salutation <- renderText(paste("–ü—Ä–∏–≤–µ—Ç, ", input$user_name, "!")) |> 
  bindEvent(input$predict_btn)
}
```

–í –∏–Ω—Ç–µ—Ä—Ñ–µ–π—Å–µ –∑–∞–º–µ–Ω–∏—Ç–µ, —Å–æ–æ—Ç–≤–µ—Ç—Å—Ç–≤–µ–Ω–Ω–æ, –≤—ã–≤–æ–¥ –Ω–∞ `textOutput("salutation")`. 

–¢–µ–ø–µ—Ä—å —Ä–∞–∑–±–µ—Ä–µ–º—Å—è, —á—Ç–æ –∑–¥–µ—Å—å –ø—Ä–æ–∏—Å—Ö–æ–¥–∏—Ç. –ö–æ–≥–¥–∞ –≤—ã –ø–∏—à–µ—Ç–µ `output$salutation`, –≤—ã –æ–ø—Ä–µ–¥–µ–ª—è–µ—Ç–µ —Ä–µ–∞–∫—Ç–∏–≤–Ω—ã–π –≤—ã—Ö–æ–¥ - –æ–±—ä–µ–∫—Ç, –∫–æ—Ç–æ—Ä—ã–π –ø–æ—Ç–æ–º –±—É–¥–µ—Ç–µ –≤—ã–≤–æ–¥–∏—Ç—å –Ω–∞ UI —Å –ø–æ–º–æ—â—å—é `textOutput("salutation")`. –§—É–Ω–∫—Ü–∏—è `renderText()` –∫–æ—Ç–æ—Ä–∞—è –≤–æ–∑–≤—Ä–∞—â–∞–µ—Ç —Ç–µ–∫—Å—Ç –¥–ª—è –æ—Ç–æ–±—Ä–∞–∂–µ–Ω–∏—è.  –í–Ω—É—Ç—Ä–∏ `paste("–ü—Ä–∏–≤–µ—Ç, ", input$user_name, "!")` –≤—Å—Ç–∞–≤–ª—è–µ—Ç –∏–º—è, –∫–æ—Ç–æ—Ä—ã–π –≤–≤–µ–ª –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å. –ù–∞–∫–æ–Ω–µ—Ü, —Ñ—É–Ω–∫—Ü–∏—è —Ñ—É–Ω–∫—Ü–∏—è `bindEvent()` (—Å –ø–∞–π–ø–æ–º `|>`) –≥–æ–≤–æ—Ä–∏—Ç Shiny, —á—Ç–æ –æ–±–Ω–æ–≤–ª—è—Ç—å (–ø–µ—Ä–µ—Å—á–∏—Ç—ã–∞—Ç—å) –≤—ã—Ö–æ–¥–Ω–æ–π —Ç–µ–∫—Å—Ç –Ω–∞–¥–æ —Ç–æ–ª—å–∫–æ —Ç–æ–≥–¥–∞, –∫–æ–≥–¥–∞ –Ω–∞–∂–∞—Ç–∞ –∫–Ω–æ–ø–∫–∞ —Å id "predict_btn". –¢–µ–ø–µ—Ä—å —Ç–æ–ª—å–∫–æ –Ω–∞–∂–∞—Ç–∏–µ –∫–Ω–æ–ø–∫–∏ –≤—ã–∑—ã–≤–∞–µ—Ç –æ–±–Ω–æ–≤–ª–µ–Ω–∏–µ –≤—ã–≤–æ–¥–∞. –≠—Ç–æ –ø–æ–Ω–∞–¥–æ–±–∏—Ç—Å—è –Ω–∞–º —á—É—Ç—å –ø–æ–∑–∂–µ.

–ï—Å–ª–∏ –≤—Å–µ –ø–æ–ª—É—á–∏–ª–æ—Å—å –∏ –≤—Å–µ –ø–æ–Ω—è—Ç–Ω–æ, –º–æ–∂–Ω–æ —É–¥–∞–ª–∏—Ç—å –ª–∏—à–Ω–∏–µ —Å—Ç—Ä–æ—á–∫–∏ –∫–æ–¥–∞, –∫–æ—Ç–æ—Ä—ã–µ –Ω–µ –Ω—É–∂–Ω—ã –¥–ª—è –Ω–∞—à–µ–≥–æ –ø—Ä–∏–ª–æ–∂–µ–Ω–∏—è. –ù–∞ —ç—Ç–æ–º —ç—Ç–∞–ø–µ —É –≤–∞—Å –¥–æ–ª–∂–Ω–æ –ø–æ–ª—É—á–∏—Ç—å—Å—è –≤–æ—Ç —á—Ç–æ:

```{r eval=FALSE}
library(shiny)

# –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å—Å–∫–∏–π –∏–Ω—Ç–µ—Ä—Ñ–µ–π—Å
ui <- fluidPage(

    # –Ω–∞–∑–≤–∞–Ω–∏–µ –ø—Ä–∏–ª–æ–∂–µ–Ω–∏—è
    titlePanel("üì∞ –ö–ª–∞—Å—Å–∏—Ñ–∏–∫–∞—Ç–æ—Ä –Ω–æ–≤–æ—Å—Ç–µ–π"),

    # –º–∞–∫–µ—Ç
    sidebarLayout(
      
        sidebarPanel(
            width = 6,
            tags$h4("–í—Å—Ç–∞–≤—å—Ç–µ –∏–ª–∏ –Ω–∞–ø–µ—á–∞—Ç–∞–π—Ç–µ –Ω–æ–≤–æ—Å—Ç—å:"),
            textAreaInput("user_text", 
                          NULL, 
                          placeholder = "–í–≤–µ–¥–∏—Ç–µ —Ç–µ–∫—Å—Ç –Ω–æ–≤–æ—Å—Ç–∏ –∑–¥–µ—Å—å...", 
                          rows = 6),
            actionButton("predict_btn", 
                         "üîç –ü—Ä–µ–¥—Å–∫–∞–∑–∞—Ç—å –∫–∞—Ç–µ–≥–æ—Ä–∏—é", 
                         class = "btn-primary")
            ),
        
        mainPanel(
           width = 6,
           tags$h3("–†–µ–∑—É–ª—å—Ç–∞—Ç—ã –∫–ª–∞—Å—Å–∏—Ñ–∏–∫–∞—Ü–∏–∏"),
           
        )
    )
)

# —Å–µ—Ä–≤–µ—Ä (–ø–æ–∫–∞ –ø—É—Å—Ç–æ–π)
server <- function(input, output) {
  
  # –ø–æ–∫–∞ –ø—É—Å—Ç–æ
  
}

# –ø–æ–µ—Ö–∞–ª–∏! 
shinyApp(ui = ui, server = server)

```

## –°–µ—Ä–≤–µ—Ä

–í –ø—Ä–µ–¥—ã–¥—É—â–µ–º —É—Ä–æ–∫–µ –º—ã –æ–±—É—á–∏–ª–∏ –Ω–µ–π—Ä–æ—Å–µ—Ç–µ–≤—É—é –º–æ–¥–µ–ª—å, –∫–æ—Ç–æ—Ä–∞—è –ø—Ä–µ–¥—Å–∫–∞–∑—ã–≤–∞–µ—Ç –∫–∞—Ç–µ–≥–æ—Ä–∏—é –Ω–æ–≤–æ—Å—Ç–∏ –ø–æ –µ–µ —Ç–µ–∫—Å—Ç—É. –ï—Å–ª–∏ –≤—ã –Ω–µ —Å–æ—Ö—Ä–∞–Ω–∏–ª–∏ —Ä–µ–∑—É–ª—å—Ç–∞—Ç, —Ç–æ [–ø—Ä–µ–ø—Ä–æ—Ü–µ—Å—Å–æ—Ä](https://github.com/locusclassicus/text_analysis_2024/raw/refs/heads/main/data/onehot_prep.rds) –∏ [–º–æ–¥–µ–ª—å](https://github.com/locusclassicus/text_analysis_2024/raw/refs/heads/main/data/my_dense_model.keras) –Ω–∞–¥–æ –∑–∞–±—Ä–∞—Ç—å –ø–æ —Å—Å—ã–ª–∫–∞–º –∏ –ø–æ–ª–æ–∂–∏—Ç—å –≤ –¥–∏—Ä–µ–∫—Ç–æ—Ä–∏—é —Å –ø—Ä–∏–ª–æ–∂–µ–Ω–∏–µ–º.

–ü–æ—Å–ª–µ —ç—Ç–æ–≥–æ –ø—Ä–æ—á–∏—Ç–∞–π—Ç–µ –≤ –æ–∫—Ä—É–∂–µ–Ω–∏–µ –¥–∞–Ω–Ω—ã–µ –∏ –∑–∞–≥—Ä—É–∑–∏—Ç–µ –Ω—É–∂–Ω—ã–µ –ø–∞–∫–µ—Ç—ã (–ø–æ–∫–∞ –º–æ–∂–Ω–æ —ç—Ç–æ —Å–¥–µ–ª–∞—Ç—å –≤ –æ—Ç–¥–µ–ª—å–Ω–æ–º —Å–∫—Ä–∏–ø—Ç–µ, –ø–æ—Ç–æ–º –¥–æ–±–∞–≤–∏–º –≤ –ø—Ä–∏–ª–æ–∂–µ–Ω–∏–µ):

```{r eval=FALSE}
library(keras3)
onehot_rec <- readRDS("onehot_prep.rds")
model <- load_model("my_dense_model.keras")
```

–¢–∞–∫–∂–µ –Ω–∞–º –ø–æ–Ω–∞–¥–æ–±—è—Ç—Å—è –∏–º–µ–Ω–∞ –¥–ª—è –∫–ª–∞—Å—Å–æ–≤: –æ–Ω–∏ —Å–æ–æ—Ç–≤–µ—Ç—Å—Ç–≤—É—é—Ç —É—Ä–æ–≤–Ω—è–º —Ñ–∞–∫—Ç–æ—Ä–∞, –∫–æ—Ç–æ—Ä—ã–π –º—ã —Å–æ–∑–¥–∞–ª–∏ –≤ –ø—Ä–æ—à–ª—ã–π —Ä–∞–∑ –ø—Ä–∏ –ø–æ–º–æ—â–∏ `as.factor(class)`:

```{r eval=FALSE}
class_names <- c("Business", "Sci/Tech", "Sports", "World") 
```

–¢–µ–ø–µ—Ä—å –≤–æ—Å–ø–æ–ª—å–∑—É–µ–º—Å—è —ç—Ç–∏–º, —á—Ç–æ–±—ã –ø–æ–ª—É—á–∏—Ç—å:

- –ø—Ä–µ–¥—Å–∫–∞–∑–∞–Ω–∏–µ –¥–ª—è –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å—Å–∫–æ–≥–æ —Ç–µ–∫—Å—Ç–∞;
- –≤–µ–∫—Ç–æ—Ä –≤–µ—Ä–æ—è—Ç–Ω–æ—Å—Ç–µ–π –¥–ª—è –∫–∞–∂–¥–æ–π –∫–∞—Ç–µ–≥–æ—Ä–∏–∏;
- –≤–∏–∑—É–∞–ª–∏–∑–∞—Ü–∏—é –≤–µ—Ä–æ—è—Ç–Ω–æ—Å—Ç–µ–π.


–ö–∞–∫ –º—ã –ø–æ–º–Ω–∏–º, –æ–±—É—á–µ–Ω–Ω—ã–π —Ä–µ—Ü–µ–ø—Ç –º–æ–∂–Ω–æ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å –≤–º–µ—Å—Ç–µ —Å `bake()` –Ω–∞ –Ω–æ–≤—ã—Ö –¥–∞–Ω–Ω—ã—Ö, –Ω–æ –¥–ª—è —ç—Ç–æ–≥–æ —Å—Ç—Ä–æ–∫—É, –∫–æ—Ç–æ—Ä—É—é –≤–≤–µ–¥–µ—Ç –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å, –Ω—É–∂–Ω–æ –ø—Ä–µ–æ–±—Ä–∞–∑–æ–≤–∞—Ç—å –≤ —Ç–∏–±–±–ª —Å —Ç–µ–º–∏ –∂–µ –Ω–∞–∑–≤–∞–Ω–∏—è–º–∏ —Å—Ç–æ–ª–±—Ü–æ–≤, –∫–æ—Ç–æ—Ä—ã–µ –æ–∂–∏–¥–∞–µ—Ç –ø—Ä–µ–ø—Ä–æ—Ü–µ—Å—Å–æ—Ä.

```{r eval=FALSE}
library(tidyverse)
library(recipes, quietly = TRUE)
library(textrecipes)


text <- "A British man has been arrested after he drove his car into a crowd of Liverpool FC football fans celebrating their team's Premier League"

new_data <- tibble(description = text)
model_input <- bake(onehot_rec, 
                new_data = new_data,
                composition = "matrix")
probs <- as.numeric(model |> predict(model_input))
pred_cat <- class_names[which.max(probs)]
names(probs) <-  class_names

probs

```

–¢–µ–ø–µ—Ä—å –Ω–∞–º –Ω–∞–¥–æ –¥–æ–±–∞–≤–∏—Ç—å –≤—Å–µ —ç—Ç–∏ –≤—ã—á–∏—Å–ª–µ–Ω–∏—è –Ω–∞ —Å–µ—Ä–≤–µ—Ä. 

```{r eval=FALSE}

library(shiny)
library(keras3)
library(recipes)
library(tibble)
library(dplyr)
library(stringr)
library(purrr)
library(ggplot2)
library(textrecipes)


# –ó–∞–≥—Ä—É–∑–∫–∞ –æ–±—É—á–µ–Ω–Ω–æ–≥–æ –ø—Ä–µ–ø—Ä–æ—Ü–µ—Å—Å–æ—Ä–∞ –∏ –º–æ–¥–µ–ª–∏
onehot_rec <- readRDS("onehot_prep.rds")
model <- load_model("my_dense_model.keras")

# –°–ø–∏—Å–æ–∫ –Ω–∞–∑–≤–∞–Ω–∏–π –∫–ª–∞—Å—Å–æ–≤ 
class_names <- c("Business", "Sci/Tech", "Sports", "World") 

# –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å—Å–∫–∏–π –∏–Ω—Ç–µ—Ä—Ñ–µ–π—Å
ui <- fluidPage(

    # –Ω–∞–∑–≤–∞–Ω–∏–µ –ø—Ä–∏–ª–æ–∂–µ–Ω–∏—è
    titlePanel("üì∞ –ö–ª–∞—Å—Å–∏—Ñ–∏–∫–∞—Ç–æ—Ä –Ω–æ–≤–æ—Å—Ç–µ–π"),

    # –º–∞–∫–µ—Ç
    sidebarLayout(
        sidebarPanel(
            width = 6,
            tags$h4("–í—Å—Ç–∞–≤—å—Ç–µ –∏–ª–∏ –Ω–∞–ø–µ—á–∞—Ç–∞–π—Ç–µ –Ω–æ–≤–æ—Å—Ç—å:"),
            textAreaInput("user_text", NULL, placeholder = "–í–≤–µ–¥–∏—Ç–µ —Ç–µ–∫—Å—Ç –Ω–æ–≤–æ—Å—Ç–∏ –∑–¥–µ—Å—å...", rows = 6),
            actionButton("predict_btn", "üîç –ü—Ä–µ–¥—Å–∫–∞–∑–∞—Ç—å –∫–∞—Ç–µ–≥–æ—Ä–∏—é", class = "btn-primary")
            ),
        mainPanel(
           width = 6,
           tags$h3("–†–µ–∑—É–ª—å—Ç–∞—Ç—ã –∫–ª–∞—Å—Å–∏—Ñ–∏–∫–∞—Ü–∏–∏"),
           textOutput("result_text")
        )
    )
)

# —Å–µ—Ä–≤–µ—Ä 
server <- function(input, output) {
  
  pred_result <- reactive({
    req(input$user_text)
    new_data <- tibble(description = input$user_text)
    model_input <- bake(onehot_rec, 
                        new_data = new_data,
                        composition = "matrix")
    probs <- as.numeric(model |> predict(model_input))
    pred_cat <- class_names[which.max(probs)]
    list(
      category = pred_cat,
      probs = setNames(probs, class_names)
    )
  }) |> bindEvent(input$predict_btn)
  
  
  output$result_text <- renderText({
    req(pred_result())
      paste0(
        "üåü –ü—Ä–µ–¥—Å–∫–∞–∑–∞–Ω–Ω–∞—è –∫–∞—Ç–µ–≥–æ—Ä–∏—è: ", pred_result()$category)
  })
}

# –ø–æ–µ—Ö–∞–ª–∏! 
shinyApp(ui = ui, server = server)
```


–§—É–Ω–∫—Ü–∏—è `reactive()` –æ–∑–Ω–∞—á–∞–µ—Ç, —á—Ç–æ –º—ã –∏—Å–ø–æ–ª—å–∑—É–µ–º **—Ä–µ–∞–∫—Ç–∏–≤–Ω–æ–µ –≤—ã—Ä–∞–∂–µ–Ω–∏–µ**. –†–µ–∞–∫—Ç–∏–≤–Ω—ã–µ –≤—ã—Ä–∞–∂–µ–Ω–∏—è ‚Äî —ç—Ç–æ –æ—Å–æ–±—ã–µ —á–∞—Å—Ç–∏ –∫–æ–¥–∞, –∫–æ—Ç–æ—Ä—ã–µ –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏ –ø–µ—Ä–µ—Å—á–∏—Ç—ã–≤–∞—é—Ç—Å—è, –∫–æ–≥–¥–∞ –∑–∞–≤–∏—Å—è—â–∏–µ –æ—Ç –Ω–∏—Ö –ø–µ—Ä–µ–º–µ–Ω–Ω—ã–µ –∏–∑–º–µ–Ω—è—é—Ç—Å—è. 

–†–µ–∞–∫—Ç–∏–≤–Ω—ã–µ –≤—ã—Ä–∞–∂–µ–Ω–∏—è –Ω—É–∂–Ω—ã, –∫–æ–≥–¥–∞ –≤—ã —Ö–æ—Ç–∏—Ç–µ:
- –í—ã–ø–æ–ª–Ω–∏—Ç—å –≤—ã—á–∏—Å–ª–µ–Ω–∏—è, –∫–æ—Ç–æ—Ä—ã–µ –∏—Å–ø–æ–ª—å–∑—É–µ—Ç–µ –Ω–µ—Å–∫–æ–ª—å–∫–æ —Ä–∞–∑, –Ω–µ –ø–æ–≤—Ç–æ—Ä—è—è –æ–¥–∏–Ω –∏ —Ç–æ—Ç –∂–µ –∫–æ–¥;
- –≠—Ñ—Ñ–µ–∫—Ç–∏–≤–Ω–æ —É–ø—Ä–∞–≤–ª—è—Ç—å –∑–∞–≤–∏—Å–∏–º–æ—Å—Ç—è–º–∏ –∏ –ø–µ—Ä–µ—Å—á—ë—Ç–∞–º–∏: Shiny –±—É–¥–µ—Ç —Ö—Ä–∞–Ω–∏—Ç—å —Ä–µ–∑—É–ª—å—Ç–∞—Ç –≤—ã—á–∏—Å–ª–µ–Ω–∏—è, –∏ –ø–µ—Ä–µ—Å—á–∏—Ç—ã–≤–∞—Ç—å, —Ç–æ–ª—å–∫–æ –∫–æ–≥–¥–∞ —Ä–µ–∞–ª—å–Ω–æ –∏–∑–º–µ–Ω–∏–ª–∏—Å—å –≤—Ö–æ–¥–Ω—ã–µ –∑–Ω–∞—á–µ–Ω–∏—è.

–í –Ω–∞—à–µ–º —Å–ª—É—á–∞–µ —Ä–µ–∞–∫—Ç–∏–≤–Ω–æ–µ –≤—ã—Ä–∞–∂–µ–Ω–∏–µ —Å—á–∏—Ç–∞–µ—Ç —Ä–µ–∑—É–ª—å—Ç–∞—Ç, —Ç–æ–ª—å–∫–æ –∫–æ–≥–¥–∞ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å –Ω–∞–∂–∏–º–∞–µ—Ç –∫–Ω–æ–ø–∫—É, –∑–∞ —Å–≤—è–∑—å —Å –∫–Ω–æ–ø–∫–æ–π –æ—Ç–≤–µ—á–∞–µ—Ç  `bindEvent()`. —Å–ª–∏ –±—ã —ç—Ç–æ–≥–æ –Ω–µ –±—ã–ª–æ, –ø—Ä–∏–ª–æ–∂–µ–Ω–∏–µ —Ä–µ–∞–≥–∏—Ä–æ–≤–∞–ª–æ –±—ã –Ω–∞ –∫–∞–∂–¥—ã–π –≤–≤–µ–¥—ë–Ω–Ω—ã–π —Å–∏–º–≤–æ–ª! 
  
–í—ã–∑–æ–≤ `req(input$user_text)` -  —ç—Ç–æ –ø—Ä–æ–≤–µ—Ä–∫–∞. –ï—Å–ª–∏ –ø–æ–ª–µ –≤–≤–æ–¥–∞ –ø—É—Å—Ç–æ–µ, –¥–∞–ª—å—à–µ –Ω–∏—á–µ–≥–æ –Ω–µ –ø—Ä–æ–∏—Å—Ö–æ–¥–∏—Ç. –ò–Ω—ã–º–∏ —Å–ª–æ–≤–∞–º–∏, `req()`  –æ—Å—Ç–∞–Ω–∞–≤–ª–∏–≤–∞–µ—Ç –≤—ã–ø–æ–ª–Ω–µ–Ω–∏–µ —Ä–µ–∞–∫—Ç–∏–≤–Ω–æ–≥–æ –≤—ã—Ä–∞–∂–µ–Ω–∏—è, –µ—Å–ª–∏ –≤ –Ω–µ–≥–æ –ø–µ—Ä–µ–¥–∞–Ω–æ `NULL`, `FALSE` –∏ —Ç.–ø. –≠—Ç–æ –≥–∞—Ä–∞–Ω—Ç–∏—Ä—É–µ—Ç, —á—Ç–æ –≤–∞—à –∫–æ–¥ –Ω–µ –±—É–¥–µ—Ç –≤—ã–ø–æ–ª–Ω—è—Ç—å—Å—è –ø—Ä–∏ –æ—Ç—Å—É—Ç—Å–≤–∏–∏ –Ω–µ–æ–±—Ö–æ–¥–∏–º—ã—Ö –¥–∞–Ω–Ω—ã—Ö. 
  
–ù–∞ —à–∞–≥–µ `new_data <- tibble(description = input$user_text)` –æ–±–æ—Ä–∞—á–∏–≤–∞–µ–º –≤–≤–µ–¥—ë–Ω–Ω—ã–π —Ç–µ–∫—Å—Ç –≤ —Ç–∞–±–ª–∏—á–∫—É, —á—Ç–æ–±—ã –¥–∞–ª—å—à–µ –ø–µ—Ä–µ–¥–∞—Ç—å –≤ –ø—Ä–µ–ø—Ä–æ—Ü–µ—Å—Å–æ—Ä.

–í –∫–æ–Ω—Ü–µ –≤—ã–∑—ã–≤–∞–µ–º `list(...)`, –∫–æ—Ç–æ—Ä—ã–π –≤–æ–∑–≤—Ä–∞—â–∞–µ—Ç —Å–ø–∏—Å–æ–∫ —Å –¥–≤—É–º—è –∑–Ω–∞—á–µ–Ω–∏—è–º–∏:  
  - `category` ‚Äî –∫–∞—Ç–µ–≥–æ—Ä–∏—è —Å —Å–∞–º–æ–π –≤—ã—Å–æ–∫–æ–π –≤–µ—Ä–æ—è—Ç–Ω–æ—Å—Ç—å—é.
  - `probs` ‚Äî –≤–µ–∫—Ç–æ—Ä –≤–µ—Ä–æ—è—Ç–Ω–æ—Å—Ç–µ–π –¥–ª—è –≤—Å–µ—Ö —á–µ—Ç—ã—Ä—ë—Ö –∫–ª–∞—Å—Å–æ–≤.

–ü–æ—á–µ–º—É —Å–ø–∏—Å–æ–∫? –í —Ä–µ–∞–∫—Ç–∏–≤–Ω—ã—Ö –≤—ã—Ä–∞–∂–µ–Ω–∏—è—Ö, –∫–∞–∫ –∏ –≤ –±–∞–∑–æ–≤—ã—Ö —Ñ—É–Ω–∫—Ü–∏—è—Ö, –º–æ–∂–Ω–æ –≤–µ—Ä–Ω—É—Ç—å —Ç–æ–ª—å–∫–æ –æ–¥–∏–Ω –æ–±—ä–µ–∫—Ç. –ß—Ç–æ–±—ã –∏–º–µ—Ç—å –≤–æ–∑–º–æ–∂–Ω–æ—Å—Ç—å –æ–±—Ä–∞—â–∞—Ç—å—Å—è –∫ —Ä–∞–∑–Ω—ã–º –∑–Ω–∞—á–µ–Ω–∏—è–º –≤–Ω—É—Ç—Ä–∏ —Ä–µ–∞–∫—Ç–∏–≤–∞, –∏—Ö —É–¥–æ–±–Ω–æ –æ–±—ä–µ–¥–∏–Ω–∏—Ç—å –≤ —Å–ø–∏—Å–æ–∫.

–ù–∞–∫–æ–Ω–µ—Ü, `output$result_text` -- —ç—Ç–æ —Ç–æ, —á—Ç–æ –±—É–¥–µ—Ç –æ—Ç–æ–±—Ä–∞–∂–µ–Ω–æ –≤ `textOutput("result_text")` –Ω–∞ –≥–ª–∞–≤–Ω–æ–π —Å—Ç—Ä–∞–Ω–∏—Ü–µ –ø—Ä–∏–ª–æ–∂–µ–Ω–∏—è. –í—Å–µ –≤–Ω—É—Ç—Ä–∏ `renderText({...})`  -- —ç—Ç–æ —Ä–µ–∞–∫—Ç–∏–≤–Ω–æ –ø–µ—Ä–µ—Å—á–∏—Ç—ã–≤–∞–µ–º—ã–π —Ç–µ–∫—Å—Ç, –∫–æ—Ç–æ—Ä—ã–π –ø–æ—è–≤–∏—Ç—Å—è –ø—Ä–∏ –æ–±–Ω–æ–≤–ª–µ–Ω–∏–∏ `pred_result()`.

–ò—Ç–∞–∫, –∫–∞–∫ –≤—Å—ë —Ä–∞–±–æ—Ç–∞–µ—Ç –≤–º–µ—Å—Ç–µ?

1. –ü–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å –≤–≤–æ–¥–∏—Ç —Ç–µ–∫—Å—Ç –∏ –Ω–∞–∂–∏–º–∞–µ—Ç –∫–Ω–æ–ø–∫—É.
2. –¢–æ–ª—å–∫–æ –≤ —ç—Ç–æ—Ç –º–æ–º–µ–Ω—Ç (!) –≤—ã—á–∏—Å–ª—è–µ—Ç—Å—è —Ä–µ–∞–∫—Ç–∏–≤–Ω–æ–µ –≤—ã—Ä–∞–∂–µ–Ω–∏–µ `pred_result`:
   - –¢–µ–∫—Å—Ç –ø–æ–¥–≥–æ—Ç–∞–≤–ª–∏–≤–∞–µ—Ç—Å—è, –æ–±—Ä–∞–±–∞—Ç—ã–≤–∞–µ—Ç—Å—è –ø—Ä–µ–ø—Ä–æ—Ü–µ—Å—Å–æ—Ä–æ–º, –ø–æ–¥–∞—ë—Ç—Å—è –º–æ–¥–µ–ª–∏.
   - –ü–æ–ª—É—á–∞–µ—Ç—Å—è –≤–µ–∫—Ç–æ—Ä –≤–µ—Ä–æ—è—Ç–Ω–æ—Å—Ç–µ–π –ø–æ –∏–º–µ—é—â–∏–º—Å—è –∫–∞—Ç–µ–≥–æ—Ä–∏—è–º.
   - –û–ø—Ä–µ–¥–µ–ª—è–µ—Ç—Å—è –∫–∞—Ç–µ–≥–æ—Ä–∏—è —Å –º–∞–∫—Å–∏–º–∞–ª—å–Ω–æ–π –≤–µ—Ä–æ—è—Ç–Ω–æ—Å—Ç—å—é.
   - –†–µ–∑—É–ª—å—Ç–∞—Ç –ø–∞–∫—É–µ—Ç—Å—è –≤ —Å–ø–∏—Å–æ–∫.
3. –ó–Ω–∞—á–µ–Ω–∏—è –∏–∑ `pred_result` –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏ (—Ä–µ–∞–∫—Ç–∏–≤–Ω–æ!) –∏—Å–ø–æ–ª—å–∑—É—é—Ç—Å—è –≤ —á–∞—Å—Ç–∏ –≤—ã–≤–æ–¥–∞:  
   - –¢–µ–∫—Å—Ç–æ–≤–æ–µ –ø–æ–ª–µ –ø–æ–∫–∞–∑—ã–≤–∞–µ—Ç –ø—Ä–µ–¥—Å–∫–∞–∑–∞–Ω–Ω—É—é –∫–∞—Ç–µ–≥–æ—Ä–∏—é.


```{}
(–ü–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å –≤–≤–æ–¥–∏—Ç —Ç–µ–∫—Å—Ç)
       ‚îÇ
       ‚ñº
(–ñ–º—ë—Ç –∫–Ω–æ–ø–∫—É)
       ‚îÇ
       ‚ñº
pred_result (—Ä–µ–∞–∫—Ç–∏–≤–Ω–æ–µ –≤—ã—Ä–∞–∂–µ–Ω–∏–µ):
 ‚îú‚îÄ 1. –û–±—Ä–∞–±–æ—Ç–∫–∞ —Ç–µ–∫—Å—Ç–∞
 ‚îú‚îÄ 2. –í–µ–∫—Ç–æ—Ä–∏–∑–∞—Ü–∏—è/onehot
 ‚îú‚îÄ 3. –ü—Ä–µ–¥—Å–∫–∞–∑–∞–Ω–∏–µ –Ω–µ–π—Ä–æ—Å–µ—Ç—å—é
 ‚îî‚îÄ 4. –§–æ—Ä–º–∏—Ä–æ–≤–∞–Ω–∏–µ —Å–ø–∏—Å–∫–∞ —Å –≤–µ—Ä–æ—è—Ç–Ω–æ—Å—Ç—è–º–∏ –∏ –∫–∞—Ç–µ–≥–æ—Ä–∏–µ–π
       ‚îÇ
       ‚ñº
output$result_text (—Ä–µ–∞–∫—Ç–∏–≤–Ω—ã–π –≤—ã–≤–æ–¥)
```

–í–º–µ—Å—Ç–æ –ø—Ä–æ—Å—Ç–æ–≥–æ —Ç–µ–∫—Å—Ç–∞ –º–æ–∂–Ω–æ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å html-–∫–æ–¥. –í —Ç–∞–∫–æ–º —Å–ª—É—á–∞–µ –≤–º–µ—Å—Ç–æ `renderText()` –∏ `textOutput()` –∏—Å–ø–æ–ª—å–∑—É–µ–º `renderUI()` –∏ `uiOutput()`, –Ω–∞–ø—Ä–∏–º–µ—Ä:

```{r eval=FALSE}
# –≤ —Å–µ—Ä–≤–µ—Ä–Ω–æ–π —á–∞—Å—Ç–∏
output$result_text <- renderUI({
    req(pred_result())
    HTML(
      paste0(
        "<h4>üåü –ü—Ä–µ–¥—Å–∫–∞–∑–∞–Ω–Ω–∞—è –∫–∞—Ç–µ–≥–æ—Ä–∏—è: <span style='color:#0072B2;'>", pred_result()$category, "</span></h4>"
      )
    )
  })


# –≤ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å—Å–∫–æ–º –∏–Ω—Ç–µ—Ä—Ñ–µ–π—Å–µ
uiOutput("result_text")
```

–¢–µ–ø–µ—Ä—å –ø–æ–ø—Ä–æ–±—É–µ–º —É—Å–æ–≤–µ—Ä—à–µ–Ω—Å—Ç–æ–≤–∞—Ç—å –Ω–∞—à–µ –ø—Ä–∏–ª–æ–∂–µ–Ω–∏–µ, –¥–æ–±–∞–≤–∏–≤ –≥—Ä–∞—Ñ–∏–∫.

## –î–æ–±–∞–≤–ª–µ–Ω–∏–µ –≥—Ä–∞—Ñ–∏–∫–∞

–í–æ—Ç —Ç–∞–∫ –º—ã –±—ã –≤–∏–∑—É–∞–ª–∏–∑–∏—Ä–æ–≤–∞–ª–∏ –≤–µ—Ä–æ—è—Ç–Ω–æ—Å—Ç–∏ –≤–Ω–µ –ø—Ä–∏–ª–æ–∂–µ–Ω–∏—è:

```{r eval=FALSE}
tibble(category = class_names, probability = probs)  |>  
  ggplot(aes(y = reorder(category, probability), x = probability, fill = category)) +
  geom_col(width = 0.6, show.legend = FALSE) +
  scale_fill_brewer(palette = "Set2") +
  scale_x_continuous(labels = scales::percent_format(accuracy = 1)) +
  labs(x = "–í–µ—Ä–æ—è—Ç–Ω–æ—Å—Ç—å", y = "–ö–∞—Ç–µ–≥–æ—Ä–∏—è") +
  theme_minimal(base_size = 15) +
  theme(
    axis.title.y = element_blank(),
    plot.title = element_text(face="bold"),
    axis.text = element_text(size=12)
  )
```

–ù–∞ —Å–µ—Ä–≤–µ—Ä–µ –ø–æ—á—Ç–∏ –≤—Å–µ —Ç–æ –∂–µ —Å–∞–º–æ–µ, –Ω–æ –æ–±–æ—Ä–∞—á–∏–≤–∞–µ–º –≤ —Ä–µ–∞–∫—Ç–∏–≤–Ω–æ–µ –≤—ã—Ä–∞–∂–µ–Ω–∏–µ –∏ –ø—Ä–æ–≤–µ—Ä—è–µ–º –Ω–∞–ª–∏—á–∏–µ –≤–µ—Ä–æ—è—Ç–Ω–æ—Å—Ç–µ–π. –ö–æ–¥ –Ω–∏–∂–µ –Ω—É–∂–Ω–æ –¥–æ–±–∞–≤–∏—Ç—å –Ω–∞ —Å–µ—Ä–≤–µ—Ä.

```{r eval=FALSE}
output$prob_plot <- renderPlot({
    req(pred_result())
    tibble(category = class_names,
      probability = pred_result()$probs)  |> 
      ggplot(aes(y = reorder(category, probability), x = probability, fill = category)) +
      geom_col(width = 0.6, show.legend = FALSE) +
      scale_fill_brewer(palette = "Set2") +
      scale_x_continuous(labels = scales::percent_format(accuracy = 1)) +
      labs(x = "–í–µ—Ä–æ—è—Ç–Ω–æ—Å—Ç—å", y = "–ö–∞—Ç–µ–≥–æ—Ä–∏—è") +
      theme_minimal(base_size = 15) +
      theme(
        axis.title.y = element_blank(),
        plot.title = element_text(face="bold"),
        axis.text = element_text(size=12)
      )
  })
```

## –û—Ñ–æ—Ä–º–ª–µ–Ω–∏–µ

## –ü—É–±–ª–∏–∫–∞—Ü–∏—è