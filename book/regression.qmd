# –†–µ–≥—Ä–µ—Å—Å–∏–æ–Ω–Ω—ã–π –∞–Ω–∞–ª–∏–∑

–í —ç—Ç–æ–º —É—Ä–æ–∫–µ –º—ã –ø–æ–∑–Ω–∞–∫–æ–º–∏–º—Å—è —Å –º–µ—Ç–æ–¥–∞–º–∏ _–ø—Ä–æ—Å—Ç–æ–π_ –∏ _–º–Ω–æ–∂–µ—Å—Ç–≤–µ–Ω–æ–π –ª–∏–Ω–µ–π–Ω–æ–π —Ä–µ–≥—Ä–µ—Å—Å–∏–∏_. 

## –î–∞–Ω–Ω—ã–µ: –û–∫—Å—Ñ–æ—Ä–¥—Å–∫–∞—è –∫–µ—Ä–∞–º–∏–∫–∞

–î–∞–Ω–Ω—ã–µ –¥–ª—è —ç—Ç–æ–≥–æ —É—Ä–æ–∫–∞ –æ—Å–Ω–æ–≤–∞–Ω—ã –Ω–∞ –Ω–µ—Å–∫–æ–ª—å–∫–∏—Ö –ø—É–±–ª–∏–∫–∞—Ü–∏—è—Ö –Ø–Ω–∞ –•–æ–¥–¥–µ—Ä–∞, –∫–æ—Ç–æ—Ä—ã–π –ø—Ä–æ–∞–Ω–∞–ª–∏–∑–∏—Ä–æ–≤–∞–ª –ø—Ä–æ—Å—Ç—Ä–∞–Ω—Å—Ç–≤–µ–Ω–Ω–æ–µ —Ä–∞—Å–ø—Ä–µ–¥–µ–ª–µ–Ω–∏–µ –ø–æ–∑–¥–Ω–µ–π —Ä–æ–º–∞–Ω–æ-–±—Ä–∏—Ç–∞–Ω—Å–∫–æ–π –∫–µ—Ä–∞–º–∏–∫–∏, –ø—Ä–æ–∏–∑–≤–µ–¥–µ–Ω–Ω–æ–π –≤ –û–∫—Å—Ñ–æ—Ä–¥–µ, –≤ —Å—Ç–∞—Ç—å—è—Ö 1974 –≥. "[The Distribution of Two Types of Romano-British coarse pottery](https://www.jstor.org/stable/525737)"  –∏ "[A Regression Analysis of Some Trade and Marketing Patterns](https://www.jstor.org/stable/124001)". –î–∞—Ç–∞—Å–µ—Ç –¥–æ—Å—Ç—É–ø–µ–Ω –≤ –ø–∞–∫–µ—Ç–µ `archdata`, —Å–æ–¥–µ—Ä–∂–∞—â–µ–º –∏ –¥—Ä—É–≥–∏–µ –Ω–∞–±–æ—Ä—ã –¥–∞–Ω–Ω—ã—Ö –¥–ª—è –∞—Ä—Ö–µ–æ–ª–æ–≥–æ–≤.


```{r message=FALSE}
library(archdata)
library(tidyverse)
library(easystats)
library(equatiomatic)
library(broom)
library(gt)
data("OxfordPots")
OxfordPots
```

–î–∞—Ç–∞—Ñ—Ä–µ–π–º —Å–æ–¥–µ—Ä–∂–∏—Ç 30 –Ω–∞–±–ª—é–¥–µ–Ω–∏–π –ø–æ —Å–ª–µ–¥—É—é—â–∏–º 7 –ø–µ—Ä–µ–º–µ–Ω–Ω—ã–º:

- –º–µ—Å—Ç–æ;
- –ø—Ä–æ—Ü–µ–Ω—Ç –æ–∫—Å—Ñ–æ—Ä–¥—Å–∫–æ–π –∫–µ—Ä–∞–º–∏–∫–∏;
- —Ä–∞—Å—Å—Ç–æ—è–Ω–∏–µ –¥–æ –û–∫—Å—Ñ–æ—Ä–¥–∞ –≤ –º–∏–ª—è—Ö;
- –ø—Ä–æ—Ü–µ–Ω—Ç –≥–æ–Ω—á–∞—Ä–Ω—ã—Ö –∏–∑–¥–µ–ª–∏–π –∏–∑ –ù—å—é-–§–æ—Ä–µ—Å—Ç–∞;
- —Ä–∞—Å—Å—Ç–æ—è–Ω–∏–µ –¥–æ –ù—å—é-–§–æ—Ä–µ—Å—Ç–∞;
- –ø–ª–æ—â–∞–¥—å –æ–±–Ω–µ—Å–µ–Ω–Ω–æ–≥–æ —Å—Ç–µ–Ω–æ–π –≥–æ—Ä–æ–¥–∞;
- –Ω–∞–ª–∏—á–∏–µ –≤–æ–¥–Ω–æ–≥–æ —Ç—Ä–∞–Ω—Å–ø–æ—Ä—Ç–Ω–æ–≥–æ —Å–æ–æ–±—â–µ–Ω–∏—è.


## –ü—Ä–æ—Å—Ç–∞—è –ª–∏–Ω–µ–π–Ω–∞—è —Ä–µ–≥—Ä–µ—Å—Å–∏—è

–ü—Ä–æ—Å—Ç–∞—è –ª–∏–Ω–µ–π–Ω–∞—è —Ä–µ–≥—Ä–µ—Å—Å–∏—è -- –º–µ—Ç–æ–¥, –∫–æ—Ç–æ—Ä—ã–π –ø–æ–∑–≤–æ–ª—è–µ—Ç –ø—Ä–µ–¥—Å–∫–∞–∑—ã–≤–∞—Ç—å –∫–æ–ª–∏—á–µ—Å—Ç–≤–µ–Ω–Ω—ã–π –æ—Ç–∫–ª–∏–∫ –ø–µ—Ä–µ–º–µ–Ω–Ω–æ–π `y` –Ω–∞ –æ—Å–Ω–æ–≤–µ –µ–¥–∏–Ω—Å—Ç–≤–µ–Ω–Ω–æ–π –Ω–µ–∑–∞–≤–∏—Å–∏–º–æ–π –ø–µ—Ä–µ–º–µ–Ω–Ω–æ–π `x`. –°–ª—É—á–∞–π–Ω–∞—è –≤–µ–ª–∏—á–∏–Ω–∞, –∫–æ—Ç–æ—Ä–∞—è –∏—Å–ø–æ–ª—å–∑—É–µ—Ç—Å—è –¥–ª—è —Ü–µ–ª–µ–π –ø—Ä–µ–¥—Å–∫–∞–∑–∞–Ω–∏—è, –Ω–∞–∑—ã–≤–∞–µ—Ç—Å—è _–ø—Ä–µ–¥–∏–∫—Ç–æ—Ä–æ–º_. –í–µ–ª–∏—á–∏–Ω–∞, –∑–Ω–∞—á–µ–Ω–∏—è –∫–æ—Ç–æ—Ä–æ–π –ø—Ä–µ–¥—Å–∫–∞–∑—ã–≤–∞—é—Ç—Å—è, –Ω–∞–∑—ã–≤–∞–µ—Ç—Å—è _–ø–µ—Ä–µ–º–µ–Ω–Ω–æ–π –æ—Ç–∫–ª–∏–∫–∞_. –ó–¥–µ—Å—å –º—ã –æ—Å–≤–æ–∏–º –ª–∏—à—å —Å–∞–º—ã–µ –∞–∑—ã, –ø–æ–¥—Ä–æ–±–Ω–µ–µ —Å—Ç–æ–∏—Ç –ø–æ—Å–º–æ—Ç—Ä–µ—Ç—å —Å–æ–æ—Ç–≤–µ—Ç—Å—Ç–≤—É—é—â–∏–µ —É—Ä–æ–∫–∏ –∫—É—Ä—Å–∞ "[Introduction to Modern Statistics (2e)](https://openintro-ims.netlify.app/)".


### –õ–∏–Ω–µ–π–Ω–∞—è —Ñ—É–Ω–∫—Ü–∏—è 

–ß—Ç–æ–±—ã —Ä–∞–∑–æ–±—Ä–∞—Ç—å—Å—è —Å —Ä–µ–≥—Ä–µ—Å—Å–∏–µ–π, –Ω–∞–¥–æ –≤—Å–ø–æ–º–Ω–∏—Ç—å, —á—Ç–æ —Ç–∞–∫–æ–µ –ª–∏–Ω–µ–π–Ω–∞—è –∑–∞–≤–∏—Å–∏–º–æ—Å—Ç—å:

$$y\approx\beta_o + \beta_1x$$ 

–í —ç—Ç–æ–º —É—Ä–∞–≤–Ω–µ–Ω–∏–∏ $\beta_o$ –∏ $\beta_1$ - —ç—Ç–æ –∫–æ–Ω—Å—Ç–∞–Ω—Ç—ã, –∏–∑–≤–µ—Å—Ç–Ω—ã–µ –∫–∞–∫ _—Å–≤–æ–±–æ–¥–Ω—ã–π —á–ª–µ–Ω_ –∏ _—É–≥–æ–ª –Ω–∞–∫–ª–æ–Ω–∞_ –ª–∏–Ω–µ–π–Ω–æ–π –º–æ–¥–µ–ª–∏. –°–æ–≤–æ–∫—É–ø–Ω–æ –∏—Ö –Ω–∞–∑—ã–≤–∞—é—Ç _–∫–æ—ç—Ñ—Ñ–∏—Ü–∏–µ–Ω—Ç–∞–º–∏_, –∏–ª–∏ –ø–∞—Ä–∞–º–µ—Ç—Ä–∞–º–∏,  –º–æ–¥–µ–ª–∏. –ì–µ–æ–º–µ—Ç—Ä–∏—á–µ—Å–∫–∏ –ø–µ—Ä–≤—ã–π –∏–∑ –Ω–∏—Ö –æ–ø—Ä–µ–¥–µ–ª—è–µ—Ç —Ç–æ—á–∫—É –ø–µ—Ä–µ—Å–µ—á–µ–Ω–∏—è –æ—Å–∏ y (`intercept`), –∞ –≤—Ç–æ—Ä–æ–π -- —É–≥–æ–ª –Ω–∞–∫–ª–æ–Ω–∞ (`slope`). 

–ü–æ—Å–º–æ—Ç—Ä–∏—Ç–µ –≤–Ω–∏–º–∞—Ç–µ–ª—å–Ω–æ –Ω–∞ –ª–∏–Ω–∏–∏ –Ω–∞ –ø—Ä–∏–º–µ—Ä–µ –∏ –ø–æ–¥—É–º–∞–π—Ç–µ, —á–µ–º –æ–Ω–∏ –æ—Ç–ª–∏—á–∞—é—Ç—Å—è.

![](images/linear.png)

### –û—à–∏–±–∫–∞ –ø—Ä–æ–≥–Ω–æ–∑–∞

–ù–∞ –ø—Ä–∞–∫—Ç–∏–∫–µ –ª–∏–Ω–µ–π–Ω–∞—è –∑–∞–≤–∏—Å–∏–º–æ—Å—Ç—å –≤ —á–∏—Å—Ç–æ–º –≤–∏–¥–µ –ø–æ—á—Ç–∏ –Ω–µ –≤—Å—Ç—Ä–µ—á–∞–µ—Ç—Å—è: –≤—Å–µ–≥–¥–∞ –µ—Å—Ç—å –Ω–µ–±–æ–ª—å—à–∞—è –æ—à–∏–±–∫–∞ –ø—Ä–æ–≥–Ω–æ–∑–∞ ($\epsilon$):

$$y\approx\beta_o + \beta_1x + \epsilon$$ 

```{r echo=FALSE, message=FALSE}
library(paletteer)
cols <- paletteer_d("ggthemes::wsj_rgby")

set.seed(03102024)
tibble(x = rnorm(50),
       e = rnorm(50),
       y = 10 + 3*x + e) |> 
  ggplot(aes(x, y)) +
  geom_point(color = cols[3], size = 3, alpha = 0.7) +
  geom_smooth(method = "lm", color = cols[2], se = FALSE) +
  theme_minimal()
```
–ü—Ä–∏ —Å–æ–∑–¥–∞–Ω–∏–∏ —Ä–µ–≥—Ä–µ—Å—Å–∏–æ–Ω–Ω–æ–π –º–æ–¥–µ–ª–∏ –Ω–∞—à–∞ –∑–∞–¥–∞—á–∞ –∑–∞–∫–ª—é—á–∞–µ—Ç—Å—è –≤ —Ç–æ–º, —á—Ç–æ–±—ã –Ω–∞ –æ—Å–Ω–æ–≤–µ –¥–æ—Å—Ç—É–ø–Ω—ã—Ö –Ω–∞–±–ª—é–¥–µ–Ω–∏–π –ø–æ–¥–æ–±—Ä–∞—Ç—å –∫–æ—ç—Ñ—Ñ–∏—Ü–∏–µ–Ω—Ç—ã $\beta_0$ –∏ $\beta_1$ —Ç–∞–∫–∏–º –æ–±—Ä–∞–∑–æ–º, —á—Ç–æ–±—ã –º–∏–Ω–∏–º–∏–∑–∏—Ä–æ–≤–∞—Ç—å –æ—à–∏–±–∫—É. 


$$\sum(y_i- \hat y)^2 = \sum\epsilon^2$$


–ß—Ç–æ–±—ã –ø–æ–¥—á–µ—Ä–∫–Ω—É—Ç—å, —á—Ç–æ —Ä–µ—á—å –∏–¥–µ—Ç –ª–∏—à—å –æ–± –æ—Ü–µ–Ω–∫–µ, –Ω–∞–¥ –±–µ—Ç–æ–π —Å—Ç–∞–≤–∏—Ç—Å—è "–∫—Ä—ã—à–µ—á–∫–∞": 

$$\hat y \approx \hat\beta_o + \hat\beta_1x$$

### –ü—Ä–æ—Å—Ç–∞—è —Ä–µ–≥—Ä–µ—Å—Å–∏—è —Å `lm()`

–ü–æ—Å–º–æ—Ç—Ä–∏–º, –∫–∞–∫ —Å–≤—è–∑–∞–Ω—ã –º–µ–∂–¥—É —Å–æ–±–æ–π –ø—Ä–æ—Ü–µ–Ω—Ç –∫–µ—Ä–∞–º–∏—á–µ—Å–∫–∏—Ö –∏–∑–¥–µ–ª–∏–π –∏–∑ –û–∫—Å—Ñ–æ—Ä–¥–∞ –∏ —Ä–∞—Å—Å—Ç–æ—è–Ω–∏–µ –æ—Ç —Ü–µ–Ω—Ç—Ä–∞ –ø—Ä–æ–∏–∑–≤–æ–¥—Å—Ç–≤–∞.

```{r message=FALSE}
library(paletteer)
cols <- paletteer_d("ggthemes::wsj_rgby")

OxfordPots |> 
  ggplot(aes(OxfordDst, OxfordPct)) +
  geom_smooth(method = "lm", color = cols[2], se = FALSE) +
  geom_point(color = cols[3], 
              size = 3, 
              alpha = 0.6
              ) +
  theme_minimal() 
```

–ß–µ–º –¥–∞–ª—å—à–µ –æ—Ç –û–∫—Å—Ñ–æ—Ä–¥–∞, —Ç–µ–º –º–µ–Ω—å—à–µ –∫–µ—Ä–∞–º–∏—á–µ—Å–∫–∏—Ö –∏–∑–¥–µ–ª–∏–π –æ—Ç—Ç—É–¥–∞, –ø–æ—ç—Ç–æ–º—É –ª–∏–Ω–∏—è –∏–º–µ–µ—Ç –æ—Ç—Ä–∏—Ü–∞—Ç–µ–ª—å–Ω—ã–π –Ω–∞–∫–ª–æ–Ω. 

–ò –Ω–∞–∫–ª–æ–Ω, –∏ —Ç–æ—á–∫—É –ø–µ—Ä–µ—Å–µ—á–µ–Ω–∏—è —Å –æ—Å—å—é y –æ–ø—Ä–µ–¥–µ–ª—è–µ—Ç —Ñ—É–Ω–∫—Ü–∏—è `lm`. 

```{r}
fit <- lm(OxfordPct ~ OxfordDst, data = OxfordPots)
parameters(fit)
```


```{r echo=FALSE}
parameters(fit) |> 
  gt()  |> 
  fmt_number(
    columns = where(is.numeric),  
    decimals = 2                
  ) |>
  tab_style(
    style = cell_text(weight = "bold"),  # Bold column labels
    locations = cells_column_labels()   # This targets all column headers
  )
```
## –ü–∞—Ä–∞–º–µ—Ç—Ä—ã –º–æ–¥–µ–ª–∏

### –ö–æ—ç—Ñ—Ñ–∏—Ü–∏–µ–Ω—Ç—ã –º–æ–¥–µ–ª–∏

–ü–µ—Ä–≤—ã–π —Å—Ç–æ–ª–±–µ—Ü –≤ —Ç–∞–±–ª–∏—Ü–µ —Å –ø–∞—Ä–∞–º–µ—Ç—Ä–∞–º–∏ —Å–æ–¥–µ—Ä–∂–∏—Ç –∫–æ—ç—Ñ—Ñ–∏—Ü–∏–µ–Ω—Ç—ã –º–æ–¥–µ–ª–∏. 

```{r echo=FALSE}
parameters(fit) |> 
  gt() |> 
  fmt_number(
    columns = where(is.numeric),  
    decimals = 2                  
  ) |> 
  tab_style(
    style = list(
      cell_fill(color = cols[1]),
      cell_text(weight = "bold")
    ),
    locations = cells_body(columns = Coefficient)
  ) |>
  tab_style(
    style = cell_text(weight = "bold"),  # Bold column labels
    locations = cells_column_labels()   # This targets all column headers
  )
```


–≠—Ç–æ –∑–Ω–∞—á–∏—Ç, —á—Ç–æ –Ω–∞—à–∏ –¥–∞–Ω–Ω—ã–µ –æ–ø–∏—Å—ã–≤–∞—é—Ç—Å—è —Ñ—É–Ω–∫—Ü–∏–µ–π:

```{r}
extract_eq(fit, use_coefs = TRUE)
```


–ò–Ω—Ç—É–∏—Ç–∏–≤–Ω–æ –ø–æ–Ω—è—Ç–Ω–æ, —á—Ç–æ –∫–æ—ç—Ñ—Ñ–∏—Ü–∏–µ–Ω—Ç $\beta_1$ —Å–≤—è–∑–∞–Ω —Å –∫–æ–≤–∞—Ä–∏–∞—Ü–∏–µ–π (–º–µ—Ä–æ–π —Å–æ–≤–º–µ—Å—Ç–Ω–æ–π –∏–∑–º–µ–Ω—á–∏–≤–æ—Å—Ç–∏ –¥–≤—É—Ö –≤–µ–ª–∏—á–∏–Ω). –î–µ–π—Å—Ç–≤–∏—Ç–µ–ª—å–Ω–æ, –æ–Ω —Ä–∞—Å—Å—á–∏—Ç—ã–≤–∞–µ—Ç—Å—è –ø–æ —Ñ–æ—Ä–º—É–ª–µ: 

$$\beta_1=\frac{Cov(x,y)}{Var(x)}$$
<details>
<summary>–ü—Ä–æ–≤–µ—Ä–∏—Ç—å.</summary>


```{r}
x <- OxfordPots$OxfordDst
y <- OxfordPots$OxfordPct

beta_1<- cov(x, y) / var(x)
beta_1
```

</details>


–ó–Ω–∞—è $\beta_1$, –º–æ–∂–Ω–æ –≤—ã—á–∏—Å–ª–∏—Ç—å $\beta_0$ –ø–æ —Ñ–æ—Ä–º—É–ª–µ:

$$\beta_0=\bar y - \beta_1 \bar x$$
<details>
<summary>–°–Ω–æ–≤–∞ –ø—Ä–æ–≤–µ—Ä–∏–º.</summary>

```{r}
beta_0 = mean(y) - beta_1 * mean(x)
beta_0
```

</details>



### –°—Ç–∞–Ω–¥–∞—Ä—Ç–Ω—ã–µ –æ—à–∏–±–∫–∏ –∫–æ—ç—Ñ—Ñ–∏—Ü–∏–µ–Ω—Ç–æ–≤

–î–ª—è –æ–±–æ–∏—Ö –∫–æ—ç—Ñ—Ñ–∏—Ü–∏–µ–Ω—Ç–æ–≤ –ø—Ä–∏–≤–µ–¥–µ–Ω–∞ —Å—Ç–∞–Ω–¥–∞—Ä—Ç–Ω–∞—è –æ—à–∏–±–∫–∞ –∏ t-—Å—Ç–∞—Ç–∏—Å—Ç–∏–∫–∞. –°—Ç–æ–ª–±–µ—Ü `t`, –∫–∞–∫ –ª–µ–≥–∫–æ —É–±–µ–¥–∏—Ç—å—Å—è, —Å–æ–¥–µ—Ä–∂–∏—Ç —Ä–µ–∑—É–ª—å—Ç–∞—Ç –¥–µ–ª–µ–Ω–∏—è –∫–æ—ç—Ñ—Ñ–∏—Ü–µ–Ω—Ç–æ–≤ –Ω–∞ —Å—Ç–∞–Ω–¥–∞—Ä—Ç–Ω—É—é –æ—à–∏–±–∫—É.

```{r echo=FALSE}
parameters(fit) |> 
  gt() |> 
  fmt_number(
    columns = where(is.numeric),  
    decimals = 2                  
  ) |> 
  tab_style(
    style = list(
      cell_fill(color = cols[1]),
      cell_text(weight = "bold")
    ),
    locations = cells_body(columns = c(SE, t))
    ) |>
  tab_style(
    style = cell_text(weight = "bold"),  
    locations = cells_column_labels()   
  )
```

<details>
<summary>–ö–∞–∫ —Ä–∞—Å—Å—á–∏—Ç—ã–≤–∞—é—Ç—Å—è —Å—Ç–∞–Ω–¥–∞—Ä—Ç–Ω—ã–µ –æ—à–∏–±–∫–∏.</summary>

–°—Ç–∞–Ω–¥–∞—Ä—Ç–Ω–∞—è –æ—à–∏–±–∫–∞ –¥–ª—è $\beta_0$ —Ä–∞—Å—Å—á–∏—Ç—ã–≤–∞–µ—Ç—Å—è –ø–æ —Ñ–æ—Ä–º—É–ª–µ:

$$SE(\beta_0)=\sqrt{\frac{\sum_{i=1}^n\epsilon^2}{n-2}} \times \sqrt{\frac{1}{n}+\frac{\bar x^2}{\sum_{i=1}^n(x_i-\bar x)^2}}$$

–ü–µ—Ä–≤—ã–π –º–Ω–æ–∂–∏—Ç–µ–ª—å –≤ —ç—Ç–æ–π —Ñ–æ—Ä–º—É–ª–µ -- —ç—Ç–æ –¥–∏—Å–ø–µ—Ä—Å–∏—è –æ—Å—Ç–∞—Ç–∫–æ–≤ –º–æ–¥–µ–ª–∏. –ß–µ–º –æ–Ω–∞ –±–æ–ª—å—à–µ, —Ç–µ–º –±–æ–ª—å—à–µ –Ω–µ–æ–ø—Ä–µ–¥–µ–ª–µ–Ω–Ω–æ—Å—Ç—å.  –ù–∞ –≤—Ç–æ—Ä–æ–π –º–Ω–æ–∂–∏—Ç–µ–ª—å –≤–ª–∏—è–µ—Ç –∫–∞–∫ —Ä–∞–∑–º–µ—Ä –≤—ã–±–æ—Ä–∫–∏, —Ç–∞–∫ –∏ —Ä–∞–∑–±—Ä–æ—Å –Ω–µ–∑–∞–≤–∏—Å–∏–º–æ–π –ø–µ—Ä–µ–º–µ–Ω–Ω–æ–π `x`: —á–µ–º –±–æ–ª—å—à–µ —Ä–∞–∑–º–µ—Ä –≤—ã–±–æ—Ä–∫–∏ n, —Ç–µ–º –º–µ–Ω—å—à–µ $\frac{1}{n}$ –∏ —á–µ–º –±–æ–ª—å—à–µ $Œ£(x - \bar x)^2$, —Ç–µ–º –º–µ–Ω—å—à–µ –≤—Ç–æ—Ä–æ–π –º–Ω–æ–∂–∏—Ç–µ–ª—å. –ü–æ—Å—á–∏—Ç–∞–µ–º –≤—Ä—É—á—É—é –∏ —Å—Ä–∞–≤–Ω–∏–º —Å —Ä–µ–∑—É–ª—å—Ç–∞—Ç–æ–º, –∫–æ—Ç–æ—Ä—ã–π –≤–æ–∑–≤—Ä–∞—â–∞–µ—Ç –∫–æ–º–∞–Ω–¥–∞ `summary(fit)`.

```{r}
x_bar <- mean(x)

mult1 <- sqrt(sum(fit$residuals^2) / 28)
mult2 <- sqrt(1/30 + ( x_bar^2 / sum((x - x_bar)^2)))

mult1 * mult2
```

–°—Ç–∞–Ω–¥–∞—Ä—Ç–Ω–∞—è –æ—à–∏–±–∫–∞ –¥–ª—è $\beta_1$ —Ä–∞—Å—Å—á–∏—Ç—ã–≤–∞–µ—Ç—Å—è –ø–æ —Ñ–æ—Ä–º—É–ª–µ: 

$$SE(b_1)=\sqrt{\frac{\frac{\sum_{i=1}^n\epsilon^2}{n-2}}{\sum_{i=1}^n(x_i-\bar x)^2}}$$

–ë–æ–ª—å—à–∞—è –¥–∏—Å–ø–µ—Ä—Å–∏—è –æ—Å—Ç–∞—Ç–∫–æ–≤ (–≤ —á–∏—Å–ª–∏—Ç–µ–ª–µ) –±—É–¥–µ—Ç –ø—Ä–∏–≤–æ–¥–∏—Ç—å –∫ —É–≤–µ–ª–∏—á–µ–Ω–∏—é –æ—à–∏–±–∫–∏, –∞ —Ä–∞–∑–º–∞—Ö $x_i$ --  –∫ —É–º–µ–Ω—å—à–µ–Ω–∏—é; –∏–Ω—Ç—É–∏—Ç–∏–≤–Ω–æ —ç—Ç–æ –æ–±—ä—è—Å–Ω—è–µ—Ç—Å—è —Ç–µ–º, —á—Ç–æ –≤ —Ç–∞–∫–æ–º —Å–ª—É—á–∞–µ —É –Ω–∞—Å –±–æ–ª—å—à–µ –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏–∏ –¥–ª—è –æ—Ü–µ–Ω–∏–≤–∞–Ω–∏—è —É–≥–ª–∞ –Ω–∞–∫–ª–æ–Ω–∞. –°–Ω–æ–≤–∞ –ø–µ—Ä–µ–ø—Ä–æ–≤–µ—Ä–∏–º.

```{r}
mult1 / sqrt(sum((x - x_bar)^2))
```

</details>

–§—É–Ω–∫—Ü–∏—è `geom_smooth` –¥–æ–±–∞–≤–ª—è–µ—Ç —Å—Ç–∞–Ω–¥–∞—Ä—Ç–Ω—É—é –æ—à–∏–±–∫—É –∫–æ—ç—Ñ—Ñ–∏—Ü–∏–µ–Ω—Ç–∞ –Ω–∞–∫–ª–æ–Ω–∞ –Ω–∞ –≥—Ä–∞—Ñ–∏–∫ –≤ –≤–∏–¥–µ —Å–µ—Ä–æ–π –ø–æ–ª–æ—Å—ã, –∫–æ—Ç–æ—Ä–∞—è –æ–∑–Ω–∞—á–∞–µ—Ç, —á—Ç–æ —Å –≤–µ—Ä–æ—è—Ç–Ω–æ—Å—Ç—å—é 95% (–∑–Ω–∞—á–µ–Ω–∏–µ –ø–æ —É–º–æ–ª—á–∞–Ω–∏—é, –∫–æ—Ç–æ—Ä–æ–µ –º–æ–∂–Ω–æ –ø–æ–º–µ–Ω—è—Ç—å) –∏—Å—Ç–∏–Ω–Ω–æ–µ –∑–Ω–∞—á–µ–Ω–∏–µ –æ—Ç–∫–ª–∏–∫–∞ –Ω–∞—Ö–æ–¥–∏—Ç—Å—è –≤ —ç—Ç–æ–π –∑–æ–Ω–µ (`predicted ¬± 1.95 * se`). –í —Å—Ç–∞—Ç–∏—Å—Ç–∏–∫–µ —ç—Ç–æ –Ω–∞–∑—ã–≤–∞–µ—Ç—Å—è _–¥–æ–≤–µ—Ä–∏—Ç–µ–ª—å–Ω—ã–π –∏–Ω—Ç–µ—Ä–≤–∞–ª_.

```{r message=FALSE}
OxfordPots |> 
  ggplot(aes(OxfordDst, OxfordPct)) +
  geom_smooth(method = "lm", color = cols[2], 
              se = TRUE, level = 0.95) +
  geom_point(color = cols[3], 
              size = 3, 
              alpha = 0.6
              ) +
  theme_minimal() 
```

### P-–∑–Ω–∞—á–µ–Ω–∏—è

–°—Ç–æ–ª–±–µ—Ü `p.value` —É–∫–∞–∑—ã–≤–∞–µ—Ç, –∫–∞–∫–æ–≤–∞ –≤–µ—Ä–æ—è—Ç–Ω–æ—Å—Ç—å —Å–ª—É—á–∞–π–Ω–æ –ø–æ–ª—É—á–∏—Ç—å —Ç–∞–∫–æ–µ –∑–Ω–∞—á–µ–Ω–∏–µ. –í –Ω–∞—à–µ–º —Å–ª—É—á–∞–µ -- –ø–æ—á—Ç–∏ 0, —á—Ç–æ –≥–æ–≤–æ—Ä–∏—Ç –æ —Ç–æ–º, —á—Ç–æ –¥–æ–ª—è –æ–∫—Å—Ñ–æ—Ä–¥—Å–∫–æ–π –∫–µ—Ä–∞–º–∏–∫–∏ –Ω–∞ —É—á–∞—Å—Ç–∫–µ –¥–µ–π—Å—Ç–≤–∏—Ç–µ–ª—å–Ω–æ –∑–∞–≤–∏—Å–∏—Ç –æ—Ç —Ä–∞—Å—Å—Ç–æ—è–Ω–∏—è. 


```{r echo=FALSE}
parameters(fit) |> 
  gt() |> 
  fmt_number(
    columns = where(is.numeric),  
    decimals = 2                  
  ) |> 
  tab_style(
    style = list(
      cell_fill(color = cols[1]),
      cell_text(weight = "bold")
    ),
    locations = cells_body(columns = c(p))
    ) |>
  tab_style(
    style = cell_text(weight = "bold"),  
    locations = cells_column_labels()   
  )
```

<details>
<summary>–ö–∞–∫ —Å—á–∏—Ç–∞–µ—Ç—Å—è p-value.</summary>

```{r}
tidy(fit) |> 
  transmute(t_stat = estimate / std.error) |> 
  mutate(p_val = 2*pt(abs(t_stat), 28, lower.tail = FALSE)) |> 
  export_table()
```

–†–µ–∑—É–ª—å—Ç–∞—Ç, –≤–æ–∑–≤—Ä–∞—â–∞–µ–º—ã–π —Ñ—É–Ω–∫—Ü–∏–µ–π `pt()`, —É–º–Ω–æ–∂–∞–µ—Ç—Å—è –Ω–∞ –¥–≤–∞, —Ç.–∫. –∏—Å–ø–æ–ª—å–∑—É–µ—Ç—Å—è –¥–≤—É—Å—Ç–æ—Ä–æ–Ω–Ω–∏–π t-test. –ë—É–∫–≤–∞ `p` –≤ –Ω–∞–∑–≤–∞–Ω–∏–∏ –æ–∑–Ω–∞—á–∞–µ—Ç —Ñ—É–Ω–∫—Ü–∏—é —Ä–∞—Å–ø—Ä–µ–¥–µ–ª–µ–Ω–∏—è –≤–µ—Ä–æ—è—Ç–Ω–æ—Å—Ç–µ–π (probability), –∞ `t` -- —Ä–∞—Å–ø—Ä–µ–¥–µ–ª–µ–Ω–∏–µ –°—Ç—å—é–¥–µ–Ω—Ç–∞ –¥–ª—è –∑–∞–¥–∞–Ω–Ω–æ–≥–æ —á–∏—Å–ª–∞ —Å—Ç–µ–ø–µ–Ω–µ–π —Å–≤–æ–±–æ–¥—ã (28 –≤ –Ω–∞—à–µ–º —Å–ª—É—á–∞–µ).

</details>


## –û—Ü–µ–Ω–∫–∞ –º–æ–¥–µ–ª–∏

–û–±—â–∞—è –æ—Ü–µ–Ω–∫–∞ –º–æ–¥–µ–ª–∏ –ø—Ä–æ–≤–æ–¥–∏—Ç—Å—è –ø—Ä–∏ –ø–æ–º–æ—â–∏ —Ñ—É–Ω–∫—Ü–∏–∏ `performance()` –∏–∑ –ø–∞–∫–µ—Ç–∞ `{easystats}` –∏–ª–∏ –±–∞–∑–æ–≤–æ–π `summary()`.

```{r}
performance(fit)
```

```{r echo=FALSE}
performance(fit) |> 
  gt() |> 
  fmt_number(
    columns = where(is.numeric),  
    decimals = 3                  
  ) |> 
  tab_style(
    style = cell_text(weight = "bold"),  
    locations = cells_column_labels()   
  )
```

### RSE, MSE, RMSE

```{r echo=FALSE}
performance(fit) |> 
  gt() |> 
  fmt_number(
    columns = where(is.numeric),  
    decimals = 3                  
  ) |> 
  tab_style(
    style = cell_text(weight = "bold"),  
    locations = cells_column_labels()   
  ) |> 
  tab_style(
    style = list(
      cell_fill(color = cols[1]),
      cell_text(weight = "bold")
    ),
    locations = cells_body(columns = c(Sigma, RMSE))
    ) 
```

–ü–æ—Å–∫–æ–ª—å–∫—É –Ω–∞—à–∏ –æ—Ü–µ–Ω–∫–∏ –º–æ–≥—É—Ç –±—ã—Ç—å –∫–∞–∫ –∑–∞–≤—ã—à–µ–Ω–Ω—ã–º–∏, —Ç–∞–∫ –∏ –∑–∞–Ω–∏–∂–µ–Ω–Ω—ã–º–∏, –∑–Ω–∞—á–µ–Ω–∏—è –æ—à–∏–±–æ–∫ –≤–æ–∑–≤–æ–¥—è—Ç—Å—è –≤ –∫–≤–∞–¥—Ä–∞—Ç –∏ —Å—É–º–º–∏—Ä—É—é—Ç—Å—è –ø–æ –≤—Å–µ–º —Ç–æ—á–∫–∞–º –¥–∞–Ω–Ω—ã—Ö. –£–∑–Ω–∞–µ–º —Å—É–º–º—É –∫–≤–∞–¥—Ä–∞—Ç–æ–≤ –æ—Å—Ç–∞—Ç–∫–æ–≤ (RSS = Residual sum of squares), –∫–æ—Ç–æ—Ä–∞—è —Å—á–∏—Ç–∞–µ—Ç—Å—è –ø–æ —Ñ–æ—Ä–º—É–ª–µ:

$$RSS = \sum_{i=n}^n(y_i- \hat y_i)^2$$

```{r}
rss <- sum(fit$residuals^2)
rss
```

–ó–Ω–∞—è —ç—Ç–æ —á–∏—Å–ª–æ, –æ–ø—Ä–µ–¥–µ–ª—è–µ–º _—Å—Ä–µ–¥–Ω–µ–∫–≤–∞–¥—Ä–∞—Ç–∏—á–Ω—É—é –æ—à–∏–±–∫—É_ (MSE = Mean square error), _–∫–æ—Ä–µ–Ω—å  –∏–∑ —Å—Ä–µ–¥–Ω–µ–∫–≤–∞–¥—Ä–∞—Ç–∏—á–Ω–æ–π –æ—à–∏–±–∫–∏_  (RMSE), –∞ —Ç–∞–∫–∂–µ _—Å—Ç–∞–Ω–¥–∞—Ä—Ç–Ω—É—é –æ—à–∏–±–∫—É –æ—Å—Ç–∞—Ç–∫–æ–≤_ (RSE = Residual standard error). 

```{r}
mse <- rss / length(fit$residuals)
mse

rmse <- sqrt(mse)
rmse
```

```{r}
rse <-  sqrt(rss / fit$df.residual)
rse
```


### $R^2$

RSE -- —ç—Ç–æ –º–µ—Ä–∞ –Ω–µ—Å–æ–æ—Ç–≤–µ—Ç—Å—Ç–≤–∏—è –º–æ–¥–µ–ª–∏ –¥–∞–Ω–Ω—ã–º. –ù–æ –ø–æ—Å–∫–æ–ª—å–∫—É –æ–Ω–∞ –≤—ã—Ä–∞–∂–∞–µ—Ç—Å—è –≤ —Ç–µ—Ö –∂–µ –µ–¥–∏–Ω–∏—Ü–∞—Ö –∏–∑–º–µ—Ä–µ–Ω–∏—è, —á—Ç–æ –∏ `y`, —Ç–æ –Ω–µ –≤—Å–µ–≥–¥–∞ –±—ã–≤–∞–µ—Ç —è—Å–Ω–æ, –∫–∞–∫–∞—è RSE —è–≤–ª—è–µ—Ç—Å—è —Ö–æ—Ä–æ—à–µ–π. –ö–æ—ç—Ñ—Ñ–∏—Ü–∏–µ–Ω—Ç –¥–µ—Ç–µ—Ä–º–∏–Ω–∞—Ü–∏–∏ $R^2$ –ø—Ä–µ–¥—Å—Ç–∞–≤–ª—è–µ—Ç —Å–æ–±–æ–π –∞–ª—å—Ç–µ—Ä–Ω–∞—Ç–∏–≤–Ω—É—é –º–µ—Ä—É —Å–æ–æ—Ç–≤–µ—Ç—Å—Ç–≤–∏—è. –≠—Ç–æ—Ç –ø–æ–∫–∞–∑–∞—Ç–µ–ª—å –ø—Ä–∏–Ω–∏–º–∞–µ—Ç —Ñ–æ—Ä–º—É –¥–æ–ª–∏ -- –¥–æ–ª–∏ –æ–±—ä—è—Å–Ω–µ–Ω–Ω–æ–π –¥–∏—Å–ø–µ—Ä—Å–∏–∏, –≤ —Å–≤—è–∑–∏ —Å —á–µ–º –æ–Ω –≤—Å–µ–≥–¥–∞ –∏–∑–º–µ–Ω—è–µ—Ç—Å—è –æ—Ç 0 –¥–æ 1 –∏ –Ω–µ –∑–∞–≤–∏—Å–∏—Ç –æ—Ç —à–∫–∞–ª—ã –∏–∑–º–µ—Ä–µ–Ω–∏—è.

$$R^2 = \frac{TSS-RSS}{TSS} = 1 - \frac{RSS}{TSS}$$
–ó–¥–µ—Å—å $TSS = \sum(y_i - \bar y)^2$, —Ç–æ –µ—Å—Ç—å –æ–±—â–∞—è —Å—É–º–º–∞ –∫–≤–∞–¥—Ä–∞—Ç–æ–≤. 

`TSS` —è–≤–ª—è–µ—Ç—Å—è –º–µ—Ä–æ–π –æ–±—â–µ–π –¥–∏—Å–ø–µ—Ä—Å–∏–∏ –æ—Ç–∫–ª–∏–∫–∞ Y, –∏ –æ –Ω–µ–π –º–æ–∂–Ω–æ –¥—É–º–∞—Ç—å –∫–∞–∫ –æ —Å—Ç–µ–ø–µ–Ω–∏ –∏–∑–º–µ–Ω—á–∏–≤–æ—Å—Ç–∏, –ø—Ä–∏—Å—É—â–µ–π –æ—Ç–∫–ª–∏–∫—É –¥–æ –≤—ã–ø–æ–ª–Ω–µ–Ω–∏—è —Ä–µ–≥—Ä–µ—Å—Å–∏–æ–Ω–Ω–æ–≥–æ –∞–Ω–∞–ª–∏–∑–∞. –í —Ç–æ –∂–µ –≤—Ä–µ–º—è `RSS` –≤—ã—Ä–∞–∂–∞–µ—Ç —Å—Ç–µ–ø–µ–Ω—å –∏–∑–º–µ–Ω—á–∏–≤–æ—Å—Ç–∏, –∫–æ—Ç–æ—Ä–∞—è –æ—Å—Ç–∞–ª–∞—Å—å –Ω–µ–æ–±—ä—è—Å–Ω–µ–Ω–Ω–æ–π –ø–æ—Å–ª–µ –ø–æ—Å—Ç—Ä–æ–µ–Ω–∏—è —Ä–µ–≥—Ä–µ—Å—Å–∏–æ–Ω–Ω–æ–π –º–æ–¥–µ–ª–∏. –°–ª–µ–¥–æ–≤–∞—Ç–µ–ª—å–Ω–æ, `TSS - RSS` –≤—ã—Ä–∞–∂–∞–µ—Ç –∫–æ–ª–∏—á–µ—Å—Ç–≤–æ –¥–∏—Å–ø–µ—Ä—Å–∏–∏ –æ—Ç–∫–ª–∏–∫–∞, –æ–±—ä—è—Å–Ω–µ–Ω–Ω–æ–µ ("–∏–∑—ä—è—Ç–æ–µ") –ø–æ—Å–ª–µ –≤—ã–ø–æ–ª–Ω–µ–Ω–∏—è —Ä–µ–≥—Ä–µ—Å—Å–∏–æ–Ω–Ω–æ–≥–æ –∞–Ω–∞–ª–∏–∑–∞, –∞ $R^2$ -- –¥–æ–ª—é –¥–∏—Å–ø–µ—Ä—Å–∏–∏ Y, –æ–±—ä—è—Å–Ω–µ–Ω–Ω—É—é –ø—Ä–∏ –ø–æ–º–æ—â–∏ X. –°—Ç–∞—Ç–∏—Å—Ç–∏–∫–∞ $R^2$, –±–ª–∏–∑–∫–∞—è –∫ 1, –æ–∑–Ω–∞—á–∞–µ—Ç, —á—Ç–æ –∑–Ω–∞—á–∏—Ç–µ–ª—å–Ω–∞—è –¥–æ–ª—è –∏–∑–º–µ–Ω—á–∏–≤–æ—Å—Ç–∏ –æ—Ç–∫–ª–∏–∫–∞ –±—ã–ª–∞ –æ–±—ä—è—Å–Ω–µ–Ω–∞ —Ä–µ–≥—Ä–µ—Å—Å–∏–æ–Ω–Ω–æ–π –º–æ–¥–µ–ª—å—é [@—Ö–∞—Å—Ç–∏2017, 82].

```{r}
tss <- sum((y - mean(y))^2)
tss

1 - rss / tss
```

–°–Ω–æ–≤–∞ —Å—Ä–∞–≤–Ω–∏–º —Å —Ä–µ–∑—É–ª—å—Ç–∞—Ç–æ–º, –∫–æ—Ç–æ—Ä—ã–π –Ω–∞–º –≤–µ—Ä–Ω—É–ª–∞ –º–æ–¥–µ–ª—å.

```{r echo=FALSE}
performance(fit) |> 
  gt() |> 
  fmt_number(
    columns = where(is.numeric),  
    decimals = 3                  
  ) |> 
  tab_style(
    style = cell_text(weight = "bold"),  
    locations = cells_column_labels()   
  ) |> 
  tab_style(
    style = list(
      cell_fill(color = cols[1]),
      cell_text(weight = "bold")
    ),
    locations = cells_body(columns = c(R2))
    ) 
```

–î–ª—è –ø—Ä–æ—Å—Ç–æ–π –ª–∏–Ω–µ–π–Ω–æ–π —Ä–µ–≥—Ä–µ—Å—Å–∏–∏ —Å—Ç–∞—Ç–∏—Å—Ç–∏–∫–∞ $R^2$ —Å–æ–≤–ø–∞–¥–∞–µ—Ç —Å –∫–≤–∞–¥—Ä–∞—Ç–æ–º –∫–æ—ç—Ñ—Ñ–∏—Ü–∏–µ–Ω—Ç–∞ –∫–æ—Ä—Ä–µ–ª—è—Ü–∏–∏.

```{r}
cor(x, y)^2
```

### –ê–Ω–∞–ª–∏–∑ –æ—Å—Ç–∞—Ç–∫–æ–≤

–ö–∞–∫ –ø—Ä–∞–≤–∏–ª–æ, –±–æ–ª—å—à–∏–Ω—Å—Ç–≤–æ —Ç–æ—á–µ–∫ –Ω–µ –º–æ–∂–µ—Ç –ª–µ–∂–∞—Ç—å –Ω–∞ –ª–∏–Ω–∏–∏, –Ω–æ –ª–∏–Ω–∏—è –ø–æ–¥–≥–æ–Ω—è–µ—Ç—Å—è —Ç–∞–∫, —á—Ç–æ–±—ã –±—ã—Ç—å –∫–∞–∫ –º–æ–∂–Ω–æ –±–ª–∏–∂–µ –∫–æ –≤—Å–µ–º —Ç–æ—á–∫–∞–º. –ò–Ω—ã–º–∏ —Å–ª–æ–≤–∞–º–∏, —Ä–∞—Å—Å—Ç–æ—è–Ω–∏—è –æ—Ç –∫–∞–∂–¥–æ–≥–æ –Ω–∞–±–ª—é–¥–µ–Ω–∏—è –¥–æ –ª–∏–Ω–∏–∏ —Ä–µ–≥—Ä–µ—Å—Å–∏–∏ (—Ç–∞–∫ –Ω–∞–∑—ã–≤–∞–µ–º—ã–µ _–Ω–µ–≤—è–∑–∫–∏_) –¥–æ–ª–∂–Ω—ã –±—ã—Ç—å –º–∏–Ω–∏–º–∞–ª—å–Ω—ã. 

–ù–µ–≤—è–∑–∫–∞ -- —ç—Ç–æ —Ä–∞–∑–Ω–∏—Ü–∞ –º–µ–∂–¥—É –ø—Ä–æ–≥–Ω–æ–∑–∏—Ä—É–µ–º—ã–º –∏ —Ñ–∞–∫—Ç–∏—á–µ—Å–∫–∏–º –∑–Ω–∞—á–µ–Ω–∏—è–º–∏ –æ—Ç–∫–ª–∏–∫–∞: $(y_i- \hat y)$. –ù–∞ –≥—Ä–∞—Ñ–∏–∫–µ –Ω–∏–∂–µ –Ω–µ–≤—è–∑–∫–∏ –æ–±–æ–∑–Ω–∞—á–µ–Ω—ã –ø—É–Ω–∫—Ç–∏—Ä–æ–º. 

```{r}
OxfordPots |> 
  ggplot(aes(OxfordDst, OxfordPct)) +
  geom_smooth(method = "lm", color = cols[2], se = FALSE) +
  geom_point(color = cols[3], 
              size = 3, 
              alpha = 0.6
              ) +
  geom_segment(aes(xend = OxfordDst,
                   yend = predict(fit)), 
               linetype = 2, 
               color = cols[1]) +
  theme_minimal() 
```

<details>
<summary>–ü–µ—Ä–µ–ø—Ä–æ–≤–µ—Ä–∏–º.</summary>

–ú—ã –º–æ–∂–µ–º —É–±–µ–¥–∏—Ç—å—Å—è –≤ —Ç–æ–º, —á—Ç–æ –Ω–µ–≤—è–∑–∫–∏ (`fit$residuals`) –ø—Ä–µ–¥—Å—Ç–∞–≤–ª—è—é—Ç —Å–æ–±–æ–π —Ä–∞–∑–Ω–∏—Ü—É –º–µ–∂–¥—É —Ñ–∞–∫—Ç–∏—á–µ—Å–∫–∏–º (`OxfordPots$OxfordPct`) –∏ –ø—Ä–µ–¥—Å–∫–∞–∑–∞–Ω–Ω—ã–º –∑–Ω–∞—á–µ–Ω–∏–µ–º (`fit$fitted.value`). –î–ª—è —ç—Ç–æ–≥–æ —Å–ª–æ–∂–∏–º –ø—Ä–µ–¥—Å–∫–∞–∑–∞–Ω–Ω—ã–µ –∑–Ω–∞—á–µ–Ω–∏—è —Å –æ—Å—Ç–∞—Ç–∫–∞–º–∏ –∏ —Å—Ä–∞–≤–Ω–∏–º —Å —Ñ–∞–∫—Ç–∏—á–µ—Å–∫–∏–º–∏ –∑–Ω–∞—á–µ–Ω–∏—è–º–∏. 

```{r}
all.equal(unname(fit$fitted.values + fit$residuals), OxfordPots$OxfordPct)
```

</details>

–ï—Å–ª–∏ –º–æ–¥–µ–ª—å –ø–æ–¥–æ–≥–Ω–∞–Ω–∞ –≤–µ—Ä–Ω–æ, —Ç–æ –Ω–µ–≤—è–∑–∫–∏ –¥–æ–ª–∂–Ω—ã –∏–º–µ—Ç—å —Å—Ä–µ–¥–Ω–µ–µ –≤ —Ä–∞–π–æ–Ω–µ –Ω—É–ª—è –∏ –Ω–µ –∫–æ—Ä—Ä–µ–ª–∏—Ä–æ–≤–∞—Ç—å —Å –ø—Ä–µ–¥–∏–∫—Ç–æ—Ä–æ–º. –ü—Ä–æ–≤–µ—Ä–∏–º.

```{r}
mean(fit$residuals) |> 
  round(2)
cov(fit$residuals, OxfordPots$OxfordDst) |> 
  round(2)
```

–ö—Ä–æ–º–µ —Ç–æ–≥–æ, –ø–æ–ª–µ–∑–Ω–æ –ø—Ä–æ–≤–µ—Ä–∏—Ç—å –æ—Å—Ç–∞—Ç–∫–∏ –Ω–∞ –Ω–æ—Ä–º–∞–ª—å–Ω–æ—Å—Ç—å –∏ –≥–æ–º–æ—Å–∫–µ–¥–∞—Å—Ç–∏—á–Ω–æ—Å—Ç—å (—Ä–∞–≤–Ω–æ–º–µ—Ä–Ω–æ—Å—Ç—å –¥–∏—Å–ø–µ—Ä—Å–∏–∏ –æ—Å—Ç–∞—Ç–∫–æ–≤). –≠—Ç–æ –º–æ–∂–Ω–æ —Å–¥–µ–ª–∞—Ç—å –ø—Ä–∏ –ø–æ–º–æ—â–∏ —Å–ø–µ—Ü–∏–∞–ª—å–Ω–æ–≥–æ —Ç–µ—Å—Ç–∞ –∏–ª–∏ –≤–∏–∑—É–∞–ª—å–Ω–æ. 

```{r}
shapiro.test(residuals(fit))
``` 

–í—ã—Å–æ–∫–æ–µ –∑–Ω–∞—á–µ–Ω–∏–µ p-value, –∫–æ—Ç–æ—Ä–æ–µ –≤–æ–∑–≤—Ä–∞—â–∞–µ—Ç —Ç–µ–∫—Å—Ç –®–∞–ø–∏—Ä–æ-–£–∏–ª–∫–∞, –≥–æ–≤–æ—Ä–∏—Ç –æ —Ç–æ–º, —á—Ç–æ –æ—Å—Ç–∞—Ç–∫–∏ —Ä–∞—Å–ø—Ä–µ–¥–µ–ª–µ–Ω—ã –Ω–æ—Ä–º–∞–ª—å–Ω–æ. 

–¢–∞–∫–∂–µ –ø—Ä–æ–≤–µ–¥–µ–º –≤–∏–∑—É–∞–ª—å–Ω—ã–µ —Ç–µ—Å—Ç—ã. 


```{r}
#| fig-width: 9
#| fig-height: 9

check_model(fit)
```


:::{.callout-warning icon=false}
–£—Å—Ç–∞–Ω–æ–≤–∏—Ç–µ –∫—É—Ä—Å `swirl::install_course("Regression_Models")`, –∑–∞–ø—É—Å—Ç–∏—Ç–µ `swirl()` –∏ –ø—Ä–æ–π–¥–∏—Ç–µ —É—Ä–æ–∫–∏ ‚Ññ1 "Introduction", ‚Ññ2 "Residuals", ‚Ññ3 "Least Squares Estimation", ‚Ññ4 "Residual Variation". 
:::


## –°—Ä–∞–≤–Ω–µ–Ω–∏–µ –º–æ–¥–µ–ª–µ–π

### –ù—É–ª–µ–≤–∞—è –º–æ–¥–µ–ª—å

–í–∞–∂–Ω–æ –∑–Ω–∞—Ç—å, —á—Ç–æ —Å–ª–µ–¥—É—é—â–∏–µ –¥–≤–∞ –≤—ã–∑–æ–≤–∞ –≤–æ–∑–≤—Ä–∞—â–∞—é—Ç –æ–¥–∏–Ω–∞–∫–æ–≤—ã–µ –º–æ–¥–µ–ª–∏.

```{r}
fit1 <- lm(OxfordPct ~ OxfordDst, data = OxfordPots)
fit2 <- lm(OxfordPct ~ 1 + OxfordDst, data = OxfordPots)
```

```{r}
fit1$coef == fit2$coef
```
–ï–¥–∏–Ω–∏—Ü–∞ –≤ –≤—ã–∑–æ–≤–µ —Ñ—É–Ω–∫—Ü–∏–∏ –æ–∑–Ω–∞—á–∞–µ—Ç –ø–µ—Ä–µ—Å–µ—á–µ–Ω–∏–µ –æ—Å–∏ y, —Ç–æ –µ—Å—Ç—å —Å–≤–æ–±–æ–¥–Ω—ã–π —á–ª–µ–Ω. –≠—Ç–æ –∑–Ω–∞—á–∏—Ç, —á—Ç–æ –º—ã –º–æ–∂–µ–º –ø–æ—Å—Ç—Ä–æ–∏—Ç—å –Ω—É–ª–µ–≤—É—é –º–æ–¥–µ–ª—å, –≥–¥–µ –ª—é–±–æ–º—É –∑–Ω–∞—á–µ–Ω–∏—é `x` –±—É–¥–µ—Ç —Å–æ–æ—Ç–≤–µ—Ç—Å—Ç–≤–æ–≤–∞—Ç—å –æ–¥–Ω–æ –∏ —Ç–æ –∂–µ (—Å—Ä–µ–¥–Ω–µ–µ) –∑–Ω–∞—á–µ–Ω–∏–µ `y`.

```{r}
fit_null <- lm(OxfordPct ~ 1, data = OxfordPots)
parameters(fit_null)
```

```{r echo=FALSE}
parameters(fit_null) |> 
  gt() |> 
  fmt_number(
    columns = where(is.numeric),  
    decimals = 3                  
  ) |> 
  tab_style(
    style = cell_text(weight = "bold"),  
    locations = cells_column_labels()   
  ) 
```

–ï–¥–∏–Ω—Å—Ç–≤–µ–Ω–Ω—ã–π –∫–æ—ç—Ñ—Ñ–∏—Ü–∏–µ–Ω—Ç –≤ —Ç–∞–∫–æ–º —Å–ª—É—á–∞–µ —Å–æ–≤–ø–∞–¥–∞–µ—Ç —Å–æ —Å—Ä–µ–¥–Ω–∏–º –∑–Ω–∞—á–µ–Ω–∏–µ–º `y`. 

```{r}
mean(OxfordPots$OxfordPct)
```

–ù–∞ –≥—Ä–∞—Ñ–∏–∫–µ —ç—Ç–æ –±—É–¥–µ—Ç –≤—ã–≥–ª—è–¥–µ—Ç—å –≤–æ—Ç —Ç–∞–∫.

```{r}
OxfordPots |> 
  ggplot(aes(OxfordDst, OxfordPct)) +
  # –æ–±—Ä–∞—Ç–∏—Ç–µ –≤–Ω–∏–º–∞–Ω–∏–µ –Ω–∞ —Ñ–æ—Ä–º—É–ª—É!
  geom_smooth(method = "lm", formula = y ~ 1,
              color = cols[2], se = FALSE) +
  geom_point(color = cols[3], 
              size = 3, 
              alpha = 0.6
              ) +
  theme_minimal()
```

–¢–∞–∫–∞—è –º–æ–¥–µ–ª—å –º–æ–∂–µ—Ç –±—ã—Ç—å –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∞ –¥–ª—è —Å—Ä–∞–≤–Ω–µ–Ω–∏—è, —á—Ç–æ–±—ã –ø–æ–Ω—è—Ç—å,  –Ω–∞—Å–∫–æ–ª—å–∫–æ –º—ã –≤—ã–∏–≥—Ä–∞–ª–∏, –¥–æ–±–∞–≤–∏–≤ –ø—Ä–µ–¥–∏–∫—Ç–æ—Ä—ã. 

### ANOVA

–§—É–Ω–∫—Ü–∏—è `anova()` —Å—Ä–∞–≤–Ω–∏–≤–∞–µ—Ç –¥–≤–µ –≤–ª–æ–∂–µ–Ω–Ω—ã–µ –ª–∏–Ω–µ–π–Ω—ã–µ —Ä–µ–≥—Ä–µ—Å—Å–∏–æ–Ω–Ω—ã–µ –º–æ–¥–µ–ª–∏ —Å –ø–æ–º–æ—â—å—é –∞–Ω–∞–ª–∏–∑–∞ –¥–∏—Å–ø–µ—Ä—Å–∏–∏. –¶–µ–ª—å ‚Äî –≤—ã—è—Å–Ω–∏—Ç—å, –¥–æ–±–∞–≤–ª—è–µ—Ç –ª–∏ –ø–µ—Ä–µ–º–µ–Ω–Ω–∞—è OxfordDst –∑–Ω–∞—á–∏—Ç–µ–ª—å–Ω–æ–µ —É–ª—É—á—à–µ–Ω–∏–µ –º–æ–¥–µ–ª–∏ –ø–æ —Å—Ä–∞–≤–Ω–µ–Ω–∏—é —Å –º–æ–¥–µ–ª—å—é –±–µ–∑ –ø—Ä–µ–¥–∏–∫—Ç–æ—Ä–æ–≤.

```{r}
anova(fit_null, fit)
```

```{r echo=FALSE}
anova(fit_null, fit) |> 
  export_table()
```



| –°—Ç–æ–ª–±–µ—Ü         | –ó–Ω–∞—á–µ–Ω–∏–µ                                                    |
|-----------------|-------------------------------------------------------------|
| Res.Df      | –û—Å—Ç–∞—Ç–æ—á–Ω—ã–µ —Å—Ç–µ–ø–µ–Ω–∏ —Å–≤–æ–±–æ–¥—ã: —á–∏—Å–ª–æ –Ω–∞–±–ª—é–¥–µ–Ω–∏–π –º–∏–Ω—É—Å —á–∏—Å–ª–æ –ø–∞—Ä–∞–º–µ—Ç—Ä–æ–≤ –º–æ–¥–µ–ª–∏. |
| RSS        | Residual Sum of Squares ‚Äî —Å—É–º–º–∞ –∫–≤–∞–¥—Ä–∞—Ç–æ–≤ –æ—Å—Ç–∞—Ç–∫–æ–≤. –ß–µ–º –º–µ–Ω—å—à–µ, —Ç–µ–º –ª—É—á—à–µ. |
| Df          | –†–∞–∑–Ω–∏—Ü–∞ –≤ —Å—Ç–µ–ø–µ–Ω–∏ —Å–≤–æ–±–æ–¥—ã –º–µ–∂–¥—É –º–æ–¥–µ–ª—è–º–∏ (—á–∏—Å–ª–æ –¥–æ–±–∞–≤–ª–µ–Ω–Ω—ã—Ö –ø—Ä–µ–¥–∏–∫—Ç–æ—Ä–æ–≤). |
| Sum of Sq   | –£–ª—É—á—à–µ–Ω–∏–µ, –¥–æ—Å—Ç–∏–≥–Ω—É—Ç–æ–µ –∑–∞ —Å—á—ë—Ç –¥–æ–±–∞–≤–ª–µ–Ω–Ω–æ–≥–æ –ø—Ä–µ–¥–∏–∫—Ç–æ—Ä–∞ (OxfordDst), —Ç–æ –µ—Å—Ç—å —Ä–∞–∑–Ω–∏—Ü–∞ –≤ RSS. |
| F          | F-—Å—Ç–∞—Ç–∏—Å—Ç–∏–∫–∞ –¥–ª—è –æ—Ü–µ–Ω–∫–∏ –∑–Ω–∞—á–∏–º–æ—Å—Ç–∏ —É–ª—É—á—à–µ–Ω–∏—è –º–æ–¥–µ–ª–∏.        |
| Pr(>F)      | p-–∑–Ω–∞—á–µ–Ω–∏–µ: –Ω–∞—Å–∫–æ–ª—å–∫–æ –≤–µ—Ä–æ—è—Ç–Ω–æ –Ω–∞–±–ª—é–¥–∞—Ç—å —Ç–∞–∫—É—é F-—Å—Ç–∞—Ç–∏—Å—Ç–∏–∫—É —Å–ª—É—á–∞–π–Ω–æ. |

RSS —É–º–µ–Ω—å—à–∏–ª–∞—Å—å —Å 1408.88 –¥–æ 878.44 –ø–æ—Å–ª–µ –¥–æ–±–∞–≤–ª–µ–Ω–∏—è –ø–µ—Ä–µ–º–µ–Ω–Ω–æ–π OxfordDst, –∑–Ω–∞—á–∏—Ç –º–æ–¥–µ–ª—å —É–ª—É—á—à–∏–ª–∞—Å—å. _F-—Å—Ç–∞—Ç–∏—Å—Ç–∏–∫–∞_ = 16.908, –∞ _p-value_ –∑–Ω–∞—á–∏—Ç–µ–ª—å–Ω–æ –Ω–∏–∂–µ —É—Ä–æ–≤–Ω—è –∑–Ω–∞—á–∏–º–æ—Å—Ç–∏ 0.05. –¢—Ä–∏ –∑–≤–µ–∑–¥–æ—á–∫–∏ (***) –æ–∑–Ω–∞—á–∞—é—Ç —Å—Ç–∞—Ç–∏—Å—Ç–∏—á–µ—Å–∫–∏ –∑–Ω–∞—á–∏–º—É—é —Ä–∞–∑–Ω–∏—Ü—É –º–µ–∂–¥—É –º–æ–¥–µ–ª—è–º–∏.

:::{.callout-note icon=FALSE}
F-—Å—Ç–∞—Ç–∏—Å—Ç–∏–∫–∞ ‚Äî —ç—Ç–æ —Å—Ç–∞—Ç–∏—Å—Ç–∏–∫–∞, –∫–æ—Ç–æ—Ä–∞—è –∏—Å–ø–æ–ª—å–∑—É–µ—Ç—Å—è –¥–ª—è –æ—Ü–µ–Ω–∫–∏ –∫–∞—á–µ—Å—Ç–≤–∞ –º–æ–¥–µ–ª–∏ –≤ –∞–Ω–∞–ª–∏–∑–µ –¥–∏—Å–ø–µ—Ä—Å–∏–∏ (ANOVA) –∏ –≤ —Ä–µ–≥—Ä–µ—Å—Å–∏–æ–Ω–Ω–æ–º –∞–Ω–∞–ª–∏–∑–µ. –û–Ω–∞ –ø–æ–∫–∞–∑—ã–≤–∞–µ—Ç, –Ω–∞—Å–∫–æ–ª—å–∫–æ —Ö–æ—Ä–æ—à–æ –º–æ–¥–µ–ª—å —Å –ø—Ä–µ–¥–∏–∫—Ç–æ—Ä–∞–º–∏ –æ–±—ä—è—Å–Ω—è–µ—Ç –¥–∞–Ω–Ω—ã–µ –ø–æ —Å—Ä–∞–≤–Ω–µ–Ω–∏—é —Å –º–æ–¥–µ–ª—å—é –±–µ–∑ –ø—Ä–µ–¥–∏–∫—Ç–æ—Ä–æ–≤ (–∏–ª–∏ —Å –º–µ–Ω—å—à–∏–º –∏—Ö —á–∏—Å–ª–æ–º). –ß–µ–º –±–æ–ª—å—à–µ –∑–Ω–∞—á–µ–Ω–∏–µ F, —Ç–µ–º —Å–∏–ª—å–Ω–µ–µ —É–ª—É—á—à–µ–Ω–∏–µ –º–æ–¥–µ–ª–∏ –ø—Ä–∏ –¥–æ–±–∞–≤–ª–µ–Ω–∏–∏ –ø–µ—Ä–µ–º–µ–Ω–Ω—ã—Ö. –ï—Å–ª–∏ –ø–æ–ª—É—á–∏—Ç—å —Ç–∞–∫—É—é –±–æ–ª—å—à—É—é F –ø—Ä–∏ —Å–ª—É—á–∞–π–Ω—ã—Ö –¥–∞–Ω–Ω—ã—Ö –º–∞–ª–æ–≤–µ—Ä–æ—è—Ç–Ω–æ (—á—Ç–æ –æ—Ç—Ä–∞–∂–∞–µ—Ç –º–∞–ª–æ–µ p-–∑–Ω–∞—á–µ–Ω–∏–µ), —Ç–æ –º—ã –¥–µ–ª–∞–µ–º –≤—ã–≤–æ–¥, —á—Ç–æ –ø–µ—Ä–µ–º–µ–Ω–Ω–∞—è –∑–Ω–∞—á–∏–º–æ —É–ª—É—á—à–∞–µ—Ç –º–æ–¥–µ–ª—å.
:::


### –°—Ä–∞–≤–Ω–µ–Ω–∏–µ —Å `{easystats}`

–î–ª—è —Å—Ä–∞–≤–Ω–µ–Ω–∏—è –º–æ–¥–µ–ª–µ–π –ø–æ–ª–µ–∑–Ω—ã —Å–ª–µ–¥—É—é—â–∏–µ —Ñ—É–Ω–∫—Ü–∏–∏:

```{r}
compare_performance(fit_null, fit, rank = TRUE)
```

```{r echo=FALSE}
compare_performance(fit_null, fit, rank = TRUE) |> 
  export_table()
```


```{r}
compare_performance(fit_null, fit) |> 
  plot()
```

```{r}
library(report)
compare_performance(fit_null, fit) |> 
  report()
```

## –ü—Ä–µ–¥—Å–∫–∞–∑–∞–Ω–∏—è —Å `predict()`

–ü—Ä–µ–¥—Å–∫–∞–∑–∞–Ω–Ω—ã–µ –∑–Ω–∞—á–µ–Ω–∏—è –º–æ–∂–Ω–æ –∏–∑–≤–ª–µ—á—å –ø—Ä–∏ –ø–æ–º–æ—â–∏ `predict()`. –≠—Ç–æ –ø–æ—á—Ç–∏ —Ç–æ –∂–µ —Å–∞–º–æ–µ, —á—Ç–æ `fit$fitted.values`. –†–∞–∑–Ω–∏—Ü–∞ –≤ —Ç–æ–º, —á—Ç–æ —Ñ—É–Ω–∫—Ü–∏–∏ `predict()` –º–æ–∂–Ω–æ –ø–µ—Ä–µ–¥–∞—Ç—å –Ω–æ–≤—ã–µ –¥–∞–Ω–Ω—ã–µ. –£–∑–Ω–∞–µ–º, –∫–∞–∫—É—é –¥–æ–ª—é –æ–∫—Å—Ñ–æ—Ä–¥—Å–∫–æ–π –∫–µ—Ä–∞–º–∏–∫–∏ –Ω–∞—à–∞ –º–æ–¥–µ–ª—å –æ–∂–∏–¥–∞–µ—Ç –æ–±–Ω–∞—Ä—É–∂–∏—Ç—å –Ω–∞ —Ä–∞—Å—Å—Ç–æ—è–Ω–∏–∏ —Ä–æ–≤–Ω–æ 100 –º–∏–ª—å –æ—Ç –û–∫—Å—Ñ–æ—Ä–¥–∞.

```{r}
newdata <- data.frame(OxfordDst = 100)
predict(fit, newdata)
```

–ü–æ–¥ –∫–∞–ø–æ—Ç–æ–º —Ñ—É–Ω–∫—Ü–∏—è `predict()` –ø–æ–¥—Å—Ç–∞–≤–ª—è–µ—Ç –ø–æ–¥–æ–≥–Ω–∞–Ω–Ω—ã–µ –∑–Ω–∞—á–µ–Ω–∏—è –∫–æ—ç—Ñ—Ñ–∏—Ü–∏–µ–Ω—Ç–æ–≤:

```{r}
fit$coefficients[[1]] + fit$coefficients[[2]] * 100
```


## –ú–Ω–æ–∂–µ—Å—Ç–≤–µ–Ω–Ω–∞—è —Ä–µ–≥—Ä–µ—Å—Å–∏—è

–ú–Ω–æ–∂–µ—Å—Ç–≤–µ–Ω–Ω–∞—è —Ä–µ–≥—Ä–µ—Å—Å–∏—è –ø–æ–¥—Ö–æ–¥–∏—Ç –¥–ª—è —Ç–µ—Ö —Å–ª—É—á–∞–µ–≤, –≥–¥–µ –Ω–∞ –ø–µ—Ä–µ–º–µ–Ω–Ω—É—é –æ—Ç–∫–ª–∏–∫–∞ –º–æ–≥—É—Ç –≤–ª–∏—è—Ç—å –Ω–µ—Å–∫–æ–ª—å–∫–æ –ø—Ä–µ–¥–∏–∫—Ç–æ—Ä–æ–≤. –î–æ–ø—É—Å—Ç–∏–º, —á—Ç–æ –≤ —Å–ª—É—á–∞–µ —Å –¥–æ–ª–µ–π –æ–∫—Å—Ñ–æ—Ä–¥—Å–∫–æ–π –∫–µ—Ä–∞–º–∏–∫–∏ —ç—Ç–æ –Ω–µ —Ç–æ–ª—å–∫–æ —Ä–∞—Å—Å—Ç–æ—è–Ω–∏–µ –æ—Ç –û–∫—Å—Ñ–æ—Ä–¥–∞, –Ω–æ –∏ –±–ª–∏–∑–æ—Å—Ç—å –∫—Ä—É–ø–Ω—ã—Ö –≥–æ—Ä–æ–¥—Å–∫–∏—Ö —Ü–µ–Ω—Ç—Ä–æ–≤, –≤–æ–∫—Ä—É–≥ –∫–æ—Ç–æ—Ä—ã—Ö –≤—ã—Å—Ç—Ä–∞–∏–≤–∞–ª–∏—Å—å —Ç–æ—Ä–≥–æ–≤—ã–µ –≤–∑–∞–∏–º–æ–¥–µ–π—Å—Ç–≤–∏—è.

–í –æ–±—â–µ–º –≤–∏–¥–µ –º–Ω–æ–∂–µ—Å—Ç–≤–µ–Ω–Ω–∞—è —Ä–µ–≥—Ä–µ—Å—Å–∏–æ–Ω–Ω–∞—è –º–æ–¥–µ–ª—å –∏–º–µ–µ—Ç —Ñ–æ—Ä–º—É:

$$y = \beta_0 + \beta_1x_1 + \beta_2x_2+ ... \beta_px_p + \epsilon$$

### –ú–æ–¥–µ–ª—å —Å –¥–≤—É–º—è –ø—Ä–µ–¥–∏–∫—Ç–æ—Ä–∞–º–∏

–ü–æ–¥–≥–æ–Ω–∏–º –≤—Ç–æ—Ä—É—é –º–æ–¥–µ–ª—å –∏ –ø–æ—Å–º–æ—Ç—Ä–∏–º, –¥–∞–µ—Ç –ª–∏ –Ω–∞–º —á—Ç–æ-—Ç–æ –¥–æ–±–∞–≤–ª–µ–Ω–∏–µ –≤—Ç–æ—Ä–æ–≥–æ –ø—Ä–µ–¥–∏–∫—Ç–æ—Ä–∞.

```{r}
fit2 <- lm(OxfordPct ~ OxfordDst + WalledArea, data = OxfordPots)
```

```{r echo=FALSE}
# –¥–ª—è —Å—Ä–∞–≤–Ω–µ–Ω–∏—è
performance(fit) |> 
  gt() |> 
  fmt_number(
    columns = where(is.numeric),  
    decimals = 3                  
  ) |> 
  tab_header(
    title = md("*Model with 1 Predictor*")  
  ) |> 
  tab_style(
    style = cell_text(weight = "bold"),  
    locations = cells_column_labels()   
  ) |> 
  tab_style(
    style = list(
      cell_fill(color = cols[1]),
      cell_text(weight = "bold")),
    locations = cells_body(columns = c(R2, Sigma))
    )
```
```{r echo=FALSE}
performance(fit2) |> 
  gt() |> 
  fmt_number(
    columns = where(is.numeric),  
    decimals = 3                  
  ) |> 
  tab_style(
    style = cell_text(weight = "bold"),  
    locations = cells_column_labels()   
  ) |> 
  tab_style(
    style = list(
      cell_fill(color = cols[1]),
      cell_text(weight = "bold")
    ),
    locations = cells_body(columns = c(R2, Sigma))
    ) |> 
  tab_header(
    title = md("*Model with 2 Predictors*")  # üëà Bold title using markdown
  ) 
```
–ù–∞ –ø–µ—Ä–≤—ã–π –≤–∑–≥–ª—è–¥, –≤—Å–µ —Ö–æ—Ä–æ—à–æ: RSE —É–º–µ–Ω—å—à–∏–ª–∞—Å—å, –∞ –¥–æ–ª—è –æ–±—ä—è—Å–Ω–µ–Ω–Ω–æ–π –¥–∏—Å–ø–µ—Ä—Å–∏–∏ —É–≤–µ–ª–∏—á–∏–ª–∞—Å—å. 

```{r message=FALSE}
compare_performance(fit_null, fit, fit2) |> 
  plot()
```


–û–¥–Ω–∞–∫–æ p-value –¥–ª—è –≤—Ç–æ—Ä–æ–≥–æ –ø—Ä–µ–¥–∏–∫—Ç–æ—Ä–∞ (0.69) —É–∫–∞–∑—ã–≤–∞–µ—Ç –Ω–∞ —Ç–æ, —á—Ç–æ –æ–Ω –Ω–µ —è–≤–ª—è–µ—Ç—Å—è —Å—Ç–∞—Ç–∏—Å—Ç–∏—á–µ—Å–∫–∏ –∑–Ω–∞—á–∏–º—ã–º. 

```{r}
parameters(fit2)
```

```{r echo=FALSE}
parameters(fit2) |> 
  gt() |> 
  fmt_number(
    columns = where(is.numeric),  
    decimals = 3    
  ) |> 
  tab_style(
    style = list(
      cell_fill(color = cols[1]),
      cell_text(weight = "bold")
    ),
    locations = cells_body(columns = c(p))
    )
```

–≠—Ç–æ –º–æ–∂–µ—Ç –æ–∑–Ω–∞—á–∞—Ç—å, —á—Ç–æ —Å–≤—è–∑–∏ –º–µ–∂–¥—É –ø–ª–æ—â–∞–¥—å—é –æ–±–Ω–µ—Å–µ–Ω–Ω–æ–≥–æ —Å—Ç–µ–Ω–æ–π –≥–æ—Ä–æ–¥–∞ –∏ —á–∏—Å–ª–æ–º –æ–∫—Å—Ñ–æ—Ä–¥—Å–∫–∏—Ö –≥–æ—Ä—à–∫–æ–≤ –Ω–∞ —Å–∞–º–æ–º –¥–µ–ª–µ –Ω–µ—Ç.

:::{.callout-info icon=false}
–ö—Å—Ç–∞—Ç–∏, –∫ –ø–æ—Ö–æ–∂–µ–º—É –≤—ã–≤–æ–¥—É –ø—Ä–∏—à–µ–ª –∏ –Ø–Ω –•–æ–¥–¥–µ—Ä –≤ —É–ø–æ–º—è–Ω—É—Ç—ã—Ö –∏—Å—Å–ª–µ–¥–æ–≤–∞–Ω–∏—è—Ö: —Ç–æ—Ä–≥–æ–≤–ª—è –≥—Ä—É–±–æ–π –∫–µ—Ä–∞–º–∏–∫–æ–π, –¥–∞–Ω–Ω—ã–µ –æ –∫–æ—Ç–æ—Ä–æ–π —Å–æ–¥–µ—Ä–∂–∏—Ç –Ω–∞—à –¥–∞—Ç–∞—Å–µ—Ç, –º–µ–Ω—å—à–µ –∑–∞–≤–∏—Å–∏—Ç –æ—Ç –≥–æ—Ä–æ–¥–æ–≤, —á–µ–º —Ç–æ—Ä–≥–æ–≤–ª—è –±–æ–ª–µ–µ –∏–∑—ã—Å–∫–∞–Ω–Ω—ã–º–∏ —Ç–æ–≤–∞—Ä–∞–º–∏. –û–¥–Ω–∏–º —Å–ª–æ–≤–æ–º, –≥–æ—Ä—à–∫–∏ –≤–µ–∑–¥–µ –Ω—É–∂–Ω—ã, –∏ –≤ –≥–æ—Ä–æ–¥–µ, –∏ –≤ –¥–µ—Ä–µ–≤–Ω–µ.
:::

–ü–æ—á–µ–º—É –∂–µ –º—ã –≤–∏–¥–∏–º —É–≤–µ–ª–∏—á–µ–Ω–∏–µ $R^2$? –î–µ–ª–æ –≤ —Ç–æ–º, —á—Ç–æ —ç—Ç–æ—Ç –ø–æ–∫–∞–∑–∞—Ç–µ–ª—å _–≤—Å–µ–≥–¥–∞ –≤–æ–∑—Ä–∞—Å—Ç–∞–µ—Ç_ –ø—Ä–∏ –¥–æ–±–∞–≤–ª–µ–Ω–∏–∏ –≤ –º–æ–¥–µ–ª—å –¥–æ–ø–æ–ª–Ω–∏—Ç–µ–ª—å–Ω—ã—Ö –ø–µ—Ä–µ–º–µ–Ω–Ω—ã—Ö, –¥–∞–∂–µ –µ—Å–ª–∏ —ç—Ç–∏ –ø–µ—Ä–µ–º–µ–Ω–Ω—ã–µ –æ—á–µ–Ω—å —Å–ª–∞–±–æ —Å–≤—è–∑–∞–Ω—ã —Å –æ—Ç–∫–ª–∏–∫–æ–º. –ü–æ—ç—Ç–æ–º—É –≤–∞–∂–Ω–µ–π—à–∞—è –∑–∞–¥–∞—á–∞ –ø—Ä–∏ –æ–±—É—á–µ–Ω–∏–∏ –º–æ–¥–µ–ª–∏ —Å–≤—è–∑–∞–Ω–∞ —Å –æ—Ç–±–æ—Ä–æ–º –∏–Ω—Ñ–æ—Ä–º–∞—Ç–∏–≤–Ω—ã—Ö –ø–µ—Ä–µ–º–µ–Ω–Ω—ã—Ö. –í –ø—Ä–æ—Ç–∏–≤–Ω–æ–º —Å–ª—É—á–∞–µ –≤–µ–ª–∏–∫ —Ä–∏—Å–∫ _–ø–µ—Ä–µ–æ–±—É—á–∏—Ç—å_ –º–æ–¥–µ–ª—å.  

### –ú–Ω–∏–º—ã–µ –ø–µ—Ä–µ–º–µ–Ω–Ω—ã–µ

–î–ª—è –ø–æ—Å—Ç—Ä–æ–µ–Ω–∏—è –º–æ–¥–µ–ª–∏ –º–æ–∂–Ω–æ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å –Ω–µ —Ç–æ–ª—å–∫–æ –∫–æ–ª–∏—á–µ—Å—Ç–≤–µ–Ω–Ω—ã–µ, –Ω–æ –∏ –∫–∞—á–µ—Å—Ç–≤–µ–Ω–Ω—ã–µ –ø—Ä–µ–¥–∏–∫—Ç–æ—Ä—ã. –ï—Å–ª–∏ –∫–∞—á–µ—Å—Ç–≤–µ–Ω–Ω—ã–π –ø—Ä–µ–¥–∏–∫—Ç–æ—Ä –∏–º–µ–µ—Ç —Ç–æ–ª—å–∫–æ –¥–≤–∞ —É—Ä–æ–≤–Ω—è (–Ω–∞–ø—Ä–∏–º–µ—Ä, –º—É–∂—Å–∫–æ–π –∏ –∂–µ–Ω—Å–∫–∏–π –ø–æ–ª), —Ç–æ –æ–Ω –ø—Ä–µ–≤—Ä–∞—â–∞–µ—Ç—Å—è –≤ —Ñ–∏–∫—Ç–∏–≤–Ω—É—é –ø–µ—Ä–µ–º–µ–Ω–Ω—É—é, –ø—Ä–∏–Ω–∏–º–∞—é—â—É—é –∑–Ω–∞—á–µ–Ω–∏—è 1 –∏–ª–∏ 0. –í –Ω–∞—à–µ–º –¥–∞—Ç–∞—Å–µ—Ç–µ –≤ —Ç–∞–∫–æ–º –≤–∏–¥–µ —Ö—Ä–∞–Ω—è—Ç—Å—è —Å–≤–µ–¥–µ–Ω–∏—è –æ –Ω–∞–ª–∏—á–∏–∏ –≤–æ–¥–Ω–æ–≥–æ —Å–æ–æ–±—â–µ–Ω–∏—è –º–µ–∂–¥—É –û–∫—Å—Ñ–æ—Ä–¥–æ–º –∏ –º–µ—Å—Ç–æ–º –æ–±–Ω–∞—Ä—É–∂–µ–Ω–∏—è –∫–µ—Ä–∞–º–∏—á–µ—Å–∫–∏—Ö –æ—Å–∫–æ–ª–∫–æ–≤. 

```{r}
fit3 <- lm(OxfordPct ~ OxfordDst + WaterTrans, data = OxfordPots)
parameters(fit3)
```

```{r echo=FALSE}
parameters(fit3) |> 
  gt() |> 
  fmt_number(
    columns = where(is.numeric),  
    decimals = 3    
  ) |> 
  tab_style(
    style = list(
      cell_fill(color = cols[1]),
      cell_text(weight = "bold")
    ),
    locations = cells_body(columns = c(Coefficient))
    )
```

–û–±—Ä–∞—Ç–∏—Ç–µ –≤–Ω–∏–º–∞–Ω–∏–µ, —á—Ç–æ —É–≥–ª–æ–≤–æ–π –∫–æ—ç—Ñ—Ñ–∏—Ü–∏–µ–Ω—Ç –¥–ª—è WaterTrans –ø—Ä–µ–¥—Å—Ç–∞–≤–ª—è–µ—Ç —Å–æ–±–æ–π –ø–æ–ª–æ–∂–∏—Ç–µ–ª—å–Ω–æ–µ —á–∏—Å–ª–æ: –µ—Å–ª–∏ –≤–æ–¥–Ω—ã–π –ø—É—Ç—å –µ—Å—Ç—å, –ª–∏–Ω–∏—è —Ä–µ–≥—Ä–µ—Å—Å–∏–∏ –Ω–µ —Ç–∞–∫ —Ä–µ–∑–∫–æ —É—Ö–æ–¥–∏—Ç –≤–Ω–∏–∑ –ø–æ –º–µ—Ä–µ —É–¥–∞–ª–µ–Ω–∏—è –æ—Ç –û–∫—Å—Ñ–æ—Ä–¥–∞. 

–û—á–µ–≤–∏–¥–Ω–æ, —á—Ç–æ –Ω–∞–ª–∏—á–∏–µ –≤–æ–¥–Ω–æ–≥–æ –ø—É—Ç–∏ -- –≤–∞–∂–Ω—ã–π –ø—Ä–µ–¥–∏–∫—Ç–æ—Ä, —á—Ç–æ –º–æ–∂–Ω–æ –ø–æ–¥—Ç–≤–µ—Ä–¥–∏—Ç—å –≥—Ä–∞—Ñ–∏—á–µ—Å–∫–∏. 

```{r message=FALSE}
library(paletteer)
cols <- paletteer_d("ggthemes::wsj_rgby")

OxfordPots |> 
  ggplot(aes(OxfordDst, OxfordPct, 
             color = as.factor(WaterTrans), 
             group = as.factor(WaterTrans))) +
  geom_point() +
  geom_smooth(method = "lm") +
  scale_color_manual("WaterTrans", values = cols[4:3]) +
  theme_minimal()
```



–°—Ä–∞–≤–Ω–∏–º —ç—Ñ—Ñ–µ–∫—Ç–∏–≤–Ω–æ—Å—Ç—å –º–æ–¥–µ–ª–µ–π –ø—Ä–∏ –ø–æ–º–æ—â–∏ —Ñ—É–Ω–∫—Ü–∏–∏ `compare_performance()`. –î–æ–±–∞–≤–∏–º –∏ –≤—Ç–æ—Ä—É—é –º–æ–¥–µ–ª—å —Ç–æ–∂–µ, —Ö–æ—Ç—è –º—ã –ø–æ–º–Ω–∏–º, —á—Ç–æ –æ–Ω–∞ —Å–æ–¥–µ—Ä–∂–∏—Ç —Å—Ç–∞—Ç–∏—Å—Ç–∏—á–µ—Å–∫–∏ –Ω–µ–∑–Ω–∞—á–∏–º—ã–π –ø—Ä–µ–¥–∏–∫—Ç–æ—Ä.


```{r echo=FALSE, message=FALSE}
compare_performance(fit_null, fit, fit2, fit3, rank = TRUE) |> 
  gt() |> 
  fmt_number(
    columns = where(is.numeric),  
    decimals = 2
  ) |> 
  tab_style(
    style = list(
      cell_fill(color = cols[1]),
      cell_text(weight = "bold")
    ),
    locations = cells_body(columns = c(R2, Sigma))
    )
```
```{r message=FALSE}
compare_performance(fit_null, fit, fit2, fit3) |> 
  plot()
```

## –ß—Ç–æ –æ—Å—Ç–∞–ª–æ—Å—å –∑–∞ –∫–∞–¥—Ä–æ–º

–í —ç—Ç–æ–º —É—Ä–æ–∫–µ –º—ã –Ω–µ —Ä–∞—Å—Å–º–æ—Ç—Ä–µ–ª–∏ –º–Ω–æ–∂–µ—Å—Ç–≤–æ –∞—Å–ø–µ–∫—Ç–æ–≤ —Ä–µ–≥—Ä–µ—Å—Å–∏–æ–Ω–Ω–æ–≥–æ –∞–Ω–∞–ª–∏–∑–∞: –Ω–µ–æ–±—Ö–æ–¥–∏–º–æ—Å—Ç—å —Ç—Ä–∞–Ω—Å—Ñ–æ—Ä–º–∞—Ü–∏–∏ –¥–∞–Ω–Ω—ã—Ö, —É—á–µ—Ç —ç—Ñ—Ñ–µ–∫—Ç–æ–≤ –≤–∑–∞–∏–º–æ–¥–µ–π—Å—Ç–≤–∏—è –ø–µ—Ä–µ–º–µ–Ω–Ω—ã—Ö, –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ –ø–æ–ª–∏–Ω–æ–º–∏–∞–ª—å–Ω—ã—Ö –º–æ–¥–µ–ª–µ–π –∏ –¥—Ä.  



:::{.callout-warning icon=false}
–£—Å—Ç–∞–Ω–æ–≤–∏—Ç–µ –∫—É—Ä—Å `swirl::install_course("Regression_Models")`, –∑–∞–ø—É—Å—Ç–∏—Ç–µ `swirl()` –∏ –ø—Ä–æ–π–¥–∏—Ç–µ —É—Ä–æ–∫–∏ ‚Ññ5 "Introduction to Multivariable Regression", ‚Ññ2 "MultiVar Examples", ‚Ññ3 "MultiVar Examples2", ‚Ññ4 "MultiVar Examples3", "Residuals Diagnostics and Variation", "Variance Inflation Factors", "Overfitting and Underfitting", "Binary Outcomes", "Count Outcomes"
:::

