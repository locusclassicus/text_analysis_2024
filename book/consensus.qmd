# –ö–æ–Ω—Å–µ–Ω—Å—É—Å–Ω—ã–µ –¥–µ—Ä–µ–≤—å—è –∏ —Å–µ—Ç–∏

–í –ø—Ä–µ–¥—ã–¥—É—â–∏—Ö —É—Ä–æ–∫–∞—Ö –º—ã –≥–æ–≤–æ—Ä–∏–ª–∏ –æ–± –∏–µ—Ä–∞—Ä—Ö–∏—á–µ—Å–∫–æ–π –∫–ª–∞—Å—Ç–µ—Ä–∏–∑–∞—Ü–∏–∏ –∏ –æ –¥–µ–Ω–¥—Ä–æ–≥—Ä–∞–º–º–µ –∫–∞–∫ –Ω–∞–∏–±–æ–ª–µ–µ –µ—Å—Ç–µ—Å—Ç–≤–µ–Ω–Ω–æ–º —Å–ø–æ—Å–æ–±–µ –ø—Ä–µ–¥—Å—Ç–∞–≤–ª–µ–Ω–∏—è —Ç–∞–∫–∏—Ö –∫–ª–∞—Å—Ç–µ—Ä–æ–≤. –û–¥–Ω–∞–∫–æ –≤–∞–∂–Ω–æ –ø–æ–º–Ω–∏—Ç—å, —á—Ç–æ —Ä–µ–∑—É–ª—å—Ç–∞—Ç –∫–ª–∞—Å—Ç–µ—Ä–∏–∑–∞—Ü–∏–∏ –∑–∞–≤–∏—Å–∏—Ç [–æ—Ç –Ω–µ—Å–∫–æ–ª—å–∫–∏—Ö –ø–∞—Ä–∞–º–µ—Ç—Ä–æ–≤](https://academic.oup.com/dsh/article/32/1/50/2957386):

- —á–∏—Å–ª–æ –ø—Ä–µ–¥–∏–∫—Ç–æ—Ä–æ–≤ (–Ω–∞–ø—Ä–∏–º–µ—Ä, –Ω–∞–∏–±–æ–ª–µ–µ —á–∞—Å—Ç–æ—Ç–Ω—ã—Ö —Å–ª–æ–≤ –¥–ª—è —Ä–∞–∑–Ω—ã—Ö –ø—Ä–æ–∏–∑–≤–µ–¥–µ–Ω–∏–π);
- —Ä–∞—Å—Å—Ç–æ—è–Ω–∏–µ, –∫–æ—Ç–æ—Ä–æ–µ –∏—Å–ø–æ–ª—å–∑—É–µ—Ç—Å—è –¥–ª—è –ø–æ–ø–∞—Ä–Ω—ã—Ö —Å—Ä–∞–≤–Ω–µ–Ω–∏–π (–µ–≤–∫–ª–∏–¥–æ–≤–æ, –∫–æ—Å–∏–Ω—É—Å–Ω–æ–µ, –¥—Ä.)
- –º–µ—Ç–æ–¥ —Å–≤—è–∑–∏ (–º–µ—Ç–æ–¥ –ø–æ–ª–Ω–æ–π —Å–≤—è–∑–∏, –º–µ—Ç–æ–¥ —Å—Ä–µ–¥–Ω–µ–π —Å–≤—è–∑–∏, –º–µ—Ç–æ–¥ –£–æ—Ä–¥–∞ –∏ –¥—Ä.);

–ò–Ω–æ–≥–¥–∞ –¥–æ–±–∞–≤–ª–µ–Ω–∏–µ –∏–ª–∏ —É–¥–∞–ª–µ–Ω–∏–µ –±—É–∫–≤–∞–ª—å–Ω–æ –æ–¥–Ω–æ–≥–æ —Å–ª–æ–≤–∞ –º–µ–Ω—è–µ—Ç —Å—Ç—Ä—É–∫—Ç—É—Ä—É –¥–µ—Ä–µ–≤–∞. 

## –¢–∞–Ω–≥–ª–≥—Ä–∞–º–º—ã

–ü–æ—ç—Ç–æ–º—É –±—ã–≤–∞–µ—Ç –Ω–µ–æ–±—Ö–æ–¥–∏–º–æ —Å—Ä–∞–≤–Ω–∏—Ç—å —Ä–∞–∑–Ω—ã–µ –¥–µ—Ä–µ–≤—å—è. –û–¥–∏–Ω –∏–∑ —Å–ø–æ—Å–æ–±–æ–≤ —ç—Ç–æ —Å–¥–µ–ª–∞—Ç—å –≤–∏–∑—É–∞–ª—å–Ω–æ -- –ø–æ—Å—Ç—Ä–æ–∏—Ç—å tanglegram, –Ω–∞–ø—Ä–∏–º–µ—Ä, –ø—Ä–∏ –ø–æ–º–æ—â–∏ –ø–∞–∫–µ—Ç–∞ `dendextend`. 

```{r message=FALSE}
library(stylo)
library(dendextend)

data("galbraith")
data <- as.data.frame.matrix(galbraith)
distmx <- dist(scale(data))

d1 <- as.dendrogram(hclust(distmx, method ="average"))  |>  
  set("labels_col", value = c("skyblue", "orange", "grey40"), k=3)  |> 
  set("branches_k_color", value = c("skyblue", "orange", "grey40"), k = 3)

d2 <- as.dendrogram(hclust(distmx, method ="ward.D2")) |> 
  set("labels_col", value = c("skyblue", "orange", "grey40"), k=3)  |> 
  set("branches_k_color", value = c("skyblue", "orange", "grey40"), k = 3)

dlist <- dendlist(d1, d2)

par(family = "Arial Bold")
tanglegram(dlist, common_subtrees_color_lines = FALSE, 
           highlight_distinct_edges  = TRUE, 
           highlight_branches_lwd=FALSE, 
           margin_inner=10, 
           lwd=2, 
           axes=FALSE, 
           main_left = "C—Ä–µ–¥–Ω—è—è", 
           main_right = "–£–æ—Ä–¥", 
           lab.cex = 1.3)
```

–ù–∞ –∫–∞—Ä—Ç–∏–Ω–∫–µ –≤–∏–¥–Ω–æ, —á—Ç–æ –∫–Ω–∏–≥–∏ –≥—Ä—É–ø–ø–∏—Ä—É—é—Ç—Å—è –Ω–µ–º–Ω–æ–≥–æ –ø–æ-—Ä–∞–∑–Ω–æ–º—É –≤ –∑–∞–≤–∏—Å–∏–º–æ—Å—Ç–∏ –æ—Ç –º–µ—Ç–æ–¥–∞ —Å–≤—è–∑–∏, —Ö–æ—Ç—è –¥–ª—è –∫–ª–∞—Å—Ç–µ—Ä–∏–∑–∞—Ü–∏–∏ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–ª–∞—Å—å –æ–¥–Ω–∞ –∏ —Ç–∞ –∂–µ –º–∞—Ç—Ä–∏—Ü–∞ —Ä–∞—Å—Å—Ç–æ—è–Ω–∏–π.

## –ö–æ–Ω—Å–µ–Ω—Å—É—Å–Ω—ã–µ –¥–µ—Ä–µ–≤—å—è –≤ `stylo`

–ö–æ–Ω—Å–µ–Ω—Å—É—Å–Ω–æ–µ –¥–µ—Ä–µ–≤–æ –ø–æ–∑–≤–æ–ª—è–µ—Ç "–æ–±–æ–±—â–∏—Ç—å" –ø—Ä–æ–∏–∑–≤–æ–ª—å–Ω–æ–µ —á–∏—Å–ª–æ –¥–µ–Ω–¥—Ä–æ–≥—Ä–∞–º–º. –í `stylo` –∑–∞ –∫–æ–Ω—Å–µ–Ω—Å—É—Å–Ω—ã–µ –¥–µ—Ä–µ–≤—å—è –æ—Ç–≤–µ—á–∞–µ—Ç –º–µ—Ç–æ–¥  `BCT` (Bootstrap Consensus Tree), –∫ –∫–æ—Ç–æ—Ä–æ–º—É –º–æ–∂–Ω–æ –æ–±—Ä–∞—Ç–∏—Ç—å—Å—è —á–µ—Ä–µ–∑ GUI (–Ω–æ –∑–¥–µ—Å—å –º—ã –ø–æ–∫–∞–∑—ã–≤–∞–µ–º —Ä–µ—à–µ–Ω–∏–µ –±–µ–∑ –Ω–µ–≥–æ).

```{r eval=FALSE}
bct_result <- stylo(gui = FALSE, 
                    frequencies = data,
                    analysis.type = "BCT",
                    mfw.min = 100,
                    mfw.max = 500,
                    mfw.incr = 100,
                    distance.measure = "wurzburg",
                    write.png.file = FALSE,
                    corpus.lang = "Other",
                    consensus.strength = 0.5,
                    rooted = T, 
                    plot.custom.width = 8, 
                    plot.custom.height = 8
                    )
```

![](./images/cons1.png)

–†–∞–±–æ—Ç–∞—Ç—å —á–µ—Ä–µ–∑ GUI —É–¥–æ–±–Ω–æ, –Ω–æ –µ—Å—Ç—å –Ω—é–∞–Ω—Å—ã. –í–æ-–ø–µ—Ä–≤—ã—Ö, –Ω–µ –ø–æ–ª—É—á–∏—Ç—Å—è –∫–∞—Å—Ç–æ–º–∏–∑–∏—Ä–æ–≤–∞—Ç—å –≤–Ω–µ—à–Ω–∏–π –≤–∏–¥ –¥–µ—Ä–µ–≤–∞, –∞, –≤–æ-–≤—Ç–æ—Ä—ã—Ö, –≤ Stylo —Ä–µ–∞–ª–∏–∑–æ–≤–∞–Ω–∞ –¥–æ—Å—Ç–∞—Ç–æ—á–Ω–æ —Å–ø–µ—Ü–∏—Ñ–∏—á–µ—Å–∫–∞—è –ø—Ä–æ—Ü–µ–¥—É—Ä–∞ –±—É—Ç—Å—Ç—Ä–µ–ø–∞ (–ø–æ–≤—Ç–æ—Ä–Ω—ã—Ö –≤—ã–±–æ—Ä–æ–∫). 

–í–æ—Ç —á—Ç–æ [–ø–∏—à—É—Ç](https://journal.r-project.org/archive/2016/RJ-2016-007/RJ-2016-007.pdf) —Ä–∞–∑—Ä–∞–±–æ—Ç—á–∏–∫–∏:

> Under the FEATURES tab, users can define the minutes of the MFW division and sampling procedure, using the increment, the minimum and maximum parameters. For minimum = 100, maximum = 3000, and increment = 50, stylo will run subsequent analyses for the following frequency bands: 100 MFW, 50‚Äì150 MFW, 100‚Äì200 MFW, ..., 2900‚Äì2950 MFW, 2950‚Äì3000 MFW.

–î–ª—è –∫–æ–Ω—Å–µ–Ω—Å—É—Å–∞ –Ω—É–∂–Ω–æ –º–Ω–æ–≥–æ –¥–µ—Ä–µ–≤—å–µ–≤, –∏ Stylo –±—É–¥–µ—Ç —Å—Ç—Ä–æ–∏—Ç—å —ç—Ç–∏ –¥–µ—Ä–µ–≤—å—è –≤ –∑–∞–¥–∞–Ω–Ω–æ–º –∏–Ω—Ç–µ—Ä–≤–∞–ª–µ. –≠—Ç–æ –∑–Ω–∞—á–∏—Ç, —á—Ç–æ –ø–æ—Å–ª–µ–¥–Ω–∏–µ –¥–µ—Ä–µ–≤—å—è –±—É–¥—É—Ç –ø–æ—Å—Ç—Ä–æ–µ–Ω—ã —É–∂–µ –Ω–µ –Ω–∞ –æ—Å–Ω–æ–≤–µ —Å–∞–º–æ–π —á–∞—Å—Ç–æ—Ç–Ω–æ–π –ª–µ–∫—Å–∏–∫–∏, —Ç.–µ. —Å–∫–æ—Ä–µ–µ –≤—Å–µ–≥–æ –Ω–∞ –Ω–∏—Ö –æ—Ç—Ä–∞–∑–∏—Ç—Å—è —Ç–µ–º–∞—Ç–∏–∫–∞ —Ç–µ–∫—Å—Ç–æ–≤, –≤—Ö–æ–¥—è—â–∏—Ö –≤ –∫–æ—Ä–ø—É—Å. 

–í –Ω–µ–∫–æ—Ç–æ—Ä—ã—Ö —Å–ª—É—á–∞—è—Ö —ç—Ç–æ —Ä–∞–±–æ—Ç–∞–µ—Ç –Ω–µ–ø–ª–æ—Ö–æ, –Ω–æ, –≤–æ–∑–º–æ–∂–Ω–æ, —É –≤–∞—Å –µ—Å—Ç—å –¥—Ä—É–≥–∏–µ –∏–¥–µ–∏ –¥–ª—è –∫–æ–Ω—Å–µ–Ω—Å—É—Å–∞. –†–∞–∑–Ω—ã–µ —Ä–∞—Å—Å—Ç–æ—è–Ω–∏—è. –†–∞–∑–Ω—ã–µ –º–µ—Ç–æ–¥—ã –∫–ª–∞—Å—Ç–µ—Ä–∏–∑–∞—Ü–∏–∏. –°–ª—É—á–∞–π–Ω—ã–µ –≤—ã–±–æ—Ä–∫–∏ –∏–∑ –ø–µ—Ä–≤—ã—Ö –¥–≤—É—Ö —Å–æ—Ç–µ–Ω —Å–ª–æ–≤ –∏–ª–∏ –µ—â–µ —á—Ç–æ-—Ç–æ. –¢–æ–≥–¥–∞ –ø—Ä–∏–¥–µ—Ç—Å—è —Å–∞–º–∏–º —Å—Ç—Ä–æ–∏—Ç—å —Å—Ä–∞–∑—É –º–Ω–æ–∂–µ—Å—Ç–≤–æ –¥–µ—Ä–µ–≤—å–µ–≤.

## –¶–µ–ª—ã–π –ª–µ—Å c `purrr`

–ï—Å–ª–∏ –∏–∑—É—á–∏—Ç—å –∏–∑–Ω–∞–Ω–∫—É —Ñ—É–Ω–∫—Ü–∏–∏ `stylo()`, –∫–æ—Ç–æ—Ä–∞—è –≤—ã–∑—ã–≤–∞–µ—Ç GUI –≤ –æ–¥–Ω–æ–∏–º–µ–Ω–Ω–æ–º –ø–∞–∫–µ—Ç–µ, —Ç–æ –º–æ–∂–Ω–æ –∑–∞–º–µ—Ç–∏—Ç—å, —á—Ç–æ –∑–∞ –∫–æ–Ω—Å–µ–Ω—Å—É—Å–Ω–æ–µ –¥–µ—Ä–µ–≤–æ —Ç–∞–º –æ—Ç–≤–µ—á–∞–µ—Ç –ø–∞–∫–µ—Ç –¥–ª—è —Ä–∞–±–æ—Ç—ã —Å —Ñ–∏–ª–æ–≥–µ–Ω–µ—Ç–∏—á–µ—Å–∫–∏–º–∏ –¥–∞–Ω–Ω—ã–º–∏ –ø–æ–¥ –Ω–∞–∑–≤–∞–Ω–∏–µ–º Ape ü¶ç

–ß—Ç–æ –¥–µ–ª–∞–µ—Ç –º–∞—à–∏–Ω–∞, –∫–æ–≥–¥–∞ –≤—ã –∑–∞–∫–∞–∑—ã–≤–∞–µ—Ç–µ —É –Ω–µ–µ –∫–æ–Ω—Å–µ–Ω—Å—É—Å–Ω–æ–µ –¥–µ—Ä–µ–≤–æ? –ü—Ä–∏–Ω–∏–º–∞–µ—Ç –Ω–∞ –≤—Ö–æ–¥–µ –º–∞—Ç—Ä–∏—Ü—É —Å `1 ‚Ä¶ n` —Å—Ç–æ–ª–±—Ü–∞–º–∏, –≤ –∫–æ—Ç–æ—Ä—ã—Ö —Ö—Ä–∞–Ω–∏—Ç—Å—è —á–∞—Å—Ç–æ—Ç–Ω–æ—Å—Ç—å –¥–ª—è —Å–ª–æ–≤. –ü–æ—Ç–æ–º –æ—Ç–±–∏—Ä–∞–µ—Ç –ø–µ—Ä–≤—ã–µ —Å–∫–æ–ª—å–∫–æ-—Ç–æ —Å–ª–æ–≤ (—Å–∫–∞–∂–µ–º, —Å–æ—Ç–Ω—é –∏–ª–∏ —Å–∫–æ–ª—å–∫–æ —Å–∫–∞–∂–µ—Ç–µ), —Å—á–∏—Ç–∞–µ—Ç —Ä–∞—Å—Å—Ç–æ—è–Ω–∏–µ, —Å—Ç—Ä–æ–∏—Ç –Ω–∞ –æ—Å–Ω–æ–≤–µ –º–∞—Ç—Ä–∏—Ü—ã —Ä–∞—Å—Å—Ç–æ—è–Ω–∏–π –¥–µ—Ä–µ–≤–æ, —Å–∫–ª–∞–¥—ã–≤–∞–µ—Ç –µ–≥–æ –≤ –∫–æ—Ä–∑–∏–Ω–∫—É. –ü–æ—Ç–æ–º –±–µ—Ä–µ—Ç —Å–ª–µ–¥—É—é—â—É—é —Å–æ—Ç–Ω—é —Å–ª–æ–≤, —Å—á–∏—Ç–∞–µ—Ç —Ä–∞—Å—Å—Ç–æ—è–Ω–∏–µ, —Å—Ç—Ä–æ–∏—Ç –¥–µ—Ä–µ–≤–æ, —Å–∫–ª–∞–¥—ã–≤–∞–µ—Ç –≤ –∫–æ—Ä–∑–∏–Ω–∫—É‚Ä¶ –ù—É –≤—ã –ø–æ–Ω—è–ª–∏. –ü–æ–ª—É—á–∞–µ—Ç—Å—è —Ü–µ–ª—ã–π –ª–µ—Å. 

–ó–≤—É—á–∏—Ç –∫–∞–∫ –∏—Ç–µ—Ä–∞—Ü–∏—è, –∞ —Ç–∞–∫–∏–µ –∑–∞–¥–∞—á–∏ –≤ R —Ä–µ—à–∞—é—Ç—Å—è –ø—Ä–∏ –ø–æ–º–æ—â–∏ —Ü–∏–∫–ª–∞ `for` –∏–ª–∏ –ø–∞–∫–µ—Ç–∞ `purrr`. –§—É–Ω–∫—Ü–∏–∏ `map()` –∏–∑ –ø–∞–∫–µ—Ç–∞ `purrr` –Ω–∞–¥–æ –≤—Ä—É—á–∏—Ç—å –¥—Ä—É–≥—É—é —Ñ—É–Ω–∫—Ü–∏—é -- —É –Ω–∞—Å —ç—Ç–æ –±—É–¥–µ—Ç –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å—Å–∫–∞—è  `get_tree()`.  –û–Ω–∞ –±–µ—Ä–µ—Ç —Å–ª—É—á–∞–π–Ω—ã–µ 100 —Å—Ç–æ–ª–±—Ü–æ–≤ –≤ —Ç–∞–±–ª–∏—Ü–µ —Å —á–∞—Å—Ç–æ—Ç–Ω–æ—Å—Ç—è–º–∏ `galbraith` –∏–∑ –ø–∞–∫–µ—Ç–∞ `Styl–æ`, —Å—á–∏—Ç–∞–µ—Ç –µ–≤–∫–ª–∏–¥–æ–≤–æ —Ä–∞—Å—Å—Ç–æ—è–Ω–∏–µ –º–µ–∂–¥—É –¥–æ–∫—É–º–µ–Ω—Ç–∞–º–∏ –∏ —Å—Ç—Ä–æ–∏—Ç –¥–µ—Ä–µ–≤–æ. 

```{r message=FALSE}
library(ape)

get_tree <- function(df) {
  X <- df[ , sample(3000, replace = F, size = 100)]
  distmx <- dist(scale(X))
  tr <- as.phylo(hclust(distmx))
  tr
}
```

–ó–∞–ø—É—Å–∫–∞–µ–º –µ–µ 13 —Ä–∞–∑ –ø—Ä–∏ –ø–æ–º–æ—â–∏ `map()`, –ø–æ–ª—É—á–∞–µ–º —Å–ø–∏—Å–æ–∫ –∏–∑ —Ç—Ä–∏–Ω–∞–¥—Ü–∞—Ç–∏ –¥–µ—Ä–µ–≤—å–µ–≤. –ï—Å–ª–∏ —Ö–æ—á–µ—Ç—Å—è –Ω–∞ –Ω–∏—Ö –ø–æ—Å–º–æ—Ç—Ä–µ—Ç—å –ø–æ –æ—Ç–¥–µ–ª—å–Ω–æ—Å—Ç–∏, —Ç–æ —Ñ—É–Ω–∫—Ü–∏–µ–π `walk()` –ø–µ—á–∞—Ç–∞–µ–º —Å—Ä–∞–∑—É –Ω–µ—Å–∫–æ–ª—å–∫–æ –¥–µ—Ä–µ–≤—å–µ–≤ –æ–¥–Ω–æ–π —Å—Ç—Ä–æ—á–∫–æ–π –∫–æ–¥–∞ üßôü™Ñ

```{r message=FALSE}
library(purrr)
set.seed(123)

trees_result <- map(1:13, ~get_tree(data))

# –æ—Ç–¥–µ–ª—å–Ω—ã–µ –¥–µ—Ä–µ–≤—å—è
par(mfrow = c(2, 2), mar = c(1,1,1,1))
walk(trees_result[1:4], plot)
```

–¢–∞–∫ –º–æ–∂–Ω–æ –ø–æ—Å—Ç—Ä–æ–∏—Ç—å –∏ 100, –∏ 1000 –¥–µ—Ä–µ–≤—å–µ–≤. –ù–æ —Å—Ä–∞–≤–Ω–∏–≤–∞—Ç—å –∏—Ö –≤—Ä—É—á–Ω—É—é –º—ã –Ω–µ –±—É–¥–µ–º, –∞ –≤–º–µ—Å—Ç–æ —ç—Ç–æ–≥–æ –ø–æ—Å—á–∏—Ç–∞–µ–º –∫–æ–Ω—Å–µ–Ω—Å—É—Å. –ù–æ —Å–Ω–∞—á–∞–ª–∞ —Ä–∞–∑–±–µ—Ä–µ–º—Å—è, —á—Ç–æ —ç—Ç–æ —Ç–∞–∫–æ–µ.

## `plot.phylo()`: –ø—Ä–æ—Å—Ç–æ–π –ø—Ä–∏–º–µ—Ä

–î–æ–ø—É—Å—Ç–∏–º, —É –Ω–∞—Å –µ—Å—Ç—å —Ç—Ä–∏ –¥–µ—Ä–µ–≤–∞. –°–æ–∑–¥–∞–¥–∏–º –∏—Ö —Å –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ–º —Ñ–æ—Ä–º–∞—Ç–∞ –ù—å—é–∏–∫–∞, —Ç.–µ. –ø—Ä–æ—Å—Ç–æ-–Ω–∞–ø—Ä–æ—Å—Ç–æ –∫–æ–º–±–∏–Ω–∞—Ü–∏–∏ —Å–∫–æ–±–æ–∫ –∏ –∑–∞–ø—è—Ç—ã—Ö. 


```{r}
tr1 <- read.tree(text = "((1,2),(3,4));")
tr2 <- read.tree(text = "((1,3),(2,4));")
tr3 <- read.tree(text = "((1,2),(3,4));")


par(mfrow = c(1, 3), mar = c(5,1,5,1), cex = 1)
walk(list(tr1, tr2, tr3), plot.phylo, tip.color = 2)
```

–ö–ª–∞—Å—Ç–µ—Ä—ã 1-2, 3-4 –≤—Å—Ç—Ä–µ—á–∞—é—Ç—Å—è –≤ –¥–≤—É—Ö –¥–µ—Ä–µ–≤—å—è—Ö, –æ—Å—Ç–∞–ª—å–Ω—ã–µ –ª–∏—à—å –≤ –æ–¥–Ω–æ–º. –ó–∞–¥–∞—á–∞ ‚Äî –Ω–∞–π—Ç–∏ –Ω–∞–∏–±–æ–ª–µ–µ —É—Å—Ç–æ–π—á–∏–≤—ã–µ –∫–ª–∞—Å—Ç–µ—Ä—ã –º–µ—Ç–æ–¥–æ–º [–ø—Ä–æ—Å—Ç–æ–≥–æ –±–æ–ª—å—à–∏–Ω—Å—Ç–≤–∞](https://www.webpages.uidaho.edu/~jacks/545.Lecture13.pdf). –î–ª—è —ç—Ç–æ–≥–æ —Å—á–∏—Ç–∞–µ–º –∫–æ–Ω—Å–µ–Ω—Å—É—Å, –ø—Ä–∏—á–µ–º –∞—Ä–≥—É–º–µ–Ω—Ç `p` —É–∫–∞–∑—ã–≤–∞–µ—Ç, —á—Ç–æ –∫–ª–∞—Å—Ç–µ—Ä –¥–æ–ª–∂–µ–Ω –±—ã—Ç—å –ø—Ä–µ–¥—Å—Ç–∞–≤–ª–µ–Ω –Ω–µ –º–µ–Ω–µ–µ, —á–µ–º –≤ –ø–æ–ª–æ–≤–∏–Ω–µ –¥–µ—Ä–µ–≤—å–µ–≤. –¢–∞–∫–∂–µ —É—Ç–æ—á–Ω—è–µ–º, —á—Ç–æ –Ω–∞—à–∏ –¥–µ—Ä–µ–≤—å—è —É–∫–æ—Ä–µ–Ω–µ–Ω—ã.

```{r}
cons <- consensus(list(tr1, tr2, tr3), p = 0.5, rooted = TRUE)
```

–ó–Ω–∞—á–µ–Ω–∏–µ p –Ω–µ –º–æ–∂–µ—Ç –±—ã—Ç—å –º–µ–Ω—å—à–µ 0.5, –ø–æ—Ç–æ–º—É —á—Ç–æ –∫–æ–Ω—Ñ–ª–∏–∫—Ç—É—é—â–∏–µ —Å–ø–ª–∏—Ç—ã –Ω–µ –º–æ–≥—É—Ç –±—ã—Ç—å –ø—Ä–µ–¥—Å—Ç–∞–≤–ª–µ–Ω—ã –≤–º–µ—Å—Ç–µ –≤ –æ–¥–Ω–æ–º –¥–µ—Ä–µ–≤–µ.

–¢–µ–ø–µ—Ä—å –∏–∑–æ–±—Ä–∞–∑–∏–º –∫–æ–Ω—Å–µ–Ω—Å—É—Å –≤ –≤–∏–¥–µ –¥–µ—Ä–µ–≤–∞; –¥–æ–ø–æ–ª–Ω–∏—Ç–µ–ª—å–Ω–æ –¥–ª—è —É–∑–ª–æ–≤ —É–∫–∞–∂–µ–º —Å–∏–ª—É –∫–æ–Ω—Å–µ–Ω—Å—É—Å–∞ (2/3 = 0.67):

```{r}
par(mfrow = c(1,1), mar = c(5,5,5,5))
plot.phylo(cons, tip.color = 2)
nodelabels(round(cons$node.label[3],2), 7, frame = "c", cex = 0.7)
nodelabels(round(cons$node.label[2],2), 6, bg = "yellow")
```

–≠—Ç–æ –æ—á–µ–Ω—å –ø—Ä–æ—Å—Ç–æ–µ –∫–æ–Ω—Å–µ–Ω—Å—É—Å–Ω–æ–µ –¥–µ—Ä–µ–≤–æ, –ø–æ—Å—Ç—Ä–æ–µ–Ω–Ω–æ–µ –ø–æ –º–µ—Ç–æ–¥—É –ø—Ä–æ—Å—Ç–æ–≥–æ –±–æ–ª—å—à–∏–Ω—Å—Ç–≤–∞. 

## `plot.phylo()`: galbraith

–¢–µ–ø–µ—Ä—å –ø–æ–ø—Ä–æ–±—É–µ–º —Å–¥–µ–ª–∞—Ç—å —Ç–∞–∫–æ–µ –∂–µ –¥–µ—Ä–µ–≤–æ –¥–ª—è —Ç–µ–∫—Å—Ç–æ–≤—ã—Ö –¥–∞–Ω–Ω—ã—Ö.

```{r fig.width=12, message=FALSE}
library(tidyverse)
library(harrypotter)

# –¥–æ–±–∞–≤–∏–º –∫—Ä–∞—Å–æ—Ç—ã 
pal <- hp(n = 5, option = "Gryffindor")

cons <- consensus(trees_result, p = 0.5, rooted = FALSE)

# –Ω–∞–∑–Ω–∞—á–∞–µ–º –∞–≤—Ç–æ—Ä–∞–º —Ü–≤–µ—Ç–∞
cols <- tibble(author = str_remove(cons$tip.label, "_.+")) |> 
  mutate(color = case_when(author == "coben"  ~ pal[1],
                           author == "galbraith" ~ pal[2],
                           author == "lewis"  ~ pal[3],
                           author == "rowling" ~ pal[4],
                           author == "tolkien"  ~ pal[5]))
 
# —Å—Ç—Ä–æ–∏–º –¥–µ—Ä–µ–≤–æ
par(mar = c(0,0,0,0))
plot.phylo(cons, 
           type = "fan", 
           use.edge.length = FALSE,
           edge.width = 1.5, 
           node.color = "grey30",
           font = 2, 
           no.margin = TRUE, 
           label.offset = 0.1,
           direction = "rightwards", 
           plot = TRUE, 
           lab4ut = "a",
           node.depth = 1, 
           tip.color = cols$color)

# –ø–æ–¥–ø–∏—Å—ã–≤–∞–µ–º —É–∑–ª—ã
nodelabels(text=sprintf("%.2f", cons$node.label),
           node=1:cons$Nnode+Ntip(cons),
           frame="circle",
           bg = "#E8C4A2FF",
           cex = 0.5, 
           )

```

## `consensusNet()`: –ø—Ä–æ—Å—Ç–æ–π –ø—Ä–∏–º–µ—Ä

–£ –∫–æ–Ω—Å–µ–Ω—Å—É—Å–Ω–æ–≥–æ –¥–µ—Ä–µ–≤–∞ –µ—Å—Ç—å –æ–¥–Ω–æ –æ—á–µ–≤–∏–¥–Ω–æ–µ –æ–≥—Ä–∞–Ω–∏—á–µ–Ω–∏–µ: –æ–Ω–æ –ø–ª–æ—Ö–æ –ø–µ—Ä–µ–¥–∞–µ—Ç –∫–æ–Ω—Ñ–ª–∏–∫—Ç—É—é—â–∏–µ —Å–∏–≥–Ω–∞–ª—ã. –î–æ–ø—É—Å—Ç–∏–º, —É –Ω–∞—Å –µ—Å—Ç—å —Ç—Ä–∏ –Ω–µ—É–∫–æ—Ä–µ–Ω—ë–Ω–Ω—ã—Ö –¥–µ—Ä–µ–≤–∞. 

```{r fig.align='center', fig.height=4}
tr1 <- read.tree(text = "((1,2),(3,4));")
tr2 <- read.tree(text = "((1,3),(2,4));")
tr3 <- read.tree(text = "((1,4),(2,3));")

par(mfrow = c(1, 3), mar = c(0,0,0,0), cex=1)
walk(list(tr1, tr2, tr3), 
     plot.phylo, 
     tip.color=2, 
     type="unrooted",
     label.offset = 0.1)
```


–ö–æ–Ω—Å–µ–Ω—Å—É—Å–Ω–æ–µ –¥–µ—Ä–µ–≤–æ –≤ —Ç–∞–∫–æ–º —Å–ª—É—á–∞–µ –Ω–∏–∫–∞–∫ –Ω–µ –ø–æ–º–æ–∂–µ—Ç: –æ–Ω–æ –Ω–µ –¥–æ–ø—É—Å–∫–∞–µ—Ç –∑–Ω–∞—á–µ–Ω–∏–π p < 0.5. –ü—Ä–æ–≤–µ—Ä—å—Ç–µ —Å–∞–º–∏: –∫–æ–¥ –Ω–∏–∂–µ –≤–µ—Ä–Ω–µ—Ç —Å–∞–¥–æ–≤—ã–µ –≤–∏–ª—ã üî±

```{r}
par(mfrow = c(1,1))
cons <- consensus(list(tr1, tr2, tr3), p = 0.5, rooted = F)
plot.phylo(cons)

nodelabels(text=sprintf("%.2f", cons$node.label),
           node=1:cons$Nnode+Ntip(cons),
           frame="circle",
           bg = "#E8C4A2FF",
           cex = 0.5, 
           )
```

–í —Ç–∞–∫–∏—Ö —Å–ª—É—á–∞—è—Ö –Ω–∞ –ø–æ–º–æ—â—å –ø—Ä–∏—Ö–æ–¥–∏—Ç –∫–æ–Ω—Å–µ–Ω—Å—É—Å–Ω–∞—è —Å–µ—Ç—å. –ü–æ—Å—Ç—Ä–æ–∏–º —Å–µ—Ç—å —Å –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ–º –ø–∞–∫–µ—Ç–∞ `phangorn`. –ù–∞ –≤—Ö–æ–¥–µ –æ—Ç–¥–∞–µ–º –æ–±—ä–µ–∫—Ç –∫–ª–∞—Å—Å–∞ `multiPhylo`, —ç—Ç–æ –ø–æ —Å—É—Ç–∏ –ø—Ä–æ—Å—Ç–æ —Ç—Ä–∏ –¥–µ—Ä–µ–≤–∞ –≤ –æ–¥–Ω–æ–º "–±—É–∫–µ—Ç–µ".

```{r message=FALSE}
library(phangorn)
library(TreeTools)
mph <- as.multiPhylo(list(tr1, tr2, tr3))

cons.nw <- consensusNet(mph, prob = 0.3, rooted = FALSE)
class(cons.nw)
```

–û–±—ä–µ–∫—Ç cons.nw –æ—Ç–Ω–æ—Å–∏—Ç—Å—è –∫ –∫–ª–∞—Å—Å—É networx. –ï–≥–æ –º–æ–∂–Ω–æ –∏–∑–æ–±—Ä–∞–∑–∏—Ç—å –∫–∞–∫ –≤ –¥–≤—É—Ö, —Ç–∞–∫ –∏ –≤ —Ç—Ä–µ—Ö –∏–∑–º–µ—Ä–µ–Ω–∏—è—Ö. –í–æ—Ç 2D.

```{r}
set.seed(16092024)
par(mar = c(0,0,0,0))
plot(cons.nw, type = "2D")
```

–ê –≤–æ—Ç 3D. 

```{r eval=FALSE}
library(rgl) 
plot(cons.nw, "3D")
# create animated gif file 
movie3d(spin3d(axis=c(0,1,0), rpm=3), 
        duration=10, 
        dir = ".",  
        type = "gif")
```

<img src="./images/movie.gif" loop=infinite>

–¢–µ–ø–µ—Ä—å –ø–æ–ø—Ä–æ–±—É–µ–º –ø–æ–Ω—è—Ç—å, —á—Ç–æ —ç—Ç–æ –∑–Ω–∞—á–∏—Ç (–∏–ª–ª—é—Å—Ç—Ä–∞—Ü–∏—è –∏ –æ–±—ä—è—Å–Ω–µ–Ω–∏–µ [–æ—Ç—Å—é–¥–∞](https://link.springer.com/book/10.1007/978-1-4614-1743-9)). 

![](./images/cons2.png) 



–†–∞—Å—Å–º–æ—Ç—Ä–∏–º –Ω–µ—É–∫–æ—Ä–µ–Ω–µ–Ω–Ω—ã–µ –¥–µ—Ä–µ–≤—å—è –≤ —Å–µ—Ä–µ–¥–∏–Ω–µ: –∏—Ö –≤–Ω—É—Ç—Ä–µ–Ω–Ω–∏–µ –≤–µ—Ç–≤–∏ –æ–ø—Ä–µ–¥–µ–ª—è—é—Ç —Ä–∞—Å—â–µ–ø–ª–µ–Ω–∏—è (splits), –∞ –∏–º–µ–Ω–Ω–æ 12|34, 13|24 –∏ 14|23, –∫–æ—Ç–æ—Ä—ã–µ —è–≤–Ω–æ –Ω–µ –º–æ–≥—É—Ç –Ω–∞–±–ª—é–¥–∞—Ç—å—Å—è –≤ –æ–¥–Ω–æ–º –¥–µ—Ä–µ–≤–µ –∏, —Å–ª–µ–¥–æ–≤–∞—Ç–µ–ª—å–Ω–æ, –≤—Å–µ –æ–Ω–∏ –Ω–µ—Å–æ–≤–º–µ—Å—Ç–∏–º—ã. –°–µ—Ç—å –≤ –ª–µ–≤–æ–º –≤–µ—Ä—Ö–Ω–µ–º —É–≥–ª—É –ø—Ä–µ–¥—Å—Ç–∞–≤–ª—è–µ—Ç –æ–¥–Ω–æ–≤—Ä–µ–º–µ–Ω–Ω–æ –¥–≤–∞ –ø–µ—Ä–≤—ã—Ö –¥–µ—Ä–µ–≤–∞ —Å –ø—Ä—è–º–æ—É–≥–æ–ª—å–Ω–∏–∫–æ–º, —Å–∏–º–≤–æ–ª–∏–∑–∏—Ä—É—é—â–∏–º –¥–≤–µ –≤–Ω—É—Ç—Ä–µ–Ω–Ω–∏–µ –≤–µ—Ç–≤–∏. –ß—Ç–æ–±—ã –ø—Ä–µ–¥—Å—Ç–∞–≤–∏—Ç—å –≤—Å–µ —Ç—Ä–∏ —Ä–∞—Å—â–µ–ø–ª–µ–Ω–∏—è, –Ω–∞–º –Ω—É–∂–µ–Ω –∫—É–±, –∫–∞–∫ –ø–æ–∫–∞–∑–∞–Ω–æ —Å–ø—Ä–∞–≤–∞. 


## `consensusNet()`: galbraith

–ò—Ç–∞–∫, —É –Ω–∞—Å –µ—Å—Ç—å 13 –¥–µ—Ä–µ–≤—å–µ–≤ –¥–ª—è –¥–∞–Ω–Ω—ã—Ö galbraith.

```{r message=FALSE}
# –≤—ã—á–∏—Å–ª—è–µ–º –∫–æ–Ω—Å–µ–Ω—Å—É—Å
mph <- as.multiPhylo(trees_result)
cons.nw <- consensusNet(mph, prob = 0.3, rooted = FALSE)
```

–ü—Ä–∏–¥–µ—Ç—Å—è –Ω–µ–º–Ω–æ–≥–æ –ø–æ–∫–æ–ª–¥–æ–≤–∞—Ç—å, —á—Ç–æ–±—ã —Ä–∞—Å–∫—Ä–∞—Å–∏—Ç—å —Å–µ—Ç—å. 

```{r}
library(tidyverse)
cons.nw$col <- str_remove_all(cons.nw$tip.label, "_.+")

col_tbl <- tibble(label = unique(cons.nw$col),
                  col = pal)

color_group <- tibble(label = cons.nw$col) |> 
  left_join(col_tbl)
  
cons.nw$col <- color_group$col
```

```{r}
# —Ä–∏—Å—É–µ–º
set.seed(16092024)
par(mar = c(0,0,0,0))
plot(cons.nw, type = "2D", 
     direction = "axial",
     tip.color = cons.nw$col,
     edge.color = "grey30",
     edge.width = 1,)
```

–¢–∞–∫–∏–º –æ–±—Ä–∞–∑–æ–º, `consensusNet()` —Å—Ç—Ä–æ–∏—Ç –∫–æ–Ω—Å–µ–Ω—Å—É—Å–Ω—É—é —Å–µ—Ç—å –Ω–∞ –æ—Å–Ω–æ–≤–µ –Ω–∞–±–æ—Ä–∞ –¥–µ—Ä–µ–≤—å–µ–≤: —ç—Ç–æ –ø–æ–∑–≤–æ–ª—è–µ—Ç –≤–∏–∑—É–∞–ª–∏–∑–∏—Ä–æ–≤–∞—Ç—å —Å—Ç–µ–ø–µ–Ω—å –ø–æ–¥–¥–µ—Ä–∂–∫–∏ —Ä–∞–∑–ª–∏—á–Ω—ã—Ö —Å–≤—è–∑–µ–π, –Ω–∞–π–¥–µ–Ω–Ω—ã—Ö –≤ –Ω–∞–±–æ—Ä–µ –¥–µ—Ä–µ–≤—å–µ–≤. –ü–æ–¥—Ö–æ–¥ –ø–æ–ª–µ–∑–µ–Ω –¥–ª—è –≤—ã—è–≤–ª–µ–Ω–∏—è –æ–±–ª–∞—Å—Ç–µ–π –Ω–µ–æ–ø—Ä–µ–¥–µ–ª–µ–Ω–Ω–æ—Å—Ç–∏ –≤ —Ñ–∏–ª–æ–≥–µ–Ω–µ—Ç–∏—á–µ—Å–∫–∏—Ö –æ—Ç–Ω–æ—à–µ–Ω–∏—è—Ö, –∫–æ–≥–¥–∞ –Ω–µ—Å–∫–æ–ª—å–∫–æ —Ä–∞–∑–Ω—ã—Ö –¥–µ—Ä–µ–≤—å–µ–≤ –æ–¥–∏–Ω–∞–∫–æ–≤–æ —Ö–æ—Ä–æ—à–æ —Å–æ–æ—Ç–≤–µ—Ç—Å—Ç–≤—É—é—Ç –¥–∞–Ω–Ω—ã–º.

## `neighborNet()`: –ø—Ä–æ—Å—Ç–æ–π –ø—Ä–∏–º–µ—Ä 

–ï—â–µ –æ–¥–∏–Ω –∞–ª–≥–æ—Ä–∏—Ç–º –¥–ª—è –≤–∏–∑—É–∞–ª–∏–∑–∞—Ü–∏–∏ –Ω–µ–æ–¥–Ω–æ–∑–Ω–∞—á–Ω—ã—Ö —Ñ–∏–ª–æ–≥–µ–Ω–µ—Ç–∏—á–µ—Å–∫–∏—Ö –æ—Ç–Ω–æ—à–µ–Ω–∏–π –≤ R –Ω–∞–∑–≤–∞–µ—Ç—Å—è [neighborNet](https://academic.oup.com/mbe/article/21/2/255/1187993). –û–Ω –ø–æ–¥—Ö–æ–¥–∏—Ç –¥–ª—è —Ç–µ—Ö —Å–ª—É—á–∞–µ–≤, –∫–æ–≥–¥–∞ –º—ã –ø–æ–¥–æ–∑—Ä–µ–≤–∞–µ–º –Ω–∞—Ä—É—à–µ–Ω–∏—è –≤ –¥—Ä–µ–≤–æ–≤–∏–¥–Ω–æ–π —Å—Ç—Ä—É–∫—Ç—É—Ä–µ (–≤ –≥–µ–Ω–µ—Ç–∏–∫–µ —ç—Ç–æ –º–æ–∂–µ—Ç –±—ã—Ç—å –≥–æ—Ä–∏–∑–æ–Ω—Ç–∞–ª—å–Ω—ã–π –ø–µ—Ä–µ–Ω–æ—Å –≥–µ–Ω–æ–≤, –∞ –≤ –ª–∏—Ç–µ—Ä–∞—Ç—É—Ä–µ -- –Ω–∞–ø—Ä–∏–º–µ—Ä, –æ—Ç–Ω–æ—à–µ–Ω–∏—è –ø–æ–¥—Ä–∞–∂–∞–Ω–∏—è –∏–ª–∏ —Ç.–ø.). 

–ö–ª—é—á–µ–≤–æ–µ —Ä–∞–∑–ª–∏—á–∏–µ –ø–æ —Å—Ä–∞–≤–Ω–µ–Ω–∏—é —Å `consensusNet()` –∑–∞–∫–ª—é—á–∞–µ—Ç—Å—è –≤ —Ç–æ–º, —á—Ç–æ `neighborNet()` —Å—Ç—Ä–æ–∏—Ç —Å–µ—Ç—å –Ω–µ–ø–æ—Å—Ä–µ–¥—Å—Ç–≤–µ–Ω–Ω–æ –∏–∑ –¥–∞–Ω–Ω—ã—Ö, –∞ –Ω–µ –Ω–∞ –æ—Å–Ω–æ–≤–µ –Ω–∞–±–æ—Ä–∞ –¥–µ—Ä–µ–≤—å–µ–≤. 

NeighborNet —Ä–∞–±–æ—Ç–∞–µ—Ç –≤ –¥–≤–∞ —à–∞–≥–∞:

- –°–Ω–∞—á–∞–ª–∞ —Å—Ç—Ä–æ–∏—Ç –∫—Ä—É–≥–æ–≤—É—é —Ä–∞—Å–∫–ª–∞–¥–∫—É –¥–ª—è —Ç–∞–∫—Å–æ–Ω–æ–≤ —Ç–∞–∫–∏–º –æ–±—Ä–∞–∑–æ–º, —á—Ç–æ–±—ã –º–∏–Ω–∏–º–∏–∑–∏—Ä–æ–≤–∞—Ç—å —Ä–∞—Å—Å—Ç–æ—è–Ω–∏—è –º–µ–∂–¥—É –ø–∞—Ä–∞–º–∏ –∫–ª–∞—Å—Ç–µ—Ä–æ–≤, –∫–∞–∂–¥—ã–π –∏–∑ –∫–æ—Ç–æ—Ä—ã—Ö –≤–∫–ª—é—á–∞–µ—Ç –≤ —Å–µ–±—è 1 –∏–ª–∏ 2 —Ç–∞–∫—Å–æ–Ω–∞. 
- –ü–æ—Ç–æ–º —Å—á–∏—Ç–∞–µ—Ç –≤–µ—Å–∞ –¥–ª—è —Å–ø–ª–∏—Ç–æ–≤. –ù–∞ —ç—Ç–æ–º —ç—Ç–∞–ø–µ –Ω–µ–∫–æ—Ç–æ—Ä—ã–µ —Ä–µ–±—Ä–∞ —É–¥–∞–ª—è—é—Ç—Å—è, –∞ –¥—Ä—É–≥–∏–µ –≤—ã—Ç—è–≥–∏–≤–∞—é—Ç—Å—è —Å–æ–æ–±—Ä–∞–∑–Ω–æ –≤–µ—Å–∞–º. –ß–µ–º –¥–ª–∏–Ω–Ω–µ–µ —Ä–µ–±—Ä–æ, —Ç–µ–º –±–æ–ª—å—à–µ –≤–µ—Å —Å–ø–ª–∏—Ç–∞. 

–†–∞—Å—Å–º–æ—Ç—Ä–∏–º —ç—Ç–æ –Ω–∞ –ø—Ä–æ—Å—Ç–æ–º –ø—Ä–∏–º–µ—Ä–µ. –ü—Ä–µ–¥—Å—Ç–∞–≤—å—Ç–µ, —á—Ç–æ —É –Ω–∞—Å –µ—Å—Ç—å —Å–ª–µ–¥—É—é—â–∞—è –º–∞—Ç—Ä–∏—Ü–∞ —Ä–∞—Å—Å—Ç–æ—è–Ω–∏–π. 

```{r}
mx <- matrix(data = c(0, 0.07, 0.12, 0.12, 0.07, 0, 0.13, 0.09, 0.12, 0.13, 0, 0.06, 0.12, 0.09, 0.06, 0), nrow = 4)
colnames(mx) <- c("a", "b", "c", "d")
rownames(mx) <- colnames(mx)
mx

D <- as.dist(mx)
D
```

–û—Ç –º–∞—Ç—Ä–∏—Ü—ã —Ä–∞—Å—Å—Ç–æ—è–Ω–∏–π –º–æ–∂–Ω–æ –ø–µ—Ä–µ–π—Ç–∏ –∫ –¥–ª–∏–Ω–µ —Ä–µ–±–µ—Ä. –î–ª—è –Ω–∞—à–µ–π –ø—Ä–æ—Å—Ç–æ–π –º–∞—Ç—Ä–∏—Ü—ã –¥–ª–∏–Ω–∞ –≥–æ—Ä–∏–∑–æ–Ω—Ç–∞–ª—å–Ω—ã—Ö —Ä–µ–±–µ—Ä, –Ω–∞–ø—Ä–∏–º–µ—Ä, —Å—á–∏—Ç–∞–µ—Ç—Å—è –ø–æ —Ñ–æ—Ä–º—É–ª–µ: 

$1/2 (max(D[a,d]+D[b,c], D[a,c]+D[b,d])-D[a,b] ‚Äì D[d,c])$

$1/2 (max(0.12+0.13, 0.12+0.09) ‚Äì 0.07 ‚Äì 0.06) = 0.06$


```{r}
nnet <- neighborNet(D)
par(mar = c(0,0,0,0))
plot(nnet, show.edge.label = T, 
     edge.label = nnet$edge.length, 
     edge.color = "grey", 
     col.edge.label = "navy")
```

–ê–Ω–∞–ª–æ–≥–∏—á–Ω—ã–º –æ–±—Ä–∞–∑–æ–º —Å—á–∏—Ç–∞–µ—Ç—Å—è –¥–ª–∏–Ω–∞ –≤–µ—Ä—Ç–∏–∫–∞–ª—å–Ω—ã—Ö —Ä–µ–±–µ—Ä. –§–æ—Ä–º—É–ª–∞ —Å—Ä–∞–±–æ—Ç–∞–µ—Ç –º–∞–∫—Å–∏–º—É–º –¥–ª—è —á–µ—Ç—ã—Ä–µ—Ö —Ç–∞–∫—Å–æ–Ω–æ–≤, –¥–ª—è –±–æ–ª–µ–µ —Å–ª–æ–∂–Ω—ã—Ö —Å—Ç—Ä—É–∫—Ç—É—Ä –ø–æ–Ω–∞–¥–æ–±–∏—Ç—Å—è –º–µ—Ç–æ–¥ –Ω–∞–∏–º–µ–Ω—å—à–∏—Ö –∫–≤–∞–¥—Ä–∞—Ç–æ–≤. –í—Å–µ –≤—ã—á–∏—Å–ª–µ–Ω–∏—è –¥–µ–ª–∞–µ—Ç —Ñ—É–Ω–∫—Ü–∏—è [neighborNet](https://rdrr.io/cran/phangorn/man/neighborNet.html) –∏–∑ –ø–∞–∫–µ—Ç–∞ `phangorn`. 

–ï—Å–ª–∏ –∞—Ä–≥—É–º–µ–Ω—Ç—É `edge.label` –æ—Å—Ç–∞–≤–∏—Ç—å –∑–Ω–∞—á–µ–Ω–∏–µ –ø–æ —É–º–æ–ª—á–∞–Ω–∏—é, —Ç–æ –Ω–∞ –∫–∞—Ä—Ç–∏–Ω–∫–µ —É–≤–∏–¥–∏—Ç–µ –Ω–æ–º–µ—Ä —Å–ø–ª–∏—Ç–∞. 

```{r}
par(mar = c(0,0,0,0))
plot(nnet, show.edge.label = T, 
     edge.color = "grey", 
     col.edge.label = "red")
```

–£ –∫–∞–∂–¥–æ–≥–æ —Å–ø–ª–∏—Ç–∞ –µ—Å—Ç—å —Å–≤–æ–π –≤–µ—Å (—Ä–∞—Å—Å—á–∏—Ç–∞–Ω–Ω—ã–π –º–µ—Ç–æ–¥–æ–º –Ω–∞–∏–º–µ–Ω—å—à–∏—Ö –∫–≤–∞–¥—Ä–∞—Ç–æ–≤). –ï–≥–æ –º–æ–∂–Ω–æ –¥–æ—Å—Ç–∞—Ç—å –∏–∑ –æ–±—ä–µ–∫—Ç–∞ nnet. 

```{r}
w = attr(nnet$splits, "weights")
w
```
–≠—Ç–æ –º–æ–∂–Ω–æ –ø–æ–Ω—è—Ç—å —Ç–∞–∫: —á—Ç–æ–±—ã –ø–æ–ø–∞—Å—Ç—å –∏–∑ –ø—É–Ω–∫–∞ b –≤ –ø—É–Ω–∫—Ç d, –Ω—É–∂–Ω–æ —Å–ª–æ–∂–∏—Ç—å –≤–µ—Å–∞ –¥–ª—è —Å–ø–ª–∏—Ç–æ–≤ 4, 5 –∏ 1:

```{r}
w[4] + w[5] + w[1]
```
–≠—Ç–æ –≤–µ—Ä–Ω–µ—Ç –Ω–∞–º 0.09. –°–≤–µ—Ä—è–µ–º—Å—è —Å –º–∞—Ç—Ä–∏—Ü–µ–π —Ä–∞—Å—Å—Ç–æ—è–Ω–∏–π ‚Äî –≤—Å–µ –≤–µ—Ä–Ω–æ! 

–°–ø–ª–∏—Ç ‚Äî —ç—Ç–æ —Ä–∞–∑–±–∏–µ–Ω–∏–µ —Å–æ–≤–æ–∫—É–ø–Ω–æ—Å—Ç–∏ —Ç–∞–∫—Å–æ–Ω–æ–≤ –Ω–∞ –¥–≤–∞ –Ω–µ–ø—É—Å—Ç—ã—Ö –º–Ω–æ–∂–µ—Å—Ç–≤–∞. –ü–æ—Å–º–æ—Ç—Ä–∏–º, –∫–∞–∫–∏–µ —Å–ø–ª–∏—Ç—ã –≤–æ–∑–º–æ–∂–Ω—ã –¥–ª—è 4 —Ç–∞–∫—Å–æ–Ω–æ–≤ –∏–∑ –Ω–∞—à–µ–≥–æ –ø—Ä–∏–º–µ—Ä–∞:  

```{r}
as.matrix(nnet$splits)
```

–ü–µ—Ä–≤—ã–µ —á–µ—Ç—ã—Ä–µ —Å–ø–ª–∏—Ç–∞ –¥–æ–≤–æ–ª—å–Ω–æ –∑–∞—É—Ä—è–¥–Ω—ã: –º—ã –ø—Ä–æ—Å—Ç–æ –æ—Ç–∫—É—Å—ã–≤–∞–µ–º –ø–æ –æ–¥–Ω–æ–º—É —É–≥–ª—É –æ—Ç –Ω–∞—à–µ–≥–æ –ø—Ä—è–º–æ—É–≥–æ–ª—å–Ω–∏–∫–∞. –ü—è—Ç—ã–π —Å–ø–ª–∏—Ç –¥–µ–ª–∏—Ç –ø—Ä—è–º–æ—É–≥–æ–ª—å–Ω–∏–∫ –ø–æ–ø–µ—Ä–µ–∫, –∞ —à–µ—Å—Ç–æ–π ‚Äî –≤–¥–æ–ª—å. –î–∞–ª—å—à–µ –∞–ª–≥–æ—Ä–∏—Ç–º –¥–ª—è –∫–∞–∂–¥–æ–≥–æ —Å–ø–ª–∏—Ç–∞ [—Å—á–∏—Ç–∞–µ—Ç](https://rdrr.io/cran/phangorn/src/R/neighborNet.R), –∫–∞–∫–∏–µ –ø–∞—Ä—ã —Ç–∞–∫—Å–æ–Ω–æ–≤ –æ–∫–∞–∑–∞–ª–∏—Å—å —Å —Ä–∞–∑–Ω—ã—Ö —Å—Ç–æ—Ä–æ–Ω —Å–ø–ª–∏—Ç–∞. –ù–∞ –æ—Å–Ω–æ–≤–µ  –º–∞—Ç—Ä–∏—Ü—ã —Å–ø–ª–∏—Ç–æ–≤ `–ê` –∏ –∏—Å—Ö–æ–¥–Ω–æ–π –º–∞—Ç—Ä–∏—Ü—ã —Ä–∞—Å—Å—Ç–æ—è–Ω–∏–π `D` —Ä–∞—Å—Å—á–∏—Ç—ã–≤–∞–µ—Ç—Å—è –¥–ª–∏–Ω–∞ —Ä–µ–±—Ä–∞ —Ç–∞–∫–∏–º –æ–±—Ä–∞–∑–æ–º, —á—Ç–æ–±—ã –∫—Ä–∞—Ç—á–∞–π—à–∏–µ –ø—É—Ç–∏ –º–µ–∂–¥—É —Ç–∞–∫—Å–æ–Ω–∞–º–∏ –±—ã–ª–∏ –º–∞–∫—Å–∏–º–∞–ª—å–Ω–æ –ø—Ä–∏–±–ª–∏–∂–µ–Ω—ã –∫ –∏—Å—Ö–æ–¥–Ω–æ–π –º–∞—Ç—Ä–∏—Ü–µ —Ä–∞—Å—Å—Ç–æ—è–Ω–∏–π. 

–ö–∞–∫ —É–∂–µ –≥–æ–≤–æ—Ä–∏–ª–æ—Å—å, –¥–ª—è 4-—Ö —Ç–∞–∫—Å–æ–Ω–æ–≤ —Å–æ–æ—Ç–≤–µ—Ç—Å—Ç–≤–∏–µ –º–æ–∂–µ—Ç –±—ã—Ç—å –ø–æ–ª–Ω—ã–º. –≠—Ç–æ –ª–µ–≥–∫–æ –ø—Ä–æ–≤–µ—Ä–∏—Ç—å, –¥–æ—Å—Ç–∞–≤ –∞—Ç—Ä–∏–±—É—Ç RSS (Residual Sum of Squares, –æ—Å—Ç–∞—Ç–æ—á–Ω–∞—è —Å—É–º–º–∞ –∫–≤–∞–¥—Ä–∞—Ç–æ–≤) –∏–∑ –æ–±—ä–µ–∫—Ç–∞ nnet, –∫–æ—Ç–æ—Ä—ã–π –º—ã —Å–æ–∑–¥–∞–ª–∏. 

```{r}
round(attr(nnet$splits, "RSS"), 3)
```

## `neighborNet()`: galbraith

–¢–µ–ø–µ—Ä—å –ø—Ä–∏–º–µ–Ω–∏–º –∞–ª–≥–æ—Ä–∏—Ç–º –∫ —Ä–µ–∞–ª—å–Ω—ã–º –¥–∞–Ω–Ω—ã–º. 

```{r}
par(mar = c(0,0,0,0), cex = 0.8)
nnet <- neighborNet(distmx)

#remotes::install_github("MatthewBJane/ThemePark")
library(ThemePark)
pal <- lordoftherings_theme_colors[c(1:4, 7)]


# –Ω–∞–∑–Ω–∞—á–∞–µ–º –∞–≤—Ç–æ—Ä–∞–º —Ü–≤–µ—Ç–∞
cols <- tibble(author = str_remove(nnet$tip.label, "_.+")) |> 
  mutate(color = case_when(author == "coben"  ~ pal[1],
                           author == "galbraith" ~ pal[2],
                           author == "lewis"  ~ pal[3],
                           author == "rowling" ~ pal[4],
                           author == "tolkien"  ~ pal[5]))
 

plot(nnet, 
     direction = "axial",
     edge.color = "grey30",
     use.edge.length = TRUE, # –ø–æ–ø—Ä–æ–±—É–π—Ç–µ FALSE
     edge.width = 1,
     tip.color = cols$color)
```


–í —Å—Ç–∞—Ç—å–µ  ‚ÄúUntangling Our Past: Languages, Trees, Splits and Networks‚Äù —Å–æ–∑–¥–∞—Ç–µ–ª–∏ –∞–ª–≥–æ—Ä–∏—Ç–º–∞ NeighborNet [–æ–±—ä—è—Å–Ω—è—é—Ç](https://www.taylorfrancis.com/chapters/edit/10.4324/9781315418612-6/untangling-past-bryant-david-filimon-flavia-gray-russell), –∫–∞–∫ –ø—Ä–∞–≤–∏–ª—å–Ω–æ –∏–Ω—Ç–µ—Ä–ø—Ä–µ—Ç–∏—Ä–æ–≤–∞—Ç—å –ø–æ–¥–æ–±–Ω—ã–π –≥—Ä–∞—Ñ –Ω–∞ –ø—Ä–∏–º–µ—Ä–µ –¥–µ—Ä–µ–≤–∞ –≥–µ—Ä–º–∞–Ω—Å–∫–∏—Ö —è–∑—ã–∫–æ–≤.  

![](./images/cons3.jpg)

–ö–æ–Ω—Ñ–ª–∏–∫—Ç—É—é—â–∏–µ —Å–∏–≥–Ω–∞–ª—ã –ø–µ—Ä–µ–¥–∞—é—Ç—Å—è –∑–∞ —Å—á–µ—Ç ‚Äú—Ä–µ—Ç–∏–∫—É–ª—è—Ä–Ω–æ–π —Å—Ç—Ä—É–∫—Ç—É—Ä—ã‚Äù (–∫–≤–∞–¥—Ä–∞—Ç–∏–∫–æ–≤, –ø—Ä–æ—â–µ –≥–æ–≤–æ—Ä—è). –¢–∞–º, –≥–¥–µ –∫–æ–Ω—Ñ–ª–∏–∫—Ç–∞ –Ω–µ—Ç, –º—ã –≤–∏–¥–∏–º –¥–µ—Ä–µ–≤–æ.

–ö–∞–∂–¥—ã–π —Å–ø–ª–∏—Ç –ø—Ä–µ–¥—Å—Ç–∞–≤–ª–µ–Ω –Ω–µ—Å–∫–æ–ª—å–∫–∏–º–∏ –ø–∞—Ä–∞–ª–ª–µ–ª—å–Ω—ã–º–∏ –ª–∏–Ω–∏—è–º–∏, –∏ –µ—Å–ª–∏ —ç—Ç–∏ –ø–∞—Ä–∞–ª–ª–µ–ª–∏ —É–¥–∞–ª–∏—Ç—å, —Ç–æ –≥—Ä–∞—Ñ —Ä–∞—Å–ø–∞–¥–µ—Ç—Å—è –Ω–∞ –¥–≤–∞. –ß–µ–º –¥–ª–∏–Ω–Ω–µ–µ —Ä–µ–±—Ä–æ, —Ç–µ–º ‚Äú–≤–µ—Å–æ–º–µ–µ‚Äù —Å–ø–ª–∏—Ç. 

–ù–∞ –≥—Ä–∞—Ñ–µ –≤–∏–¥–Ω–æ, —á—Ç–æ –∫—Ä–µ–æ–ª—å—Å–∫–∏–π —è–∑—ã–∫ —Å—Ä–∞–Ω–∞–Ω-—Ç–æ–Ω–≥–æ –æ–±–ª–∞–¥–∞–µ—Ç —Å—Ö–æ–¥—Å—Ç–≤–æ–º –∏ —Å –∞–Ω–≥–ª–∏–π—Å–∫–∏–º, –∏ —Å –Ω–∏–¥–µ—Ä–ª–∞–Ω–¥—Å–∫–∏–º (–≥—Ä–∞—Ñ –º–æ–∂–Ω–æ —Ä–∞–∑—Ä–µ–∑–∞—Ç—å –ø–æ –∑–µ–ª–µ–Ω—ã–º –ª–∏–Ω–∏—è–º –¥–≤–æ—è–∫–æ). 

–ë–æ–ª–µ–µ —Å–ª–∞–±—ã–π –∫–æ–Ω—Ñ–ª–∏–∫—Ç—É—é—â–∏–π —Å–∏–≥–Ω–∞–ª –ø—Ä–æ—Å–ª–µ–∂–∏–≤–∞–µ—Ç—Å—è –º–µ–∂–¥—É –Ω–µ–º–µ—Ü–∫–∏–º, –Ω–∏–¥–µ—Ä–ª–∞–Ω–¥—Å–∫–∏–º –∏ —Ñ–ª–∞–º–∞–Ω–¥—Å–∫–∏–º, —Å –æ–¥–Ω–æ–π —Å—Ç–æ—Ä–æ–Ω—ã, –∏ –ø–µ–Ω—Å–∏–ª—å–≤–∞–Ω—Å–∫–∏–º –Ω–µ–º–µ—Ü–∫–∏–º, —Å –¥—Ä—É–≥–æ–π (—Å–∏–Ω–∏–π —Ä–∞–∑—Ä–µ–∑). 

–†–∞—Å—Å–º–æ—Ç—Ä–µ–Ω–Ω—ã–µ —Ñ–∏–ª–æ–≥–µ–Ω–µ—Ç–∏—á–µ—Å–∫–∏–µ –º–µ—Ç–æ–¥—ã (–∫–æ–Ω—Å–µ–Ω—Å—É—Å–Ω—ã–µ —Å–µ—Ç–∏, –∫–æ–Ω—Å–µ–Ω—Å—É—Å–Ω—ã–µ –¥–µ—Ä–µ–≤—å—è –∏ neighborNet) –Ω–∏—á–µ–≥–æ –Ω–µ –≥–æ–≤–æ—Ä—è—Ç –æ –ø—Ä–æ–∏—Å—Ö–æ–∂–¥–µ–Ω–∏–∏ –æ–¥–Ω–æ–≥–æ —Ç–µ–∫—Å—Ç–∞ –æ—Ç –¥—Ä—É–≥–æ–≥–æ. –§–∏–ª–æ–≥—Ä–∞–º–º–∞, –ø–æ–ª—É—á–µ–Ω–Ω–∞—è –¥–∏—Å—Ç–∞–Ω—Ü–∏–æ–Ω–Ω—ã–º–∏ –º–µ—Ç–æ–¥–∞–º–∏, –Ω–µ –æ—Ç—Ä–∞–∂–∞–µ—Ç —ç–≤–æ–ª—é—Ü–∏–æ–Ω–Ω—ã–π –ø—Ä–æ—Ü–µ—Å—Å, –∞ –ø–æ–∫–∞–∑—ã–≤–∞–µ—Ç [—Å—Ç–µ–ø–µ–Ω—å –¥–∏–≤–µ—Ä–≥–µ–Ω—Ü–∏–∏ —Ç–∞–∫—Å–æ–Ω–æ–≤]( http://herbarium.tsu.ru/presentation/lection_5.pdf ).

–≠—Ç–æ –∑–Ω–∞—á–∏—Ç, —á—Ç–æ –º–æ–¥–µ–ª—å NeighborNet –Ω–µ –¥–µ–ª–∞–µ—Ç –Ω–∏–∫–∞–∫–∏—Ö –¥–æ–ø—É—â–µ–Ω–∏–π –æ –ø—Ä–æ–∏—Å—Ö–æ–∂–¥–µ–Ω–∏–∏, –æ–¥–Ω–∞–∫–æ –≤ –∫–∞–∫–æ–º-—Ç–æ —Å–º—ã—Å–ª–µ –æ–Ω–∞ –≤–ø–æ–ª–Ω–µ —Å–ø–æ—Å–æ–±–Ω–∞ –ø–æ–∫–∞–∑—ã–≤–∞—Ç—å —Ç–æ, —á—Ç–æ –Ω–∞–∑—ã–≤–∞—é—Ç ¬´–∫–æ–Ω—Ñ–ª–∏–∫—Ç—É—é—â–∏–º–∏ —Å–∏–≥–Ω–∞–ª–∞–º–∏¬ª. –í –±–∏–æ–ª–æ–≥–∏–∏ —ç—Ç–æ —Ä–µ–∫–æ–º–±–∏–Ω–∞—Ü–∏—è, –≥–∏–±—Ä–∏–¥–∏–∑–∞—Ü–∏—è –∏ —Ç.–ø., –∞ –≤ –≥—É–º–∞–Ω–∏—Ç–∞—Ä–Ω—ã—Ö –Ω–∞—É–∫–∞—Ö ‚Äî –∂–∞–Ω—Ä–æ–≤—ã–µ –∏ –¥–∏–∞–ª–µ–∫—Ç–Ω—ã–µ –æ—Å–æ–±–µ–Ω–Ω–æ—Å—Ç–∏, –æ—Ç–Ω–æ—à–µ–Ω–∏—è –ø–æ–¥—Ä–∞–∂–∞–Ω–∏—è, –∑–∞–∏–º—Å—Ç–≤–æ–≤–∞–Ω–∏—è –∏ –≤—Å–µ —Ç–æ, —á—Ç–æ —Å–ø–æ—Å–æ–±–Ω–æ –≤–ª–∏—è—Ç—å –Ω–∞ —Ä–µ–∑—É–ª—å—Ç–∞—Ç –∫–ª–∞—Å—Å–∏—Ñ–∏–∫–∞—Ü–∏–∏ —Ç–µ–∫—Å—Ç–æ–≤, –ø–æ–º–∏–º–æ –∞–≤—Ç–æ—Ä—Å—Ç–≤–∞. 

## –°–µ—Ç–µ–≤–æ–π –∞–Ω–∞–ª–∏–∑ –≤ `stylo`

–ü–∞–∫–µ—Ç `stylo` [–Ω–µ —Å–æ–∑–¥–∞–µ—Ç](https://github.com/computationalstylistics/stylo_howto/blob/master/stylo_howto.pdf) —Å–µ—Ç–µ–π –∫–∞–∫ —Ç–∞–∫–æ–≤—ã—Ö, –æ–¥–Ω–∞–∫–æ –æ–Ω –≥–µ–Ω–µ—Ä–∏—Ä—É–µ—Ç —Ç–∞–±–ª–∏—Ü—ã —Ä–µ–±–µ—Ä/—É–∑–ª–æ–≤ (–∏–ª–∏ —Ç–æ–ª—å–∫–æ —Ä–µ–±–µ—Ä), –∏—Å–ø–æ–ª—å–∑—É—è –¥–≤–∞ –∞–ª–≥–æ—Ä–∏—Ç–º–∞ –≠–¥–µ—Ä–∞ –¥–ª—è —É—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω–∏—è —Å–≤—è–∑–µ–π –º–µ–∂–¥—É —É–∑–ª–∞–º–∏. –¢–∞–±–ª–∏—Ü—É –º–æ–∂–Ω–æ –∑–∞–≥—Ä—É–∑–∏—Ç—å –≤ Gephi (<https://gephi.org>) –∏–ª–∏ –ø—Ä–æ—á–∏—Ç–∞—Ç—å –≤ R (—á—Ç–æ –º—ã —Å–¥–µ–ª–∞–µ–º –¥–∞–ª—å—à–µ). –ß—Ç–æ–±—ã –ø–æ–ª—É—á–∏—Ç—å —Ç–∞–∫—É—é —Ç–∞–±–ª–∏—Ü—É, –≤—ã–∑–æ–≤–∏—Ç–µ —Ñ—É–Ω–∫—Ü–∏—é `stylo()` —Å –∞—Ä–≥—É–º–µ–Ω—Ç–æ–º `network=TRUE` –∏, –ø–æ –∂–µ–ª–∞–Ω–∏—é, —Å –Ω–µ–∫–æ—Ç–æ—Ä—ã–º–∏ –¥—Ä—É–≥–∏–º–∏ –∞—Ä–≥—É–º–µ–Ω—Ç–∞–º–∏. 

```{r eval=FALSE}
stylo(network = TRUE, 
      frequencies = galbraith, 
      network.type="undirected",
      network.tables="both",
      linked.neighbors=3,
      edge.weights="linear",
      gui=FALSE)
```

–¢–µ–ø–µ—Ä—å –≤ —Ä–∞–±–æ—á–µ–π –¥–∏—Ä–µ–∫—Ç–æ—Ä–∏–∏ –¥–æ–ª–∂–Ω—ã –±—ã–ª–∏ –ø–æ—è–≤–∏—Ç—å—Å—è –¥–≤–∞ —Ñ–∞–π–ª–∞ `.csv`.

```{r}
my_csv <- list.files(pattern = "csv")
my_csv
```
```{r message=FALSE}
galbraith_edges <- read_csv(my_csv[1])
galbraith_edges

galbraith_nodes <- read_csv(my_csv[2])
galbraith_nodes
```

–°–æ–µ–¥–∏–Ω–∏–º –¥–≤–µ —Ç–∞–±–ª–∏—Ü—ã. 

```{r message=FALSE}
net_data <- galbraith_edges |> 
  left_join(galbraith_nodes, 
            by = join_by(Source == Id)) |> 
  select(-Source) |> 
  rename(Source = Label) |> 
  relocate(Source, .before = Target) |> 
  left_join(galbraith_nodes, 
            by = join_by(Target == Id)) |> 
  select(-Target) |> 
  rename(Target = Label) |> 
  relocate(Target, .after = Source) |> 
  select(Source, Target, Weight)

net_data
```

```{r message=FALSE}
library(igraph)

galbraith_graph <- graph_from_data_frame(net_data, directed = FALSE)
galbraith_graph
```

```{r message=FALSE}
library(ggraph)

# –Ω–æ—Ä–º–∞–ª–∏–∑–∞—Ü–∏—è –≤–µ—Å–æ–≤
weights <- (E(galbraith_graph)$Weight - min(E(galbraith_graph)$Weight)) / (max(E(galbraith_graph)$Weight) - min(E(galbraith_graph)$Weight))
E(galbraith_graph)$Weight <- weights


# —Ü–≤–µ—Ç–∞ 
labels = str_remove(V(galbraith_graph)$name, "_.+$")
V(galbraith_graph)$label <- labels

# –≥—Ä–∞—Ñ
ggraph(galbraith_graph, layout = "kk") +
  geom_edge_link(aes(alpha = Weight), 
                 linewidth = 1.2,
                 show.legend = FALSE, 
                 color = "wheat3") +
  geom_node_point(aes(color = label),
                  size = 3, shape = 21, 
                  fill = "white", 
                  show.legend = FALSE) +
  geom_node_label(aes(label = name, color = label), 
                 vjust = -1, cex = 2,
                 show.legend = FALSE) +
  labs(x = NULL, y = NULL) + 
  theme_void()
```
–£ –Ω–∞—Å –ø–æ–ª—É—á–∏–ª–∏—Å—å —Ç—Ä–∏ –Ω–µ —Å–≤—è–∑–∞–Ω–Ω—ã–µ –º–µ–∂–¥—É —Å–æ–±–æ–π –ø–æ–¥—Å–µ—Ç–∏. –û —Ç–æ–º, –∫–∞–∫ —Ä–∞–±–æ—Ç–∞—Ç—å —Å —Ç–∞–∫–æ–≥–æ —Ä–æ–¥–∞ –æ–±—ä–µ–∫—Ç–∞–º–∏ –≤ R, –∏ –∫–∞–∫ –∏—Ö –∏–Ω—Ç–µ—Ä–ø—Ä–µ—Ç–∏—Ä–æ–≤–∞—Ç—å, –º—ã –ø–æ–≥–æ–≤–æ—Ä–∏–º —É–∂–µ –≤ —Å–ª–µ–¥—É—é—â–∏–π —Ä–∞–∑ `r emo::ji("wizard")`.
