<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="ru" xml:lang="ru"><head>

<meta charset="utf-8">
<meta name="generator" content="quarto-1.5.57">

<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes">


<title>24&nbsp; Бинарная классификация – Компьютерный анализ текста</title>
<style>
code{white-space: pre-wrap;}
span.smallcaps{font-variant: small-caps;}
div.columns{display: flex; gap: min(4vw, 1.5em);}
div.column{flex: auto; overflow-x: auto;}
div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
ul.task-list{list-style: none;}
ul.task-list li input[type="checkbox"] {
  width: 0.8em;
  margin: 0 0.8em 0.2em -1em; /* quarto-specific, see https://github.com/quarto-dev/quarto-cli/issues/4556 */ 
  vertical-align: middle;
}
/* CSS for syntax highlighting */
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
div.sourceCode { margin: 1em 0; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { display: inline-block; text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
  }
pre.numberSource { margin-left: 3em;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
</style>


<script src="site_libs/quarto-nav/quarto-nav.js"></script>
<script src="site_libs/quarto-nav/headroom.min.js"></script>
<script src="site_libs/clipboard/clipboard.min.js"></script>
<script src="site_libs/quarto-search/autocomplete.umd.js"></script>
<script src="site_libs/quarto-search/fuse.min.js"></script>
<script src="site_libs/quarto-search/quarto-search.js"></script>
<meta name="quarto:offset" content="./">
<link href="./multiclass.html" rel="next">
<link href="./multivar.html" rel="prev">
<script src="site_libs/quarto-html/quarto.js"></script>
<script src="site_libs/quarto-html/popper.min.js"></script>
<script src="site_libs/quarto-html/tippy.umd.min.js"></script>
<script src="site_libs/quarto-html/anchor.min.js"></script>
<link href="site_libs/quarto-html/tippy.css" rel="stylesheet">
<link href="site_libs/quarto-html/quarto-syntax-highlighting.css" rel="stylesheet" id="quarto-text-highlighting-styles">
<script src="site_libs/bootstrap/bootstrap.min.js"></script>
<link href="site_libs/bootstrap/bootstrap-icons.css" rel="stylesheet">
<link href="site_libs/bootstrap/bootstrap.min.css" rel="stylesheet" id="quarto-bootstrap" data-mode="light">
<script id="quarto-search-options" type="application/json">{
  "location": "sidebar",
  "copy-button": false,
  "collapse-after": 3,
  "panel-placement": "start",
  "type": "textbox",
  "limit": 50,
  "keyboard-shortcut": [
    "f",
    "/",
    "s"
  ],
  "show-item-context": false,
  "language": {
    "search-no-results-text": "Поиск не дал результатов",
    "search-matching-documents-text": "Результаты поиска",
    "search-copy-link-title": "Скопировать ссылку",
    "search-hide-matches-text": "Скрыть дополнительные результаты",
    "search-more-match-text": "дополнительный результат в этом документе",
    "search-more-matches-text": "дополнительных результата(-ов) в этом документе",
    "search-clear-button-title": "Очистить",
    "search-text-placeholder": "",
    "search-detached-cancel-button-title": "Отменить",
    "search-submit-button-title": "Найти",
    "search-label": "Поиск"
  }
}</script>
<link href="site_libs/pagedtable-1.1/css/pagedtable.css" rel="stylesheet">
<script src="site_libs/pagedtable-1.1/js/pagedtable.js"></script>

  <script src="https://cdnjs.cloudflare.com/polyfill/v3/polyfill.min.js?features=es6"></script>
  <script src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-chtml-full.js" type="text/javascript"></script>

<script type="text/javascript">
const typesetMath = (el) => {
  if (window.MathJax) {
    // MathJax Typeset
    window.MathJax.typeset([el]);
  } else if (window.katex) {
    // KaTeX Render
    var mathElements = el.getElementsByClassName("math");
    var macros = [];
    for (var i = 0; i < mathElements.length; i++) {
      var texText = mathElements[i].firstChild;
      if (mathElements[i].tagName == "SPAN") {
        window.katex.render(texText.data, mathElements[i], {
          displayMode: mathElements[i].classList.contains('display'),
          throwOnError: false,
          macros: macros,
          fleqn: false
        });
      }
    }
  }
}
window.Quarto = {
  typesetMath
};
</script>

<link rel="stylesheet" href="include/webex.css">
</head>

<body class="nav-sidebar floating">

<div id="quarto-search-results"></div>
  <header id="quarto-header" class="headroom fixed-top">
  <nav class="quarto-secondary-nav">
    <div class="container-fluid d-flex">
      <button type="button" class="quarto-btn-toggle btn" data-bs-toggle="collapse" role="button" data-bs-target=".quarto-sidebar-collapse-item" aria-controls="quarto-sidebar" aria-expanded="false" aria-label="Переключить боковую панель навигации" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">
        <i class="bi bi-layout-text-sidebar-reverse"></i>
      </button>
        <nav class="quarto-page-breadcrumbs" aria-label="breadcrumb"><ol class="breadcrumb"><li class="breadcrumb-item"><a href="./classification.html"><span class="chapter-number">24</span>&nbsp; <span class="chapter-title">Бинарная классификация</span></a></li></ol></nav>
        <a class="flex-grow-1" role="navigation" data-bs-toggle="collapse" data-bs-target=".quarto-sidebar-collapse-item" aria-controls="quarto-sidebar" aria-expanded="false" aria-label="Переключить боковую панель навигации" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">      
        </a>
      <button type="button" class="btn quarto-search-button" aria-label="Поиск" onclick="window.quartoOpenSearch();">
        <i class="bi bi-search"></i>
      </button>
    </div>
  </nav>
</header>
<!-- content -->
<div id="quarto-content" class="quarto-container page-columns page-rows-contents page-layout-article">
<!-- sidebar -->
  <nav id="quarto-sidebar" class="sidebar collapse collapse-horizontal quarto-sidebar-collapse-item sidebar-navigation floating overflow-auto">
    <div class="pt-lg-2 mt-2 text-left sidebar-header">
    <div class="sidebar-title mb-0 py-0">
      <a href="./">Компьютерный анализ текста</a> 
    </div>
      </div>
        <div class="mt-2 flex-shrink-0 align-items-center">
        <div class="sidebar-search">
        <div id="quarto-search" class="" title="Поиск"></div>
        </div>
        </div>
    <div class="sidebar-menu-container"> 
    <ul class="list-unstyled mt-1">
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./index.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Введение</span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./start.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">1</span>&nbsp; <span class="chapter-title">Начало работы</span></span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./tabular.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">2</span>&nbsp; <span class="chapter-title">Таблицы</span></span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./plot.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">3</span>&nbsp; <span class="chapter-title">Визуализации</span></span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./iterate.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">4</span>&nbsp; <span class="chapter-title">Циклы, условия, функции</span></span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./import.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">5</span>&nbsp; <span class="chapter-title">Импорт: JSON &amp; XML</span></span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./share.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">6</span>&nbsp; <span class="chapter-title">Публикационная система Quarto</span></span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./regex.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">7</span>&nbsp; <span class="chapter-title">Регулярные выражения</span></span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./scrape.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">8</span>&nbsp; <span class="chapter-title">Веб-скрапинг</span></span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./tokenize.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">9</span>&nbsp; <span class="chapter-title">Токенизация, лемматизация, POS-тэггинг и синтаксический анализ</span></span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./count.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">10</span>&nbsp; <span class="chapter-title">Распределения слов и анализ частотностей</span></span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./sentiment.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">11</span>&nbsp; <span class="chapter-title">Эмоциональная тональность</span></span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./lsa.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">12</span>&nbsp; <span class="chapter-title">Латентно-семантический анализ</span></span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./pmi.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">13</span>&nbsp; <span class="chapter-title">Векторные представления слов на основе PMI. Word2Vec.</span></span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./lda.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">14</span>&nbsp; <span class="chapter-title">Тематическое моделирование c LDA</span></span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./cluster.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">15</span>&nbsp; <span class="chapter-title">Кластеризация и метод главных компонент</span></span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./stylo.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">16</span>&nbsp; <span class="chapter-title">Стилометрический анализ с пакетом <code>stylo</code></span></span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./consensus.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">17</span>&nbsp; <span class="chapter-title">Консенсусные деревья и сети</span></span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./igraph.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">18</span>&nbsp; <span class="chapter-title">Сетевые данные в <code>igraph</code></span></span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./ggraph.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">19</span>&nbsp; <span class="chapter-title">Графический дизайн сетей в <code>ggraph</code></span></span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./dracor.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">20</span>&nbsp; <span class="chapter-title">Анализ сетей и обнаружение сообществ</span></span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./maps.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">21</span>&nbsp; <span class="chapter-title">Пространственные данные в R</span></span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./regression.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">22</span>&nbsp; <span class="chapter-title">Регрессионный анализ</span></span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./multivar.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">23</span>&nbsp; <span class="chapter-title">Регрессионные модели с <code>tidymodels</code></span></span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./classification.html" class="sidebar-item-text sidebar-link active">
 <span class="menu-text"><span class="chapter-number">24</span>&nbsp; <span class="chapter-title">Бинарная классификация</span></span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./multiclass.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">25</span>&nbsp; <span class="chapter-title">Многоклассовая классификация</span></span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./llm.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">26</span>&nbsp; <span class="chapter-title">Работа с LLM</span></span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./references.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Литература</span></a>
  </div>
</li>
    </ul>
    </div>
</nav>
<div id="quarto-sidebar-glass" class="quarto-sidebar-collapse-item" data-bs-toggle="collapse" data-bs-target=".quarto-sidebar-collapse-item"></div>
<!-- margin-sidebar -->
    <div id="quarto-margin-sidebar" class="sidebar margin-sidebar">
        <nav id="TOC" role="doc-toc" class="toc-active">
    <h2 id="toc-title">Содержание</h2>
   
  <ul>
  <li><a href="#записки-федералиста" id="toc-записки-федералиста" class="nav-link active" data-scroll-target="#записки-федералиста"><span class="header-section-number">24.1</span> Записки “Федералиста”</a></li>
  <li><a href="#подготовка-данных" id="toc-подготовка-данных" class="nav-link" data-scroll-target="#подготовка-данных"><span class="header-section-number">24.2</span> Подготовка данных</a></li>
  <li><a href="#линейно-дискриминантный-анализ" id="toc-линейно-дискриминантный-анализ" class="nav-link" data-scroll-target="#линейно-дискриминантный-анализ"><span class="header-section-number">24.3</span> Линейно-дискриминантный анализ</a>
  <ul class="collapse">
  <li><a href="#препроцессор-и-модель" id="toc-препроцессор-и-модель" class="nav-link" data-scroll-target="#препроцессор-и-модель"><span class="header-section-number">24.3.1</span> Препроцессор и модель</a></li>
  <li><a href="#выбор-гиперпараметров" id="toc-выбор-гиперпараметров" class="nav-link" data-scroll-target="#выбор-гиперпараметров"><span class="header-section-number">24.3.2</span> Выбор гиперпараметров</a></li>
  <li><a href="#оценка-модели-f-score" id="toc-оценка-модели-f-score" class="nav-link" data-scroll-target="#оценка-модели-f-score"><span class="header-section-number">24.3.3</span> Оценка модели: F-score</a></li>
  <li><a href="#roc-кривая" id="toc-roc-кривая" class="nav-link" data-scroll-target="#roc-кривая"><span class="header-section-number">24.3.4</span> ROC-кривая</a></li>
  <li><a href="#матрица-смешения" id="toc-матрица-смешения" class="nav-link" data-scroll-target="#матрица-смешения"><span class="header-section-number">24.3.5</span> Матрица смешения</a></li>
  <li><a href="#окончательная-настройка-модели" id="toc-окончательная-настройка-модели" class="nav-link" data-scroll-target="#окончательная-настройка-модели"><span class="header-section-number">24.3.6</span> Окончательная настройка модели</a></li>
  <li><a href="#тестовая-выборка" id="toc-тестовая-выборка" class="nav-link" data-scroll-target="#тестовая-выборка"><span class="header-section-number">24.3.7</span> Тестовая выборка</a></li>
  <li><a href="#классификация-спорных-эссе" id="toc-классификация-спорных-эссе" class="nav-link" data-scroll-target="#классификация-спорных-эссе"><span class="header-section-number">24.3.8</span> Классификация спорных эссе</a></li>
  </ul></li>
  <li><a href="#наивный-байес" id="toc-наивный-байес" class="nav-link" data-scroll-target="#наивный-байес"><span class="header-section-number">24.4</span> Наивный Байес</a>
  <ul class="collapse">
  <li><a href="#теорема-байеса" id="toc-теорема-байеса" class="nav-link" data-scroll-target="#теорема-байеса"><span class="header-section-number">24.4.1</span> Теорема Байеса</a></li>
  <li><a href="#применение-теоремы-в-мо" id="toc-применение-теоремы-в-мо" class="nav-link" data-scroll-target="#применение-теоремы-в-мо"><span class="header-section-number">24.4.2</span> Применение теоремы в МО</a></li>
  <li><a href="#препроцессор-и-модель-1" id="toc-препроцессор-и-модель-1" class="nav-link" data-scroll-target="#препроцессор-и-модель-1"><span class="header-section-number">24.4.3</span> Препроцессор и модель</a></li>
  <li><a href="#выбор-гиперпараметров-1" id="toc-выбор-гиперпараметров-1" class="nav-link" data-scroll-target="#выбор-гиперпараметров-1"><span class="header-section-number">24.4.4</span> Выбор гиперпараметров</a></li>
  <li><a href="#матрица-смешения-1" id="toc-матрица-смешения-1" class="nav-link" data-scroll-target="#матрица-смешения-1"><span class="header-section-number">24.4.5</span> Матрица смешения</a></li>
  <li><a href="#roc-кривая-1" id="toc-roc-кривая-1" class="nav-link" data-scroll-target="#roc-кривая-1"><span class="header-section-number">24.4.6</span> ROC-кривая</a></li>
  </ul></li>
  </ul>
</nav>
    </div>
<!-- main -->
<main class="content" id="quarto-document-content">

<header id="title-block-header" class="quarto-title-block default">
<div class="quarto-title">
<h1 class="title"><span class="chapter-number">24</span>&nbsp; <span class="chapter-title">Бинарная классификация</span></h1>
</div>



<div class="quarto-title-meta">

    
  
    
  </div>
  


</header>


<p>В предыдущих двух уроках мы познакомились с регрессией, а в этом поговорим о классификации. Алгоритмов классификации в МО великое множество, в этом уроке мы рассмотрим два из них: линейно-дискриминантный анализ и наивный Байес, а также научимся подбирать гиперпараметры модели.</p>
<section id="записки-федералиста" class="level2" data-number="24.1">
<h2 data-number="24.1" class="anchored" data-anchor-id="записки-федералиста"><span class="header-section-number">24.1</span> Записки “Федералиста”</h2>
<p>В 1963 году два американских статистика, Фредерик Мостеллер и Дэвид Уоллес, опубликовали статью «<a href="https://www.jstor.org/stable/2283270">Inference in an Authorship Problem</a>», в которой они успешно разрешили вопрос о том, кто написал 12 спорных памфлетов из «Записок федералиста» — сборника статей в поддержку утверждения Конституции США (кон. XVIII в.).</p>
<p>Кандидатами в авторы 12 спорных памфлетов были Джеймс Мэдисон (четвертый президент США) и Александр Гамильтон (соратник Джорджа Вашингтона, основоположник американской экономической системы). Гамильтон и Мэдисон писали в схожей ораторской манере, и в некоторых отношениях были практически стилистическими «близнецами». Однако статистикам удалось найти способ их различить.</p>
<div>

</div>
<div class="quarto-layout-panel" data-layout-ncol="2">
<div class="quarto-layout-row">
<div class="quarto-layout-cell" style="flex-basis: 50.0%;justify-content: flex-start;">
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="./images/Hamilton.jpg" class="img-fluid figure-img"></p>
<figcaption>Александр Гамильтон</figcaption>
</figure>
</div>
</div>
<div class="quarto-layout-cell" style="flex-basis: 50.0%;justify-content: flex-start;">
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="./images/Madison.jpg" class="img-fluid figure-img" style="width:98.0%"></p>
<figcaption>Джеймс Мэдисон</figcaption>
</figure>
</div>
</div>
</div>
</div>
<p>В распоряжении статистиков были методы традиционной фишеровской статистики (дискриминантный анализ, предложенный в 1936 г.), но они впервые решили дополнить его байесовскими методами, что можно считать рождением алгоритма, известного сегодня в МО под именем Наивный Байес. Кроме того, Мостеллер и Уоллес впервые показали, что для решения вопроса об авторстве важны наиболее частотные слова, употребление которых человек почти не контролирует. Впоследствии это наблюдение легло в основу метода, предложенного Берроузом.</p>
</section>
<section id="подготовка-данных" class="level2" data-number="24.2">
<h2 data-number="24.2" class="anchored" data-anchor-id="подготовка-данных"><span class="header-section-number">24.2</span> Подготовка данных</h2>
<div class="cell">
<div class="sourceCode cell-code" id="cb1"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb1-1"><a href="#cb1-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(tidyverse)</span>
<span id="cb1-2"><a href="#cb1-2" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(tidymodels)</span>
<span id="cb1-3"><a href="#cb1-3" aria-hidden="true" tabindex="-1"></a>conflicted<span class="sc">::</span><span class="fu">conflict_prefer</span>(<span class="st">"filter"</span>, <span class="at">winner =</span> <span class="st">"dplyr"</span>)</span>
<span id="cb1-4"><a href="#cb1-4" aria-hidden="true" tabindex="-1"></a>conflicted<span class="sc">::</span><span class="fu">conflict_prefer</span>(<span class="st">"select"</span>, <span class="at">winner =</span> <span class="st">"MASS"</span>)</span>
<span id="cb1-5"><a href="#cb1-5" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(discrim)</span></code><button title="Скопировать текст" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>По <a href="https://github.com/locusclassicus/text_analysis_2024/blob/main/files/fedPapers85.csv">ссылке</a> скачайте датасет с частотностью слов в записках ( <a href="https://www.kaggle.com/datasets/tobyanderson/federalist-papers">источник</a>). Из него мы удалим три текста предположительного двойного авторства и пять эссе Джона Джея.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb2"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb2-1"><a href="#cb2-1" aria-hidden="true" tabindex="-1"></a>fed <span class="ot">&lt;-</span> <span class="fu">read_csv</span>(<span class="st">"../files/fedPapers85.csv"</span>) <span class="sc">|&gt;</span> </span>
<span id="cb2-2"><a href="#cb2-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(<span class="sc">!</span>author <span class="sc">%in%</span>  <span class="fu">c</span>(<span class="st">"HM"</span>, <span class="st">"Jay"</span>)) </span>
<span id="cb2-3"><a href="#cb2-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb2-4"><a href="#cb2-4" aria-hidden="true" tabindex="-1"></a><span class="co"># небольшой ремонт</span></span>
<span id="cb2-5"><a href="#cb2-5" aria-hidden="true" tabindex="-1"></a><span class="fu">colnames</span>(fed) <span class="ot">&lt;-</span> <span class="fu">make.names</span>(<span class="fu">colnames</span>(fed))</span></code><button title="Скопировать текст" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>Отложим спорные эссе.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb3"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb3-1"><a href="#cb3-1" aria-hidden="true" tabindex="-1"></a>dispt <span class="ot">&lt;-</span> fed <span class="sc">|&gt;</span> </span>
<span id="cb3-2"><a href="#cb3-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(author <span class="sc">==</span> <span class="st">"dispt"</span>) </span>
<span id="cb3-3"><a href="#cb3-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb3-4"><a href="#cb3-4" aria-hidden="true" tabindex="-1"></a>essays <span class="ot">&lt;-</span> fed <span class="sc">|&gt;</span> </span>
<span id="cb3-5"><a href="#cb3-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(author <span class="sc">!=</span> <span class="st">"dispt"</span>) <span class="sc">|&gt;</span> </span>
<span id="cb3-6"><a href="#cb3-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">author =</span> <span class="fu">as.factor</span>(author)) <span class="sc">|&gt;</span> </span>
<span id="cb3-7"><a href="#cb3-7" aria-hidden="true" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">select</span>(<span class="sc">-</span>filename)</span></code><button title="Скопировать текст" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>Разобьем оставшиеся наблюдения на обучающую и проверочную выборки.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb4"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb4-1"><a href="#cb4-1" aria-hidden="true" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">03022025</span>)</span>
<span id="cb4-2"><a href="#cb4-2" aria-hidden="true" tabindex="-1"></a>data_split <span class="ot">&lt;-</span> essays <span class="sc">|&gt;</span> </span>
<span id="cb4-3"><a href="#cb4-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">initial_split</span>(<span class="fl">0.8</span>, <span class="at">strata =</span> author)</span>
<span id="cb4-4"><a href="#cb4-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb4-5"><a href="#cb4-5" aria-hidden="true" tabindex="-1"></a>data_train <span class="ot">&lt;-</span> <span class="fu">training</span>(data_split)</span>
<span id="cb4-6"><a href="#cb4-6" aria-hidden="true" tabindex="-1"></a>data_test <span class="ot">&lt;-</span> <span class="fu">testing</span>(data_split)</span></code><button title="Скопировать текст" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>Разобьем обучающие данные группы для перекрестной проверки.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb5"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb5-1"><a href="#cb5-1" aria-hidden="true" tabindex="-1"></a>folds <span class="ot">&lt;-</span> <span class="fu">vfold_cv</span>(data_train, <span class="at">strata =</span> author, <span class="at">v =</span> <span class="dv">10</span>)</span>
<span id="cb5-2"><a href="#cb5-2" aria-hidden="true" tabindex="-1"></a>folds</span></code><button title="Скопировать текст" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div data-pagedtable="false">
  <script data-pagedtable-source="" type="application/json">
{"columns":[{"label":["splits"],"name":[1],"type":["list"],"align":["right"]},{"label":["id"],"name":[2],"type":["chr"],"align":["left"]}],"data":[{"1":"<S3: vfold_split>","2":"Fold01"},{"1":"<S3: vfold_split>","2":"Fold02"},{"1":"<S3: vfold_split>","2":"Fold03"},{"1":"<S3: vfold_split>","2":"Fold04"},{"1":"<S3: vfold_split>","2":"Fold05"},{"1":"<S3: vfold_split>","2":"Fold06"},{"1":"<S3: vfold_split>","2":"Fold07"},{"1":"<S3: vfold_split>","2":"Fold08"},{"1":"<S3: vfold_split>","2":"Fold09"},{"1":"<S3: vfold_split>","2":"Fold10"}],"options":{"columns":{"min":{},"max":[10]},"rows":{"min":[10],"max":[10]},"pages":{}}}
  </script>
</div>
</div>
</div>
</section>
<section id="линейно-дискриминантный-анализ" class="level2" data-number="24.3">
<h2 data-number="24.3" class="anchored" data-anchor-id="линейно-дискриминантный-анализ"><span class="header-section-number">24.3</span> Линейно-дискриминантный анализ</h2>
<p><em>Дискриминантный анализ</em> позволяет классифицировать объекты по двум или более группам, основываясь на линейной комбинации переменных, которая называется <em>дискриминантной функцией</em>, например:</p>
<p><span class="math display">\[DF = -0.5\times var_1 + 1.2\times var_2 + 0.85\times var_3\]</span></p>
<p>Дискриминантная функция максимизирует различия между группами и минимизует дисперсию внутри группы по формуле:</p>
<p><span class="math display">\[\frac{(\bar{x_1}-\bar{x_2})^2}{s^2_1+s^2_2}\]</span>.</p>
<p>Подробнее об этом можно посмотреть <a href="https://youtu.be/azXCzI57Yfc?si=TOcIrHoUWejCuXRw">видео</a>.</p>
<p>Мы будем использовать регуляризованный LDA. Он применяется в тех случаях, когда число признаков (features) в данных превышает число наблюдений, а также когда в наборе данных присутствует сильная мультиколлинеарность между признаками.</p>
<p>Дело в том, что для построения дискриминантных функций используется матрица, обратная для матрицы ковариации. Если столбцы (признаки) исходной матрицы линейно зависимы, то она является вырожденной (то есть ее определитель равен 0). Следовательно, матрица ковариации, вычисленная на основе этих данных, также будет вырожденной. Для такой матрицы нельзя вычислить обратную, и алгоритм не может построить оптимальные дискриминантные функции. Чтобы этого избежать, применяют регуляризацию.</p>
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="https://habrastorage.org/webt/fa/qu/n4/faqun44h9hds_ucuwyxacjccse8.png" class="img-fluid figure-img"></p>
<figcaption><em>Матрица ковариации.</em></figcaption>
</figure>
</div>
<section id="препроцессор-и-модель" class="level3" data-number="24.3.1">
<h3 data-number="24.3.1" class="anchored" data-anchor-id="препроцессор-и-модель"><span class="header-section-number">24.3.1</span> Препроцессор и модель</h3>
<div class="cell">
<div class="sourceCode cell-code" id="cb6"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb6-1"><a href="#cb6-1" aria-hidden="true" tabindex="-1"></a><span class="co"># предсказываем автора по всем переменным</span></span>
<span id="cb6-2"><a href="#cb6-2" aria-hidden="true" tabindex="-1"></a>lda_rec <span class="ot">&lt;-</span> <span class="fu">recipe</span>(author <span class="sc">~</span> ., <span class="at">data =</span> data_train) </span>
<span id="cb6-3"><a href="#cb6-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb6-4"><a href="#cb6-4" aria-hidden="true" tabindex="-1"></a><span class="co"># выбираем модель</span></span>
<span id="cb6-5"><a href="#cb6-5" aria-hidden="true" tabindex="-1"></a>lda_spec <span class="ot">&lt;-</span> <span class="fu">discrim_linear</span>(<span class="at">regularization_method =</span> <span class="fu">tune</span>()) <span class="sc">|&gt;</span> </span>
<span id="cb6-6"><a href="#cb6-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">set_mode</span>(<span class="st">"classification"</span>) <span class="sc">|&gt;</span> </span>
<span id="cb6-7"><a href="#cb6-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">set_engine</span>(<span class="st">"sparsediscrim"</span>)</span>
<span id="cb6-8"><a href="#cb6-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb6-9"><a href="#cb6-9" aria-hidden="true" tabindex="-1"></a>lda_spec</span></code><button title="Скопировать текст" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>Linear Discriminant Model Specification (classification)

Main Arguments:
  regularization_method = tune()

Computational engine: sparsediscrim </code></pre>
</div>
</div>
</section>
<section id="выбор-гиперпараметров" class="level3" data-number="24.3.2">
<h3 data-number="24.3.2" class="anchored" data-anchor-id="выбор-гиперпараметров"><span class="header-section-number">24.3.2</span> Выбор гиперпараметров</h3>
<p>Метод регуляризации мы подберем при помощи настройки.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb8"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb8-1"><a href="#cb8-1" aria-hidden="true" tabindex="-1"></a>lda_param <span class="ot">&lt;-</span> <span class="fu">extract_parameter_set_dials</span>(lda_spec)</span>
<span id="cb8-2"><a href="#cb8-2" aria-hidden="true" tabindex="-1"></a>lda_param</span></code><button title="Скопировать текст" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div data-pagedtable="false">
  <script data-pagedtable-source="" type="application/json">
{"columns":[{"label":["name"],"name":[1],"type":["chr"],"align":["left"]},{"label":["id"],"name":[2],"type":["chr"],"align":["left"]},{"label":["source"],"name":[3],"type":["chr"],"align":["left"]},{"label":["component"],"name":[4],"type":["chr"],"align":["left"]},{"label":["component_id"],"name":[5],"type":["chr"],"align":["left"]},{"label":["object"],"name":[6],"type":["list"],"align":["right"]}],"data":[{"1":"regularization_method","2":"regularization_method","3":"model_spec","4":"discrim_linear","5":"main","6":"<S3: qual_param>"}],"options":{"columns":{"min":{},"max":[10]},"rows":{"min":[10],"max":[10]},"pages":{}}}
  </script>
</div>
</div>
</div>
<p>Создадим сетку гиперпараметров.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb9"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb9-1"><a href="#cb9-1" aria-hidden="true" tabindex="-1"></a>lda_grid <span class="ot">&lt;-</span> lda_param <span class="sc">|&gt;</span> </span>
<span id="cb9-2"><a href="#cb9-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">grid_regular</span>()</span>
<span id="cb9-3"><a href="#cb9-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb9-4"><a href="#cb9-4" aria-hidden="true" tabindex="-1"></a>lda_grid</span></code><button title="Скопировать текст" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div data-pagedtable="false">
  <script data-pagedtable-source="" type="application/json">
{"columns":[{"label":["regularization_method"],"name":[1],"type":["chr"],"align":["left"]}],"data":[{"1":"diagonal"},{"1":"min_distance"},{"1":"shrink_cov"}],"options":{"columns":{"min":{},"max":[10]},"rows":{"min":[10],"max":[10]},"pages":{}}}
  </script>
</div>
</div>
</div>
<p>Теперь добавим модель и препроцессор в воркфлоу.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb10"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb10-1"><a href="#cb10-1" aria-hidden="true" tabindex="-1"></a><span class="co"># workflow </span></span>
<span id="cb10-2"><a href="#cb10-2" aria-hidden="true" tabindex="-1"></a>lda_wflow <span class="ot">&lt;-</span> <span class="fu">workflow</span>() <span class="sc">|&gt;</span> </span>
<span id="cb10-3"><a href="#cb10-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">add_model</span>(lda_spec) <span class="sc">|&gt;</span> </span>
<span id="cb10-4"><a href="#cb10-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">add_recipe</span>(lda_rec)</span>
<span id="cb10-5"><a href="#cb10-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb10-6"><a href="#cb10-6" aria-hidden="true" tabindex="-1"></a>lda_wflow</span></code><button title="Скопировать текст" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>══ Workflow ════════════════════════════════════════════════════════════════════
Preprocessor: Recipe
Model: discrim_linear()

── Preprocessor ────────────────────────────────────────────────────────────────
0 Recipe Steps

── Model ───────────────────────────────────────────────────────────────────────
Linear Discriminant Model Specification (classification)

Main Arguments:
  regularization_method = tune()

Computational engine: sparsediscrim </code></pre>
</div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb12"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb12-1"><a href="#cb12-1" aria-hidden="true" tabindex="-1"></a>lda_tune <span class="ot">&lt;-</span> lda_wflow <span class="sc">|&gt;</span> </span>
<span id="cb12-2"><a href="#cb12-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">tune_grid</span>(</span>
<span id="cb12-3"><a href="#cb12-3" aria-hidden="true" tabindex="-1"></a>    <span class="at">resamples =</span> folds, </span>
<span id="cb12-4"><a href="#cb12-4" aria-hidden="true" tabindex="-1"></a>    <span class="at">grid =</span> lda_grid,</span>
<span id="cb12-5"><a href="#cb12-5" aria-hidden="true" tabindex="-1"></a>    <span class="at">metrics =</span> <span class="fu">metric_set</span>(accuracy, f_meas, roc_auc),</span>
<span id="cb12-6"><a href="#cb12-6" aria-hidden="true" tabindex="-1"></a>    <span class="at">control =</span> <span class="fu">control_resamples</span>(<span class="at">save_pred =</span> <span class="cn">TRUE</span>)</span>
<span id="cb12-7"><a href="#cb12-7" aria-hidden="true" tabindex="-1"></a>  )</span>
<span id="cb12-8"><a href="#cb12-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb12-9"><a href="#cb12-9" aria-hidden="true" tabindex="-1"></a>lda_tune </span></code><button title="Скопировать текст" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div data-pagedtable="false">
  <script data-pagedtable-source="" type="application/json">
{"columns":[{"label":["splits"],"name":[1],"type":["list"],"align":["right"]},{"label":["id"],"name":[2],"type":["chr"],"align":["left"]},{"label":[".metrics"],"name":[3],"type":["list"],"align":["right"]},{"label":[".notes"],"name":[4],"type":["list"],"align":["right"]},{"label":[".predictions"],"name":[5],"type":["list"],"align":["right"]}],"data":[{"1":"<S3: vfold_split>","2":"Fold01","3":"<tibble[,5]>","4":"<tibble[,3]>","5":"<tibble[,7]>"},{"1":"<S3: vfold_split>","2":"Fold02","3":"<tibble[,5]>","4":"<tibble[,3]>","5":"<tibble[,7]>"},{"1":"<S3: vfold_split>","2":"Fold03","3":"<tibble[,5]>","4":"<tibble[,3]>","5":"<tibble[,7]>"},{"1":"<S3: vfold_split>","2":"Fold04","3":"<tibble[,5]>","4":"<tibble[,3]>","5":"<tibble[,7]>"},{"1":"<S3: vfold_split>","2":"Fold05","3":"<tibble[,5]>","4":"<tibble[,3]>","5":"<tibble[,7]>"},{"1":"<S3: vfold_split>","2":"Fold06","3":"<tibble[,5]>","4":"<tibble[,3]>","5":"<tibble[,7]>"},{"1":"<S3: vfold_split>","2":"Fold07","3":"<tibble[,5]>","4":"<tibble[,3]>","5":"<tibble[,7]>"},{"1":"<S3: vfold_split>","2":"Fold08","3":"<tibble[,5]>","4":"<tibble[,3]>","5":"<tibble[,7]>"},{"1":"<S3: vfold_split>","2":"Fold09","3":"<tibble[,5]>","4":"<tibble[,3]>","5":"<tibble[,7]>"},{"1":"<S3: vfold_split>","2":"Fold10","3":"<tibble[,5]>","4":"<tibble[,3]>","5":"<tibble[,7]>"}],"options":{"columns":{"min":{},"max":[10]},"rows":{"min":[10],"max":[10]},"pages":{}}}
  </script>
</div>
</div>
</div>
</section>
<section id="оценка-модели-f-score" class="level3" data-number="24.3.3">
<h3 data-number="24.3.3" class="anchored" data-anchor-id="оценка-модели-f-score"><span class="header-section-number">24.3.3</span> Оценка модели: F-score</h3>
<p>В этом примере мы использовали два критерия оценки: точность (т.е доля верных ответов) и F-score, также известный как F1-score или гармоническое среднее. Это комплексная метрика, которая объединяет в себе два других важных показателя эффективности модели: точность (precision) и полноту (recall).</p>
<p>Precision (точность) - это доля правильно классифицированных положительных примеров среди всех примеров, предсказанных как положительные. Recall (полнота) - это доля правильно классифицированных положительных примеров среди всех фактически положительных примеров.</p>
<p>Формула для расчета F-score:</p>
<p><span class="math display">\[F\text{-}score = 2 \cdot \frac{precision \cdot recall}{precision + recall}\]</span></p>
<p>Где:</p>
<ul>
<li><span class="math inline">\(precision = \frac{TP}{TP + FP}\)</span></li>
<li><span class="math inline">\(recall = \frac{TP}{TP + FN}\)</span></li>
</ul>
<p>F-score находится в диапазоне от 0 до 1, и чем ближе значение к 1, тем лучше работает модель. При оценке качества поисковой системы F-score может быть более информативным, чем только точность или только полнота, поскольку учитывает оба этих аспекта.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb13"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb13-1"><a href="#cb13-1" aria-hidden="true" tabindex="-1"></a>tune<span class="sc">::</span><span class="fu">collect_metrics</span>(lda_tune)</span></code><button title="Скопировать текст" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div data-pagedtable="false">
  <script data-pagedtable-source="" type="application/json">
{"columns":[{"label":["regularization_method"],"name":[1],"type":["chr"],"align":["left"]},{"label":[".metric"],"name":[2],"type":["chr"],"align":["left"]},{"label":[".estimator"],"name":[3],"type":["chr"],"align":["left"]},{"label":["mean"],"name":[4],"type":["dbl"],"align":["right"]},{"label":["n"],"name":[5],"type":["int"],"align":["right"]},{"label":["std_err"],"name":[6],"type":["dbl"],"align":["right"]},{"label":[".config"],"name":[7],"type":["chr"],"align":["left"]}],"data":[{"1":"diagonal","2":"accuracy","3":"binary","4":"1.0000000","5":"10","6":"0.00000000","7":"Preprocessor1_Model1"},{"1":"diagonal","2":"f_meas","3":"binary","4":"1.0000000","5":"10","6":"0.00000000","7":"Preprocessor1_Model1"},{"1":"diagonal","2":"roc_auc","3":"binary","4":"1.0000000","5":"10","6":"0.00000000","7":"Preprocessor1_Model1"},{"1":"min_distance","2":"accuracy","3":"binary","4":"0.9633333","5":"10","6":"0.02457038","7":"Preprocessor1_Model2"},{"1":"min_distance","2":"f_meas","3":"binary","4":"0.9714286","5":"10","6":"0.01904762","7":"Preprocessor1_Model2"},{"1":"min_distance","2":"roc_auc","3":"binary","4":"NaN","5":"0","6":"NA","7":"Preprocessor1_Model2"},{"1":"shrink_cov","2":"accuracy","3":"binary","4":"0.2266667","5":"10","6":"0.01777778","7":"Preprocessor1_Model3"},{"1":"shrink_cov","2":"f_meas","3":"binary","4":"NaN","5":"0","6":"NA","7":"Preprocessor1_Model3"},{"1":"shrink_cov","2":"roc_auc","3":"binary","4":"0.9375000","5":"10","6":"0.06250000","7":"Preprocessor1_Model3"}],"options":{"columns":{"min":{},"max":[10]},"rows":{"min":[10],"max":[10]},"pages":{}}}
  </script>
</div>
</div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb14"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb14-1"><a href="#cb14-1" aria-hidden="true" tabindex="-1"></a><span class="fu">autoplot</span>(lda_tune) </span></code><button title="Скопировать текст" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="classification_files/figure-html/unnamed-chunk-12-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb15"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb15-1"><a href="#cb15-1" aria-hidden="true" tabindex="-1"></a>lda_best <span class="ot">&lt;-</span> tune<span class="sc">::</span><span class="fu">select_best</span>(lda_tune, <span class="at">metric =</span> <span class="st">"accuracy"</span>)</span>
<span id="cb15-2"><a href="#cb15-2" aria-hidden="true" tabindex="-1"></a>lda_best</span></code><button title="Скопировать текст" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div data-pagedtable="false">
  <script data-pagedtable-source="" type="application/json">
{"columns":[{"label":["regularization_method"],"name":[1],"type":["chr"],"align":["left"]},{"label":[".config"],"name":[2],"type":["chr"],"align":["left"]}],"data":[{"1":"diagonal","2":"Preprocessor1_Model1"}],"options":{"columns":{"min":{},"max":[10]},"rows":{"min":[10],"max":[10]},"pages":{}}}
  </script>
</div>
</div>
</div>
<p>Таким образом, оптимальным методом является диагональная регуляризация. Цель диагональной регуляризации - избежать вырожденности ковариационной матрицы за счет добавления к ее диагональным элементам некоторой константы λ. Добавление константы λ к диагональным элементам ковариационной матрицы позволяет сделать ее невырожденной и обратимой, а это позволяет провести вычисление обратной матрицы, необходимое для LDA.</p>
</section>
<section id="roc-кривая" class="level3" data-number="24.3.4">
<h3 data-number="24.3.4" class="anchored" data-anchor-id="roc-кривая"><span class="header-section-number">24.3.4</span> ROC-кривая</h3>
<p>ROC-кривая (англ. receiver operating characteristic, рабочая характеристика приёмника) — это график, который показывает соотношение между чувствительностью (true positive rate) и специфичностью (false positive rate) классификатора.</p>
<p>Основные характеристики ROC-кривой:</p>
<ol type="1">
<li><p>Ось Y (TPR) - показывает долю правильно классифицированных положительных примеров (чувствительность). Изменяется от 0 до 1.</p></li>
<li><p>Ось X (FPR) - показывает долю ошибочно классифицированных отрицательных примеров (1 - специфичность). Изменяется от 0 до 1.</p></li>
<li><p>Диагональная линия (y=x) - представляет случайную классификацию, когда вероятность положительного класса равна вероятности отрицательного класса.</p></li>
<li><p>Площадь под ROC-кривой (Area Under Curve, AUC) - показывает качество классификатора. Чем больше AUC (максимальное значение 1), тем лучше работает модель.</p></li>
</ol>
<p>Основные интерпретации ROC-кривой:</p>
<ul>
<li>Если кривая расположена выше диагональной линии, это говорит о том, что модель работает лучше случайной классификации.</li>
<li>Если кривая совпадает с диагональной линией, то модель не способна отличить положительные и отрицательные классы.</li>
<li>Если кривая расположена ниже диагональной линии, это свидетельствует о том, что модель работает хуже случайной классификации.</li>
</ul>
<div class="cell">
<div class="sourceCode cell-code" id="cb16"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb16-1"><a href="#cb16-1" aria-hidden="true" tabindex="-1"></a>lda_predictions <span class="ot">&lt;-</span> lda_tune <span class="sc">|&gt;</span> </span>
<span id="cb16-2"><a href="#cb16-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">collect_predictions</span>(<span class="at">parameters =</span> lda_best) <span class="sc">|&gt;</span> </span>
<span id="cb16-3"><a href="#cb16-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate_if</span>(is.numeric, round, <span class="dv">3</span>)</span>
<span id="cb16-4"><a href="#cb16-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb16-5"><a href="#cb16-5" aria-hidden="true" tabindex="-1"></a>lda_predictions</span></code><button title="Скопировать текст" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div data-pagedtable="false">
  <script data-pagedtable-source="" type="application/json">
{"columns":[{"label":[".pred_class"],"name":[1],"type":["fct"],"align":["left"]},{"label":[".pred_Hamilton"],"name":[2],"type":["dbl"],"align":["right"]},{"label":[".pred_Madison"],"name":[3],"type":["dbl"],"align":["right"]},{"label":["id"],"name":[4],"type":["chr"],"align":["left"]},{"label":[".row"],"name":[5],"type":["dbl"],"align":["right"]},{"label":["regularization_method"],"name":[6],"type":["chr"],"align":["left"]},{"label":["author"],"name":[7],"type":["fct"],"align":["left"]},{"label":[".config"],"name":[8],"type":["chr"],"align":["left"]}],"data":[{"1":"Hamilton","2":"1.000","3":"0.000","4":"Fold01","5":"5","6":"diagonal","7":"Hamilton","8":"Preprocessor1_Model1"},{"1":"Hamilton","2":"1.000","3":"0.000","4":"Fold01","5":"12","6":"diagonal","7":"Hamilton","8":"Preprocessor1_Model1"},{"1":"Hamilton","2":"1.000","3":"0.000","4":"Fold01","5":"19","6":"diagonal","7":"Hamilton","8":"Preprocessor1_Model1"},{"1":"Hamilton","2":"1.000","3":"0.000","4":"Fold01","5":"33","6":"diagonal","7":"Hamilton","8":"Preprocessor1_Model1"},{"1":"Madison","2":"0.000","3":"1.000","4":"Fold01","5":"48","6":"diagonal","7":"Madison","8":"Preprocessor1_Model1"},{"1":"Madison","2":"0.000","3":"1.000","4":"Fold01","5":"50","6":"diagonal","7":"Madison","8":"Preprocessor1_Model1"},{"1":"Hamilton","2":"1.000","3":"0.000","4":"Fold02","5":"11","6":"diagonal","7":"Hamilton","8":"Preprocessor1_Model1"},{"1":"Hamilton","2":"1.000","3":"0.000","4":"Fold02","5":"16","6":"diagonal","7":"Hamilton","8":"Preprocessor1_Model1"},{"1":"Hamilton","2":"1.000","3":"0.000","4":"Fold02","5":"28","6":"diagonal","7":"Hamilton","8":"Preprocessor1_Model1"},{"1":"Hamilton","2":"1.000","3":"0.000","4":"Fold02","5":"31","6":"diagonal","7":"Hamilton","8":"Preprocessor1_Model1"},{"1":"Madison","2":"0.000","3":"1.000","4":"Fold02","5":"42","6":"diagonal","7":"Madison","8":"Preprocessor1_Model1"},{"1":"Madison","2":"0.000","3":"1.000","4":"Fold02","5":"52","6":"diagonal","7":"Madison","8":"Preprocessor1_Model1"},{"1":"Hamilton","2":"1.000","3":"0.000","4":"Fold03","5":"2","6":"diagonal","7":"Hamilton","8":"Preprocessor1_Model1"},{"1":"Hamilton","2":"1.000","3":"0.000","4":"Fold03","5":"4","6":"diagonal","7":"Hamilton","8":"Preprocessor1_Model1"},{"1":"Hamilton","2":"1.000","3":"0.000","4":"Fold03","5":"21","6":"diagonal","7":"Hamilton","8":"Preprocessor1_Model1"},{"1":"Hamilton","2":"1.000","3":"0.000","4":"Fold03","5":"36","6":"diagonal","7":"Hamilton","8":"Preprocessor1_Model1"},{"1":"Madison","2":"0.005","3":"0.995","4":"Fold03","5":"46","6":"diagonal","7":"Madison","8":"Preprocessor1_Model1"},{"1":"Hamilton","2":"1.000","3":"0.000","4":"Fold04","5":"6","6":"diagonal","7":"Hamilton","8":"Preprocessor1_Model1"},{"1":"Hamilton","2":"1.000","3":"0.000","4":"Fold04","5":"26","6":"diagonal","7":"Hamilton","8":"Preprocessor1_Model1"},{"1":"Hamilton","2":"1.000","3":"0.000","4":"Fold04","5":"34","6":"diagonal","7":"Hamilton","8":"Preprocessor1_Model1"},{"1":"Hamilton","2":"1.000","3":"0.000","4":"Fold04","5":"39","6":"diagonal","7":"Hamilton","8":"Preprocessor1_Model1"},{"1":"Madison","2":"0.000","3":"1.000","4":"Fold04","5":"51","6":"diagonal","7":"Madison","8":"Preprocessor1_Model1"},{"1":"Hamilton","2":"1.000","3":"0.000","4":"Fold05","5":"15","6":"diagonal","7":"Hamilton","8":"Preprocessor1_Model1"},{"1":"Hamilton","2":"1.000","3":"0.000","4":"Fold05","5":"24","6":"diagonal","7":"Hamilton","8":"Preprocessor1_Model1"},{"1":"Hamilton","2":"1.000","3":"0.000","4":"Fold05","5":"30","6":"diagonal","7":"Hamilton","8":"Preprocessor1_Model1"},{"1":"Hamilton","2":"1.000","3":"0.000","4":"Fold05","5":"32","6":"diagonal","7":"Hamilton","8":"Preprocessor1_Model1"},{"1":"Madison","2":"0.000","3":"1.000","4":"Fold05","5":"44","6":"diagonal","7":"Madison","8":"Preprocessor1_Model1"},{"1":"Hamilton","2":"1.000","3":"0.000","4":"Fold06","5":"3","6":"diagonal","7":"Hamilton","8":"Preprocessor1_Model1"},{"1":"Hamilton","2":"1.000","3":"0.000","4":"Fold06","5":"22","6":"diagonal","7":"Hamilton","8":"Preprocessor1_Model1"},{"1":"Hamilton","2":"1.000","3":"0.000","4":"Fold06","5":"37","6":"diagonal","7":"Hamilton","8":"Preprocessor1_Model1"},{"1":"Hamilton","2":"1.000","3":"0.000","4":"Fold06","5":"38","6":"diagonal","7":"Hamilton","8":"Preprocessor1_Model1"},{"1":"Madison","2":"0.003","3":"0.997","4":"Fold06","5":"41","6":"diagonal","7":"Madison","8":"Preprocessor1_Model1"},{"1":"Hamilton","2":"1.000","3":"0.000","4":"Fold07","5":"1","6":"diagonal","7":"Hamilton","8":"Preprocessor1_Model1"},{"1":"Hamilton","2":"1.000","3":"0.000","4":"Fold07","5":"10","6":"diagonal","7":"Hamilton","8":"Preprocessor1_Model1"},{"1":"Hamilton","2":"0.983","3":"0.017","4":"Fold07","5":"27","6":"diagonal","7":"Hamilton","8":"Preprocessor1_Model1"},{"1":"Hamilton","2":"1.000","3":"0.000","4":"Fold07","5":"29","6":"diagonal","7":"Hamilton","8":"Preprocessor1_Model1"},{"1":"Madison","2":"0.000","3":"1.000","4":"Fold07","5":"43","6":"diagonal","7":"Madison","8":"Preprocessor1_Model1"},{"1":"Hamilton","2":"1.000","3":"0.000","4":"Fold08","5":"13","6":"diagonal","7":"Hamilton","8":"Preprocessor1_Model1"},{"1":"Hamilton","2":"1.000","3":"0.000","4":"Fold08","5":"14","6":"diagonal","7":"Hamilton","8":"Preprocessor1_Model1"},{"1":"Hamilton","2":"1.000","3":"0.000","4":"Fold08","5":"17","6":"diagonal","7":"Hamilton","8":"Preprocessor1_Model1"},{"1":"Hamilton","2":"1.000","3":"0.000","4":"Fold08","5":"20","6":"diagonal","7":"Hamilton","8":"Preprocessor1_Model1"},{"1":"Madison","2":"0.000","3":"1.000","4":"Fold08","5":"47","6":"diagonal","7":"Madison","8":"Preprocessor1_Model1"},{"1":"Hamilton","2":"1.000","3":"0.000","4":"Fold09","5":"7","6":"diagonal","7":"Hamilton","8":"Preprocessor1_Model1"},{"1":"Hamilton","2":"1.000","3":"0.000","4":"Fold09","5":"8","6":"diagonal","7":"Hamilton","8":"Preprocessor1_Model1"},{"1":"Hamilton","2":"1.000","3":"0.000","4":"Fold09","5":"35","6":"diagonal","7":"Hamilton","8":"Preprocessor1_Model1"},{"1":"Hamilton","2":"1.000","3":"0.000","4":"Fold09","5":"40","6":"diagonal","7":"Hamilton","8":"Preprocessor1_Model1"},{"1":"Madison","2":"0.000","3":"1.000","4":"Fold09","5":"45","6":"diagonal","7":"Madison","8":"Preprocessor1_Model1"},{"1":"Hamilton","2":"1.000","3":"0.000","4":"Fold10","5":"9","6":"diagonal","7":"Hamilton","8":"Preprocessor1_Model1"},{"1":"Hamilton","2":"1.000","3":"0.000","4":"Fold10","5":"18","6":"diagonal","7":"Hamilton","8":"Preprocessor1_Model1"},{"1":"Hamilton","2":"1.000","3":"0.000","4":"Fold10","5":"23","6":"diagonal","7":"Hamilton","8":"Preprocessor1_Model1"},{"1":"Hamilton","2":"1.000","3":"0.000","4":"Fold10","5":"25","6":"diagonal","7":"Hamilton","8":"Preprocessor1_Model1"},{"1":"Madison","2":"0.000","3":"1.000","4":"Fold10","5":"49","6":"diagonal","7":"Madison","8":"Preprocessor1_Model1"}],"options":{"columns":{"min":{},"max":[10]},"rows":{"min":[10],"max":[10]},"pages":{}}}
  </script>
</div>
</div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb17"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb17-1"><a href="#cb17-1" aria-hidden="true" tabindex="-1"></a>lda_predictions <span class="sc">|&gt;</span> </span>
<span id="cb17-2"><a href="#cb17-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">roc_curve</span>(author, .pred_Hamilton) <span class="sc">|&gt;</span> </span>
<span id="cb17-3"><a href="#cb17-3" aria-hidden="true" tabindex="-1"></a>  <span class="co"># или, для другого класса:</span></span>
<span id="cb17-4"><a href="#cb17-4" aria-hidden="true" tabindex="-1"></a>  <span class="co">#roc_curve(author, .pred_Madison, event_level = "second") |&gt; </span></span>
<span id="cb17-5"><a href="#cb17-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">autoplot</span>()</span></code><button title="Скопировать текст" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="classification_files/figure-html/unnamed-chunk-15-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
</section>
<section id="матрица-смешения" class="level3" data-number="24.3.5">
<h3 data-number="24.3.5" class="anchored" data-anchor-id="матрица-смешения"><span class="header-section-number">24.3.5</span> Матрица смешения</h3>
<p>Взглянем на матрицу смешения. В обучающих данных всего 52 текста, из них 40 принадлежит Гамильтону, а 12 – Мэдисону.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb18"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb18-1"><a href="#cb18-1" aria-hidden="true" tabindex="-1"></a>lda_param <span class="ot">&lt;-</span> <span class="fu">tibble</span>(<span class="at">regularization_method =</span> <span class="st">"diagonal"</span>)</span>
<span id="cb18-2"><a href="#cb18-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb18-3"><a href="#cb18-3" aria-hidden="true" tabindex="-1"></a><span class="fu">conf_mat_resampled</span>(lda_tune, <span class="at">tidy =</span> <span class="cn">FALSE</span>, <span class="at">parameters =</span> lda_param) <span class="sc">|&gt;</span> </span>
<span id="cb18-4"><a href="#cb18-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">autoplot</span>(<span class="at">type =</span> <span class="st">"heatmap"</span>) <span class="sc">+</span></span>
<span id="cb18-5"><a href="#cb18-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_fill_gradient</span>(<span class="at">low =</span> <span class="st">"#eaeff6"</span>, <span class="at">high =</span> <span class="st">"#233857"</span>) <span class="sc">+</span></span>
<span id="cb18-6"><a href="#cb18-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">panel.grid.major =</span> <span class="fu">element_line</span>(<span class="at">colour =</span> <span class="st">"#233857"</span>),</span>
<span id="cb18-7"><a href="#cb18-7" aria-hidden="true" tabindex="-1"></a>        <span class="at">axis.text =</span> <span class="fu">element_text</span>(<span class="at">color =</span> <span class="st">"#233857"</span>),</span>
<span id="cb18-8"><a href="#cb18-8" aria-hidden="true" tabindex="-1"></a>        <span class="at">axis.title =</span> <span class="fu">element_text</span>(<span class="at">color =</span> <span class="st">"#233857"</span>),</span>
<span id="cb18-9"><a href="#cb18-9" aria-hidden="true" tabindex="-1"></a>        <span class="at">plot.title =</span> <span class="fu">element_text</span>(<span class="at">color =</span> <span class="st">"#233857"</span>)) <span class="sc">+</span></span>
<span id="cb18-10"><a href="#cb18-10" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggtitle</span>(<span class="st">"LDA, 70 признаков"</span>)</span></code><button title="Скопировать текст" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="classification_files/figure-html/unnamed-chunk-16-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
</section>
<section id="окончательная-настройка-модели" class="level3" data-number="24.3.6">
<h3 data-number="24.3.6" class="anchored" data-anchor-id="окончательная-настройка-модели"><span class="header-section-number">24.3.6</span> Окончательная настройка модели</h3>
<p>Прежде всего установим нужный метод регуляризации.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb19"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb19-1"><a href="#cb19-1" aria-hidden="true" tabindex="-1"></a>final_lda_wflow <span class="ot">&lt;-</span> </span>
<span id="cb19-2"><a href="#cb19-2" aria-hidden="true" tabindex="-1"></a>  lda_wflow <span class="sc">|&gt;</span> </span>
<span id="cb19-3"><a href="#cb19-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">finalize_workflow</span>(lda_param)</span>
<span id="cb19-4"><a href="#cb19-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb19-5"><a href="#cb19-5" aria-hidden="true" tabindex="-1"></a>final_lda_wflow</span></code><button title="Скопировать текст" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>══ Workflow ════════════════════════════════════════════════════════════════════
Preprocessor: Recipe
Model: discrim_linear()

── Preprocessor ────────────────────────────────────────────────────────────────
0 Recipe Steps

── Model ───────────────────────────────────────────────────────────────────────
Linear Discriminant Model Specification (classification)

Main Arguments:
  regularization_method = diagonal

Computational engine: sparsediscrim </code></pre>
</div>
</div>
<p>И подгоним модель.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb21"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb21-1"><a href="#cb21-1" aria-hidden="true" tabindex="-1"></a>lda_fit <span class="ot">&lt;-</span> final_lda_wflow  <span class="sc">|&gt;</span> </span>
<span id="cb21-2"><a href="#cb21-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">fit</span>(data_train)</span></code><button title="Скопировать текст" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</section>
<section id="тестовая-выборка" class="level3" data-number="24.3.7">
<h3 data-number="24.3.7" class="anchored" data-anchor-id="тестовая-выборка"><span class="header-section-number">24.3.7</span> Тестовая выборка</h3>
<p>У нас остались неиспользованными 14 наблюдений в тестовой выборке.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb22"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb22-1"><a href="#cb22-1" aria-hidden="true" tabindex="-1"></a>pred_test <span class="ot">&lt;-</span> <span class="fu">predict</span>(lda_fit, data_test, <span class="at">type =</span> <span class="st">"class"</span>)</span></code><button title="Скопировать текст" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>Здесь тоже 100%-я точность.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb23"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb23-1"><a href="#cb23-1" aria-hidden="true" tabindex="-1"></a>test_acc <span class="ot">&lt;-</span> <span class="fu">tibble</span>(<span class="at">predicted =</span> pred_test<span class="sc">$</span>.pred_class, </span>
<span id="cb23-2"><a href="#cb23-2" aria-hidden="true" tabindex="-1"></a>       <span class="at">expected =</span> data_test<span class="sc">$</span>author, </span>
<span id="cb23-3"><a href="#cb23-3" aria-hidden="true" tabindex="-1"></a>       <span class="at">value =</span> predicted <span class="sc">==</span> expected)</span>
<span id="cb23-4"><a href="#cb23-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb23-5"><a href="#cb23-5" aria-hidden="true" tabindex="-1"></a><span class="fu">sum</span>(test_acc<span class="sc">$</span>value) <span class="sc">/</span> <span class="fu">nrow</span>(test_acc)</span></code><button title="Скопировать текст" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 1</code></pre>
</div>
</div>
</section>
<section id="классификация-спорных-эссе" class="level3" data-number="24.3.8">
<h3 data-number="24.3.8" class="anchored" data-anchor-id="классификация-спорных-эссе"><span class="header-section-number">24.3.8</span> Классификация спорных эссе</h3>
<p>Все указывает на то, что в большинстве случаев Мэдисон – наиболее вероятный автор. Что касается 55-го эссе, то на его счет сомневались и Мостеллер с Уоллесом.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb25"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb25-1"><a href="#cb25-1" aria-hidden="true" tabindex="-1"></a><span class="fu">predict</span>(lda_fit, dispt, <span class="at">type =</span> <span class="st">"class"</span>) <span class="sc">|&gt;</span> </span>
<span id="cb25-2"><a href="#cb25-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">essay =</span> dispt<span class="sc">$</span>filename)</span></code><button title="Скопировать текст" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div data-pagedtable="false">
  <script data-pagedtable-source="" type="application/json">
{"columns":[{"label":[".pred_class"],"name":[1],"type":["fct"],"align":["left"]},{"label":["essay"],"name":[2],"type":["chr"],"align":["left"]}],"data":[{"1":"Madison","2":"dispt_fed_49.txt"},{"1":"Madison","2":"dispt_fed_50.txt"},{"1":"Madison","2":"dispt_fed_51.txt"},{"1":"Madison","2":"dispt_fed_52.txt"},{"1":"Madison","2":"dispt_fed_53.txt"},{"1":"Madison","2":"dispt_fed_54.txt"},{"1":"Hamilton","2":"dispt_fed_55.txt"},{"1":"Madison","2":"dispt_fed_56.txt"},{"1":"Madison","2":"dispt_fed_57.txt"},{"1":"Madison","2":"dispt_fed_62.txt"},{"1":"Madison","2":"dispt_fed_63.txt"}],"options":{"columns":{"min":{},"max":[10]},"rows":{"min":[10],"max":[10]},"pages":{}}}
  </script>
</div>
</div>
</div>
</section>
</section>
<section id="наивный-байес" class="level2" data-number="24.4">
<h2 data-number="24.4" class="anchored" data-anchor-id="наивный-байес"><span class="header-section-number">24.4</span> Наивный Байес</h2>
<p>Еще один алгоритм, который часто используется в задачах классификации, называется “наивный Байес”.</p>
<section id="теорема-байеса" class="level3" data-number="24.4.1">
<h3 data-number="24.4.1" class="anchored" data-anchor-id="теорема-байеса"><span class="header-section-number">24.4.1</span> Теорема Байеса</h3>
<p>Теорема Байеса позволяет оценить вероятность одного события на основе вероятности другого собыитя. Математически теорема Байеса выглядит так:</p>
<p><span class="math display">\[P(A|B) = \frac{P(B|A) \times P(A)}{P(B)}\]</span></p>
<p>Здесь:</p>
<ul>
<li><p><span class="math inline">\(P(A|B)\)</span> - вероятность события A при условии, что произошло событие B (апостериорная вероятность); она рассчитывается с учетом того, как часто события А и В происходят вместе и того, как часто вообще происходит B. Например: какова вероятность того, что письмо, содержащее слово “наследство”, является спамом?</p></li>
<li><p><span class="math inline">\(P(B|A)\)</span> - вероятность события B при условии, что произошло событие A (правдоподобие). Например: какова вероятность встретить слово “наследство” в спаме?</p></li>
<li><p><span class="math inline">\(P(A)\)</span> - вероятность события A (априорная вероятность). Например: какова вероятность получить спам?</p></li>
<li><p><span class="math inline">\(P(B)\)</span> - вероятность события B (маргинальное правдоподобие). Например: как часто вообще встречается слово “наследство”?</p></li>
</ul>
<p>Теорема Байеса широко применяется в задачах классификации в машинном обучении. Например, в наивном байесовском классификаторе, который использует теорему Байеса для вычисления вероятности принадлежности объекта к тому или иному классу.</p>
<p>Чтобы лучше понять теорему, решите несколько задач.</p>
<div class="callout callout-style-default callout-warning no-icon callout-titled">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon no-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Задание
</div>
</div>
<div class="callout-body-container callout-body">
<p>В кофейне подают два вида кофе: латте и капучино. 70% клиентов выбирают латте, а 30% — капучино. Известно, что 20% клиентов, выбравших латте, добавляют сахар, а среди выбравших капучино сахар добавляют 40%. Клиент добавил сахар в кофе. Какова вероятность, что он выбрал латте? Ответ запишите в процентах c округлением до двух сотых.</p>
</div>
</div>
<p>Дано:</p>
<ul>
<li><p><span class="math inline">\(P(L)=0.7\)</span> (вероятность выбора латте).</p></li>
<li><p><span class="math inline">\(P(C)=0.3\)</span> (вероятность выбора капучино).</p></li>
<li><p><span class="math inline">\(P(S|L)=0.2\)</span> (вероятность добавления сахара для латте).</p></li>
<li><p><span class="math inline">\(P(S∣C)=0.4P\)</span> (вероятность добавления сахара для капучино).</p></li>
</ul>
<p>Необходимо найти <span class="math inline">\(P(L∣S)\)</span> — вероятность того, что клиент выбрал латте при условии, что он добавил сахар. Полная вероятность добавления сахара считается так: <span class="math inline">\(P(S) = P(S∣L)⋅P(L)+ P(S∣C)⋅P(C)\)</span>.</p>
<p>Ответ: <input class="webex-solveme nospaces" size="5" data-answer="[&quot;53.85&quot;]"></p>
<div class="callout callout-style-default callout-warning no-icon callout-titled">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon no-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Задание
</div>
</div>
<div class="callout-body-container callout-body">
<p>В приюте для животных есть коты двух пород: мейн-куны и британские короткошерстные. 70% котов — мейн-куны, а 30% — британские короткошерстные. Известно, что 15% мейн-кунов имеют зеленые глаза, а у британских короткошерстных котов зеленые глаза встречаются у 40%. Посетитель приюта случайным образом выбирает кота с зелеными глазами. Какова вероятность, что это мейн-кун? Ответ запишите в процентах c округлением до двух сотых.</p>
</div>
</div>
<p>Дано:</p>
<p><span class="math inline">\(P(M)=0.7\)</span> (вероятность выбрать мейн-куна).</p>
<p><span class="math inline">\(P(B)=0.3\)</span> (вероятность выбрать британского короткошерстного).</p>
<p><span class="math inline">\(P(G∣M)=0.15\)</span> (вероятность зеленых глаз для мейн-куна).</p>
<p><span class="math inline">\(P(G∣B)=0.4\)</span> (вероятность зеленых глаз для британского короткошерстного).</p>
<p>Необходимо найти: <span class="math inline">\(P(M∣G)\)</span> — вероятность того, что кот — мейн-кун при условии, что у него зеленые глаза.</p>
<p>Ответ: <input class="webex-solveme nospaces" size="5" data-answer="[&quot;46.67&quot;]">.</p>
<div class="callout callout-style-default callout-warning no-icon callout-titled">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon no-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Задание
</div>
</div>
<div class="callout-body-container callout-body">
<p>В библиотеке есть книги двух жанров: детективы и фантастика. 60% книг — детективы, а 40% — фантастика. Известно, что 10% детективов имеют красную обложку, а у фантастики красная обложка у 25% книг. Читатель случайным образом выбирает книгу с красной обложкой. Какова вероятность, что это детектив? Ответ запишите в процентах c округлением до двух сотых.</p>
</div>
</div>
<p>Ответ: <input class="webex-solveme nospaces" size="4" data-answer="[&quot;37.5&quot;]">.</p>
<p>Можете придумать свою задачу?</p>
</section>
<section id="применение-теоремы-в-мо" class="level3" data-number="24.4.2">
<h3 data-number="24.4.2" class="anchored" data-anchor-id="применение-теоремы-в-мо"><span class="header-section-number">24.4.2</span> Применение теоремы в МО</h3>
<p>Наивный байесовский классификатор называется “наивным” из-за ключевого допущения, которое он делает в своей работе: предположение о независимости признаков.</p>
<p>Наивный Байес предполагает, что признаки (предикторы) объекта, который нужно классифицировать, являются статистически независимыми друг от друга, то есть значение одного признака не зависит от значений других признаков.</p>
<p>Это “наивное” предположение значительно упрощает вычисления, необходимые для применения теоремы Байеса. Вместо того, чтобы вычислять сложную совместную вероятность всех признаков, наивный Байес разбивает это на произведение вероятностей отдельных признаков.</p>
<p><img src="./images/nb_1.png" class="img-fluid"></p>
<p>Знаменатель будет для всех групп одинаков, поэтому:</p>
<p><img src="images/nb_2.png" class="img-fluid"></p>
<p>Хотя это предположение редко выполняется в реальных данных, наивный Байес часто демонстрирует неожиданно хорошую производительность. Таким образом, “наивность” этого классификатора относится именно к этому упрощающему предположению.</p>
<p>Что если в обучающем корпусе слово в каком-то классе не встречается? Чтобы все вероятности не обнулились, применяют критерий Лапласа, то есть добавляют ко всем значениям в таблице небольшое число.</p>
</section>
<section id="препроцессор-и-модель-1" class="level3" data-number="24.4.3">
<h3 data-number="24.4.3" class="anchored" data-anchor-id="препроцессор-и-модель-1"><span class="header-section-number">24.4.3</span> Препроцессор и модель</h3>
<div class="cell">
<div class="sourceCode cell-code" id="cb26"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb26-1"><a href="#cb26-1" aria-hidden="true" tabindex="-1"></a><span class="co"># предсказываем автора по всем переменным</span></span>
<span id="cb26-2"><a href="#cb26-2" aria-hidden="true" tabindex="-1"></a>nb_rec <span class="ot">&lt;-</span> <span class="fu">recipe</span>(author <span class="sc">~</span> ., <span class="at">data =</span> data_train) </span>
<span id="cb26-3"><a href="#cb26-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb26-4"><a href="#cb26-4" aria-hidden="true" tabindex="-1"></a><span class="co"># выбираем модель</span></span>
<span id="cb26-5"><a href="#cb26-5" aria-hidden="true" tabindex="-1"></a>nb_spec <span class="ot">&lt;-</span> <span class="fu">naive_Bayes</span>(<span class="at">Laplace =</span> <span class="fu">tune</span>(),</span>
<span id="cb26-6"><a href="#cb26-6" aria-hidden="true" tabindex="-1"></a>                       <span class="at">smoothness =</span> <span class="fu">tune</span>()) <span class="sc">|&gt;</span> </span>
<span id="cb26-7"><a href="#cb26-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">set_mode</span>(<span class="st">"classification"</span>) <span class="sc">|&gt;</span> </span>
<span id="cb26-8"><a href="#cb26-8" aria-hidden="true" tabindex="-1"></a>  <span class="fu">set_engine</span>(<span class="st">"naivebayes"</span>)</span>
<span id="cb26-9"><a href="#cb26-9" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb26-10"><a href="#cb26-10" aria-hidden="true" tabindex="-1"></a>nb_spec</span></code><button title="Скопировать текст" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>Naive Bayes Model Specification (classification)

Main Arguments:
  smoothness = tune()
  Laplace = tune()

Computational engine: naivebayes </code></pre>
</div>
</div>
<p>Согласно <a href="https://parsnip.tidymodels.org/reference/naive_Bayes.html">документации</a>, меньшие значения <code>smoothness</code> приводят к более гибким, адаптивным границам между классами. Другими словами, <code>smoothness</code> - это параметр, с помощью которого можно контролировать гибкость границ классификации, определяемых наивным байесовским классификатором. Низкие значения <code>smoothness</code> позволяют модели более точно подстраиваться под обучающие данные, но могут также приводить к переобучению. Высокие значения сглаживают границы и делают модель более устойчивой, но менее точной на обучающих данных.</p>
</section>
<section id="выбор-гиперпараметров-1" class="level3" data-number="24.4.4">
<h3 data-number="24.4.4" class="anchored" data-anchor-id="выбор-гиперпараметров-1"><span class="header-section-number">24.4.4</span> Выбор гиперпараметров</h3>
<div class="cell">
<div class="sourceCode cell-code" id="cb28"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb28-1"><a href="#cb28-1" aria-hidden="true" tabindex="-1"></a>nb_param <span class="ot">&lt;-</span> <span class="fu">extract_parameter_set_dials</span>(nb_spec)</span>
<span id="cb28-2"><a href="#cb28-2" aria-hidden="true" tabindex="-1"></a>nb_param</span></code><button title="Скопировать текст" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div data-pagedtable="false">
  <script data-pagedtable-source="" type="application/json">
{"columns":[{"label":["name"],"name":[1],"type":["chr"],"align":["left"]},{"label":["id"],"name":[2],"type":["chr"],"align":["left"]},{"label":["source"],"name":[3],"type":["chr"],"align":["left"]},{"label":["component"],"name":[4],"type":["chr"],"align":["left"]},{"label":["component_id"],"name":[5],"type":["chr"],"align":["left"]},{"label":["object"],"name":[6],"type":["list"],"align":["right"]}],"data":[{"1":"smoothness","2":"smoothness","3":"model_spec","4":"naive_Bayes","5":"main","6":"<S3: quant_param>"},{"1":"Laplace","2":"Laplace","3":"model_spec","4":"naive_Bayes","5":"main","6":"<S3: quant_param>"}],"options":{"columns":{"min":{},"max":[10]},"rows":{"min":[10],"max":[10]},"pages":{}}}
  </script>
</div>
</div>
</div>
<p>Теперь добавим модель и препроцессор в воркфлоу.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb29"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb29-1"><a href="#cb29-1" aria-hidden="true" tabindex="-1"></a><span class="co"># workflow </span></span>
<span id="cb29-2"><a href="#cb29-2" aria-hidden="true" tabindex="-1"></a>nb_wflow <span class="ot">&lt;-</span> <span class="fu">workflow</span>() <span class="sc">|&gt;</span> </span>
<span id="cb29-3"><a href="#cb29-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">add_model</span>(nb_spec) <span class="sc">|&gt;</span> </span>
<span id="cb29-4"><a href="#cb29-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">add_recipe</span>(nb_rec)</span>
<span id="cb29-5"><a href="#cb29-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb29-6"><a href="#cb29-6" aria-hidden="true" tabindex="-1"></a>nb_wflow</span></code><button title="Скопировать текст" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>══ Workflow ════════════════════════════════════════════════════════════════════
Preprocessor: Recipe
Model: naive_Bayes()

── Preprocessor ────────────────────────────────────────────────────────────────
0 Recipe Steps

── Model ───────────────────────────────────────────────────────────────────────
Naive Bayes Model Specification (classification)

Main Arguments:
  smoothness = tune()
  Laplace = tune()

Computational engine: naivebayes </code></pre>
</div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb31"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb31-1"><a href="#cb31-1" aria-hidden="true" tabindex="-1"></a>nb_tune <span class="ot">&lt;-</span> nb_wflow <span class="sc">|&gt;</span> </span>
<span id="cb31-2"><a href="#cb31-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">tune_grid</span>(</span>
<span id="cb31-3"><a href="#cb31-3" aria-hidden="true" tabindex="-1"></a>    <span class="at">resamples =</span> folds, </span>
<span id="cb31-4"><a href="#cb31-4" aria-hidden="true" tabindex="-1"></a>    <span class="at">grid =</span> nb_param <span class="sc">|&gt;</span> <span class="fu">grid_regular</span>(<span class="at">levels =</span> <span class="dv">5</span>),</span>
<span id="cb31-5"><a href="#cb31-5" aria-hidden="true" tabindex="-1"></a>    <span class="at">metrics =</span> <span class="fu">metric_set</span>(accuracy, f_meas, roc_auc),</span>
<span id="cb31-6"><a href="#cb31-6" aria-hidden="true" tabindex="-1"></a>    <span class="at">control =</span> <span class="fu">control_resamples</span>(<span class="at">save_pred =</span> <span class="cn">TRUE</span>)</span>
<span id="cb31-7"><a href="#cb31-7" aria-hidden="true" tabindex="-1"></a>  )</span>
<span id="cb31-8"><a href="#cb31-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb31-9"><a href="#cb31-9" aria-hidden="true" tabindex="-1"></a>nb_tune </span></code><button title="Скопировать текст" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div data-pagedtable="false">
  <script data-pagedtable-source="" type="application/json">
{"columns":[{"label":["splits"],"name":[1],"type":["list"],"align":["right"]},{"label":["id"],"name":[2],"type":["chr"],"align":["left"]},{"label":[".metrics"],"name":[3],"type":["list"],"align":["right"]},{"label":[".notes"],"name":[4],"type":["list"],"align":["right"]},{"label":[".predictions"],"name":[5],"type":["list"],"align":["right"]}],"data":[{"1":"<S3: vfold_split>","2":"Fold01","3":"<tibble[,6]>","4":"<tibble[,3]>","5":"<tibble[,8]>"},{"1":"<S3: vfold_split>","2":"Fold02","3":"<tibble[,6]>","4":"<tibble[,3]>","5":"<tibble[,8]>"},{"1":"<S3: vfold_split>","2":"Fold03","3":"<tibble[,6]>","4":"<tibble[,3]>","5":"<tibble[,8]>"},{"1":"<S3: vfold_split>","2":"Fold04","3":"<tibble[,6]>","4":"<tibble[,3]>","5":"<tibble[,8]>"},{"1":"<S3: vfold_split>","2":"Fold05","3":"<tibble[,6]>","4":"<tibble[,3]>","5":"<tibble[,8]>"},{"1":"<S3: vfold_split>","2":"Fold06","3":"<tibble[,6]>","4":"<tibble[,3]>","5":"<tibble[,8]>"},{"1":"<S3: vfold_split>","2":"Fold07","3":"<tibble[,6]>","4":"<tibble[,3]>","5":"<tibble[,8]>"},{"1":"<S3: vfold_split>","2":"Fold08","3":"<tibble[,6]>","4":"<tibble[,3]>","5":"<tibble[,8]>"},{"1":"<S3: vfold_split>","2":"Fold09","3":"<tibble[,6]>","4":"<tibble[,3]>","5":"<tibble[,8]>"},{"1":"<S3: vfold_split>","2":"Fold10","3":"<tibble[,6]>","4":"<tibble[,3]>","5":"<tibble[,8]>"}],"options":{"columns":{"min":{},"max":[10]},"rows":{"min":[10],"max":[10]},"pages":{}}}
  </script>
</div>
</div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb32"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb32-1"><a href="#cb32-1" aria-hidden="true" tabindex="-1"></a><span class="fu">collect_metrics</span>(nb_tune)</span></code><button title="Скопировать текст" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div data-pagedtable="false">
  <script data-pagedtable-source="" type="application/json">
{"columns":[{"label":["smoothness"],"name":[1],"type":["dbl"],"align":["right"]},{"label":["Laplace"],"name":[2],"type":["dbl"],"align":["right"]},{"label":[".metric"],"name":[3],"type":["chr"],"align":["left"]},{"label":[".estimator"],"name":[4],"type":["chr"],"align":["left"]},{"label":["mean"],"name":[5],"type":["dbl"],"align":["right"]},{"label":["n"],"name":[6],"type":["int"],"align":["right"]},{"label":["std_err"],"name":[7],"type":["dbl"],"align":["right"]},{"label":[".config"],"name":[8],"type":["chr"],"align":["left"]}],"data":[{"1":"0.50","2":"0.00","3":"accuracy","4":"binary","5":"0.8333333","6":"10","7":"0.04993823","8":"Preprocessor1_Model01"},{"1":"0.50","2":"0.00","3":"f_meas","4":"binary","5":"0.9016667","6":"10","7":"0.03033930","8":"Preprocessor1_Model01"},{"1":"0.50","2":"0.00","3":"roc_auc","4":"binary","5":"0.8875000","6":"10","7":"0.07557649","8":"Preprocessor1_Model01"},{"1":"0.75","2":"0.00","3":"accuracy","4":"binary","5":"0.8500000","6":"10","7":"0.03557291","8":"Preprocessor1_Model02"},{"1":"0.75","2":"0.00","3":"f_meas","4":"binary","5":"0.9101587","6":"10","7":"0.02145331","8":"Preprocessor1_Model02"},{"1":"0.75","2":"0.00","3":"roc_auc","4":"binary","5":"0.9750000","6":"10","7":"0.02500000","8":"Preprocessor1_Model02"},{"1":"1.00","2":"0.00","3":"accuracy","4":"binary","5":"0.9033333","6":"10","7":"0.03237512","8":"Preprocessor1_Model03"},{"1":"1.00","2":"0.00","3":"f_meas","4":"binary","5":"0.9412698","6":"10","7":"0.01980420","8":"Preprocessor1_Model03"},{"1":"1.00","2":"0.00","3":"roc_auc","4":"binary","5":"0.9750000","6":"10","7":"0.02500000","8":"Preprocessor1_Model03"},{"1":"1.25","2":"0.00","3":"accuracy","4":"binary","5":"0.8866667","6":"10","7":"0.03111111","8":"Preprocessor1_Model04"},{"1":"1.25","2":"0.00","3":"f_meas","4":"binary","5":"0.9269841","6":"10","7":"0.02024458","8":"Preprocessor1_Model04"},{"1":"1.25","2":"0.00","3":"roc_auc","4":"binary","5":"0.9750000","6":"10","7":"0.02500000","8":"Preprocessor1_Model04"},{"1":"1.50","2":"0.00","3":"accuracy","4":"binary","5":"0.8700000","6":"10","7":"0.03798960","8":"Preprocessor1_Model05"},{"1":"1.50","2":"0.00","3":"f_meas","4":"binary","5":"0.9149206","6":"10","7":"0.02438826","8":"Preprocessor1_Model05"},{"1":"1.50","2":"0.00","3":"roc_auc","4":"binary","5":"0.9500000","6":"10","7":"0.03333333","8":"Preprocessor1_Model05"},{"1":"0.50","2":"0.75","3":"accuracy","4":"binary","5":"0.8333333","6":"10","7":"0.04993823","8":"Preprocessor1_Model06"},{"1":"0.50","2":"0.75","3":"f_meas","4":"binary","5":"0.9016667","6":"10","7":"0.03033930","8":"Preprocessor1_Model06"},{"1":"0.50","2":"0.75","3":"roc_auc","4":"binary","5":"0.8875000","6":"10","7":"0.07557649","8":"Preprocessor1_Model06"},{"1":"0.75","2":"0.75","3":"accuracy","4":"binary","5":"0.8500000","6":"10","7":"0.03557291","8":"Preprocessor1_Model07"},{"1":"0.75","2":"0.75","3":"f_meas","4":"binary","5":"0.9101587","6":"10","7":"0.02145331","8":"Preprocessor1_Model07"},{"1":"0.75","2":"0.75","3":"roc_auc","4":"binary","5":"0.9750000","6":"10","7":"0.02500000","8":"Preprocessor1_Model07"},{"1":"1.00","2":"0.75","3":"accuracy","4":"binary","5":"0.9033333","6":"10","7":"0.03237512","8":"Preprocessor1_Model08"},{"1":"1.00","2":"0.75","3":"f_meas","4":"binary","5":"0.9412698","6":"10","7":"0.01980420","8":"Preprocessor1_Model08"},{"1":"1.00","2":"0.75","3":"roc_auc","4":"binary","5":"0.9750000","6":"10","7":"0.02500000","8":"Preprocessor1_Model08"},{"1":"1.25","2":"0.75","3":"accuracy","4":"binary","5":"0.8866667","6":"10","7":"0.03111111","8":"Preprocessor1_Model09"},{"1":"1.25","2":"0.75","3":"f_meas","4":"binary","5":"0.9269841","6":"10","7":"0.02024458","8":"Preprocessor1_Model09"},{"1":"1.25","2":"0.75","3":"roc_auc","4":"binary","5":"0.9750000","6":"10","7":"0.02500000","8":"Preprocessor1_Model09"},{"1":"1.50","2":"0.75","3":"accuracy","4":"binary","5":"0.8700000","6":"10","7":"0.03798960","8":"Preprocessor1_Model10"},{"1":"1.50","2":"0.75","3":"f_meas","4":"binary","5":"0.9149206","6":"10","7":"0.02438826","8":"Preprocessor1_Model10"},{"1":"1.50","2":"0.75","3":"roc_auc","4":"binary","5":"0.9500000","6":"10","7":"0.03333333","8":"Preprocessor1_Model10"},{"1":"0.50","2":"1.50","3":"accuracy","4":"binary","5":"0.8333333","6":"10","7":"0.04993823","8":"Preprocessor1_Model11"},{"1":"0.50","2":"1.50","3":"f_meas","4":"binary","5":"0.9016667","6":"10","7":"0.03033930","8":"Preprocessor1_Model11"},{"1":"0.50","2":"1.50","3":"roc_auc","4":"binary","5":"0.8875000","6":"10","7":"0.07557649","8":"Preprocessor1_Model11"},{"1":"0.75","2":"1.50","3":"accuracy","4":"binary","5":"0.8500000","6":"10","7":"0.03557291","8":"Preprocessor1_Model12"},{"1":"0.75","2":"1.50","3":"f_meas","4":"binary","5":"0.9101587","6":"10","7":"0.02145331","8":"Preprocessor1_Model12"},{"1":"0.75","2":"1.50","3":"roc_auc","4":"binary","5":"0.9750000","6":"10","7":"0.02500000","8":"Preprocessor1_Model12"},{"1":"1.00","2":"1.50","3":"accuracy","4":"binary","5":"0.9033333","6":"10","7":"0.03237512","8":"Preprocessor1_Model13"},{"1":"1.00","2":"1.50","3":"f_meas","4":"binary","5":"0.9412698","6":"10","7":"0.01980420","8":"Preprocessor1_Model13"},{"1":"1.00","2":"1.50","3":"roc_auc","4":"binary","5":"0.9750000","6":"10","7":"0.02500000","8":"Preprocessor1_Model13"},{"1":"1.25","2":"1.50","3":"accuracy","4":"binary","5":"0.8866667","6":"10","7":"0.03111111","8":"Preprocessor1_Model14"},{"1":"1.25","2":"1.50","3":"f_meas","4":"binary","5":"0.9269841","6":"10","7":"0.02024458","8":"Preprocessor1_Model14"},{"1":"1.25","2":"1.50","3":"roc_auc","4":"binary","5":"0.9750000","6":"10","7":"0.02500000","8":"Preprocessor1_Model14"},{"1":"1.50","2":"1.50","3":"accuracy","4":"binary","5":"0.8700000","6":"10","7":"0.03798960","8":"Preprocessor1_Model15"},{"1":"1.50","2":"1.50","3":"f_meas","4":"binary","5":"0.9149206","6":"10","7":"0.02438826","8":"Preprocessor1_Model15"},{"1":"1.50","2":"1.50","3":"roc_auc","4":"binary","5":"0.9500000","6":"10","7":"0.03333333","8":"Preprocessor1_Model15"},{"1":"0.50","2":"2.25","3":"accuracy","4":"binary","5":"0.8333333","6":"10","7":"0.04993823","8":"Preprocessor1_Model16"},{"1":"0.50","2":"2.25","3":"f_meas","4":"binary","5":"0.9016667","6":"10","7":"0.03033930","8":"Preprocessor1_Model16"},{"1":"0.50","2":"2.25","3":"roc_auc","4":"binary","5":"0.8875000","6":"10","7":"0.07557649","8":"Preprocessor1_Model16"},{"1":"0.75","2":"2.25","3":"accuracy","4":"binary","5":"0.8500000","6":"10","7":"0.03557291","8":"Preprocessor1_Model17"},{"1":"0.75","2":"2.25","3":"f_meas","4":"binary","5":"0.9101587","6":"10","7":"0.02145331","8":"Preprocessor1_Model17"},{"1":"0.75","2":"2.25","3":"roc_auc","4":"binary","5":"0.9750000","6":"10","7":"0.02500000","8":"Preprocessor1_Model17"},{"1":"1.00","2":"2.25","3":"accuracy","4":"binary","5":"0.9033333","6":"10","7":"0.03237512","8":"Preprocessor1_Model18"},{"1":"1.00","2":"2.25","3":"f_meas","4":"binary","5":"0.9412698","6":"10","7":"0.01980420","8":"Preprocessor1_Model18"},{"1":"1.00","2":"2.25","3":"roc_auc","4":"binary","5":"0.9750000","6":"10","7":"0.02500000","8":"Preprocessor1_Model18"},{"1":"1.25","2":"2.25","3":"accuracy","4":"binary","5":"0.8866667","6":"10","7":"0.03111111","8":"Preprocessor1_Model19"},{"1":"1.25","2":"2.25","3":"f_meas","4":"binary","5":"0.9269841","6":"10","7":"0.02024458","8":"Preprocessor1_Model19"},{"1":"1.25","2":"2.25","3":"roc_auc","4":"binary","5":"0.9750000","6":"10","7":"0.02500000","8":"Preprocessor1_Model19"},{"1":"1.50","2":"2.25","3":"accuracy","4":"binary","5":"0.8700000","6":"10","7":"0.03798960","8":"Preprocessor1_Model20"},{"1":"1.50","2":"2.25","3":"f_meas","4":"binary","5":"0.9149206","6":"10","7":"0.02438826","8":"Preprocessor1_Model20"},{"1":"1.50","2":"2.25","3":"roc_auc","4":"binary","5":"0.9500000","6":"10","7":"0.03333333","8":"Preprocessor1_Model20"},{"1":"0.50","2":"3.00","3":"accuracy","4":"binary","5":"0.8333333","6":"10","7":"0.04993823","8":"Preprocessor1_Model21"},{"1":"0.50","2":"3.00","3":"f_meas","4":"binary","5":"0.9016667","6":"10","7":"0.03033930","8":"Preprocessor1_Model21"},{"1":"0.50","2":"3.00","3":"roc_auc","4":"binary","5":"0.8875000","6":"10","7":"0.07557649","8":"Preprocessor1_Model21"},{"1":"0.75","2":"3.00","3":"accuracy","4":"binary","5":"0.8500000","6":"10","7":"0.03557291","8":"Preprocessor1_Model22"},{"1":"0.75","2":"3.00","3":"f_meas","4":"binary","5":"0.9101587","6":"10","7":"0.02145331","8":"Preprocessor1_Model22"},{"1":"0.75","2":"3.00","3":"roc_auc","4":"binary","5":"0.9750000","6":"10","7":"0.02500000","8":"Preprocessor1_Model22"},{"1":"1.00","2":"3.00","3":"accuracy","4":"binary","5":"0.9033333","6":"10","7":"0.03237512","8":"Preprocessor1_Model23"},{"1":"1.00","2":"3.00","3":"f_meas","4":"binary","5":"0.9412698","6":"10","7":"0.01980420","8":"Preprocessor1_Model23"},{"1":"1.00","2":"3.00","3":"roc_auc","4":"binary","5":"0.9750000","6":"10","7":"0.02500000","8":"Preprocessor1_Model23"},{"1":"1.25","2":"3.00","3":"accuracy","4":"binary","5":"0.8866667","6":"10","7":"0.03111111","8":"Preprocessor1_Model24"},{"1":"1.25","2":"3.00","3":"f_meas","4":"binary","5":"0.9269841","6":"10","7":"0.02024458","8":"Preprocessor1_Model24"},{"1":"1.25","2":"3.00","3":"roc_auc","4":"binary","5":"0.9750000","6":"10","7":"0.02500000","8":"Preprocessor1_Model24"},{"1":"1.50","2":"3.00","3":"accuracy","4":"binary","5":"0.8700000","6":"10","7":"0.03798960","8":"Preprocessor1_Model25"},{"1":"1.50","2":"3.00","3":"f_meas","4":"binary","5":"0.9149206","6":"10","7":"0.02438826","8":"Preprocessor1_Model25"},{"1":"1.50","2":"3.00","3":"roc_auc","4":"binary","5":"0.9500000","6":"10","7":"0.03333333","8":"Preprocessor1_Model25"}],"options":{"columns":{"min":{},"max":[10]},"rows":{"min":[10],"max":[10]},"pages":{}}}
  </script>
</div>
</div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb33"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb33-1"><a href="#cb33-1" aria-hidden="true" tabindex="-1"></a><span class="fu">autoplot</span>(nb_tune)</span></code><button title="Скопировать текст" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="classification_files/figure-html/unnamed-chunk-29-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb34"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb34-1"><a href="#cb34-1" aria-hidden="true" tabindex="-1"></a><span class="fu">show_best</span>(nb_tune, <span class="at">n =</span> <span class="dv">1</span>)</span></code><button title="Скопировать текст" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stderr">
<pre><code>Warning in show_best(nb_tune, n = 1): No value of `metric` was given;
"accuracy" will be used.</code></pre>
</div>
<div class="cell-output-display">
<div data-pagedtable="false">
  <script data-pagedtable-source="" type="application/json">
{"columns":[{"label":["smoothness"],"name":[1],"type":["dbl"],"align":["right"]},{"label":["Laplace"],"name":[2],"type":["dbl"],"align":["right"]},{"label":[".metric"],"name":[3],"type":["chr"],"align":["left"]},{"label":[".estimator"],"name":[4],"type":["chr"],"align":["left"]},{"label":["mean"],"name":[5],"type":["dbl"],"align":["right"]},{"label":["n"],"name":[6],"type":["int"],"align":["right"]},{"label":["std_err"],"name":[7],"type":["dbl"],"align":["right"]},{"label":[".config"],"name":[8],"type":["chr"],"align":["left"]}],"data":[{"1":"1","2":"0","3":"accuracy","4":"binary","5":"0.9033333","6":"10","7":"0.03237512","8":"Preprocessor1_Model03"}],"options":{"columns":{"min":{},"max":[10]},"rows":{"min":[10],"max":[10]},"pages":{}}}
  </script>
</div>
</div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb36"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb36-1"><a href="#cb36-1" aria-hidden="true" tabindex="-1"></a>nb_best <span class="ot">&lt;-</span> <span class="fu">select_best</span>(nb_tune, <span class="at">metric =</span> <span class="st">"accuracy"</span>)</span>
<span id="cb36-2"><a href="#cb36-2" aria-hidden="true" tabindex="-1"></a>nb_best</span></code><button title="Скопировать текст" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div data-pagedtable="false">
  <script data-pagedtable-source="" type="application/json">
{"columns":[{"label":["smoothness"],"name":[1],"type":["dbl"],"align":["right"]},{"label":["Laplace"],"name":[2],"type":["dbl"],"align":["right"]},{"label":[".config"],"name":[3],"type":["chr"],"align":["left"]}],"data":[{"1":"1","2":"0","3":"Preprocessor1_Model03"}],"options":{"columns":{"min":{},"max":[10]},"rows":{"min":[10],"max":[10]},"pages":{}}}
  </script>
</div>
</div>
</div>
</section>
<section id="матрица-смешения-1" class="level3" data-number="24.4.5">
<h3 data-number="24.4.5" class="anchored" data-anchor-id="матрица-смешения-1"><span class="header-section-number">24.4.5</span> Матрица смешения</h3>
<p>Напомним, что в обучающих данных всего 52 текста, из них 40 принадлежит Гамильтону, а 12 – Мэдисону.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb37"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb37-1"><a href="#cb37-1" aria-hidden="true" tabindex="-1"></a><span class="fu">conf_mat_resampled</span>(nb_tune, <span class="at">tidy =</span> <span class="cn">FALSE</span>, <span class="at">parameters =</span> nb_best) <span class="sc">|&gt;</span> </span>
<span id="cb37-2"><a href="#cb37-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">autoplot</span>(<span class="at">type =</span> <span class="st">"heatmap"</span>) <span class="sc">+</span></span>
<span id="cb37-3"><a href="#cb37-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_fill_gradient</span>(<span class="at">low =</span> <span class="st">"#eaeff6"</span>, <span class="at">high =</span> <span class="st">"#233857"</span>) <span class="sc">+</span></span>
<span id="cb37-4"><a href="#cb37-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">panel.grid.major =</span> <span class="fu">element_line</span>(<span class="at">colour =</span> <span class="st">"#233857"</span>),</span>
<span id="cb37-5"><a href="#cb37-5" aria-hidden="true" tabindex="-1"></a>        <span class="at">axis.text =</span> <span class="fu">element_text</span>(<span class="at">color =</span> <span class="st">"#233857"</span>),</span>
<span id="cb37-6"><a href="#cb37-6" aria-hidden="true" tabindex="-1"></a>        <span class="at">axis.title =</span> <span class="fu">element_text</span>(<span class="at">color =</span> <span class="st">"#233857"</span>),</span>
<span id="cb37-7"><a href="#cb37-7" aria-hidden="true" tabindex="-1"></a>        <span class="at">plot.title =</span> <span class="fu">element_text</span>(<span class="at">color =</span> <span class="st">"#233857"</span>)) <span class="sc">+</span></span>
<span id="cb37-8"><a href="#cb37-8" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggtitle</span>(<span class="st">"NB, 70 признаков"</span>)</span></code><button title="Скопировать текст" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="classification_files/figure-html/unnamed-chunk-32-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
</section>
<section id="roc-кривая-1" class="level3" data-number="24.4.6">
<h3 data-number="24.4.6" class="anchored" data-anchor-id="roc-кривая-1"><span class="header-section-number">24.4.6</span> ROC-кривая</h3>
<div class="cell">
<div class="sourceCode cell-code" id="cb38"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb38-1"><a href="#cb38-1" aria-hidden="true" tabindex="-1"></a>nb_predictions <span class="ot">&lt;-</span> nb_tune <span class="sc">|&gt;</span> </span>
<span id="cb38-2"><a href="#cb38-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">collect_predictions</span>(<span class="at">parameters =</span> nb_best) <span class="sc">|&gt;</span> </span>
<span id="cb38-3"><a href="#cb38-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate_if</span>(is.numeric, round, <span class="dv">3</span>)</span>
<span id="cb38-4"><a href="#cb38-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb38-5"><a href="#cb38-5" aria-hidden="true" tabindex="-1"></a>nb_predictions</span></code><button title="Скопировать текст" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div data-pagedtable="false">
  <script data-pagedtable-source="" type="application/json">
{"columns":[{"label":[".pred_class"],"name":[1],"type":["fct"],"align":["left"]},{"label":[".pred_Hamilton"],"name":[2],"type":["dbl"],"align":["right"]},{"label":[".pred_Madison"],"name":[3],"type":["dbl"],"align":["right"]},{"label":["id"],"name":[4],"type":["chr"],"align":["left"]},{"label":[".row"],"name":[5],"type":["dbl"],"align":["right"]},{"label":["smoothness"],"name":[6],"type":["dbl"],"align":["right"]},{"label":["Laplace"],"name":[7],"type":["dbl"],"align":["right"]},{"label":["author"],"name":[8],"type":["fct"],"align":["left"]},{"label":[".config"],"name":[9],"type":["chr"],"align":["left"]}],"data":[{"1":"Hamilton","2":"1.000","3":"0.000","4":"Fold01","5":"5","6":"1","7":"0","8":"Hamilton","9":"Preprocessor1_Model03"},{"1":"Hamilton","2":"1.000","3":"0.000","4":"Fold01","5":"12","6":"1","7":"0","8":"Hamilton","9":"Preprocessor1_Model03"},{"1":"Hamilton","2":"1.000","3":"0.000","4":"Fold01","5":"19","6":"1","7":"0","8":"Hamilton","9":"Preprocessor1_Model03"},{"1":"Hamilton","2":"1.000","3":"0.000","4":"Fold01","5":"33","6":"1","7":"0","8":"Hamilton","9":"Preprocessor1_Model03"},{"1":"Madison","2":"0.311","3":"0.689","4":"Fold01","5":"48","6":"1","7":"0","8":"Madison","9":"Preprocessor1_Model03"},{"1":"Madison","2":"0.110","3":"0.890","4":"Fold01","5":"50","6":"1","7":"0","8":"Madison","9":"Preprocessor1_Model03"},{"1":"Hamilton","2":"1.000","3":"0.000","4":"Fold02","5":"11","6":"1","7":"0","8":"Hamilton","9":"Preprocessor1_Model03"},{"1":"Hamilton","2":"1.000","3":"0.000","4":"Fold02","5":"16","6":"1","7":"0","8":"Hamilton","9":"Preprocessor1_Model03"},{"1":"Hamilton","2":"1.000","3":"0.000","4":"Fold02","5":"28","6":"1","7":"0","8":"Hamilton","9":"Preprocessor1_Model03"},{"1":"Hamilton","2":"1.000","3":"0.000","4":"Fold02","5":"31","6":"1","7":"0","8":"Hamilton","9":"Preprocessor1_Model03"},{"1":"Madison","2":"0.013","3":"0.987","4":"Fold02","5":"42","6":"1","7":"0","8":"Madison","9":"Preprocessor1_Model03"},{"1":"Hamilton","2":"0.960","3":"0.040","4":"Fold02","5":"52","6":"1","7":"0","8":"Madison","9":"Preprocessor1_Model03"},{"1":"Hamilton","2":"1.000","3":"0.000","4":"Fold03","5":"2","6":"1","7":"0","8":"Hamilton","9":"Preprocessor1_Model03"},{"1":"Hamilton","2":"0.772","3":"0.228","4":"Fold03","5":"4","6":"1","7":"0","8":"Hamilton","9":"Preprocessor1_Model03"},{"1":"Hamilton","2":"1.000","3":"0.000","4":"Fold03","5":"21","6":"1","7":"0","8":"Hamilton","9":"Preprocessor1_Model03"},{"1":"Hamilton","2":"1.000","3":"0.000","4":"Fold03","5":"36","6":"1","7":"0","8":"Hamilton","9":"Preprocessor1_Model03"},{"1":"Madison","2":"0.000","3":"1.000","4":"Fold03","5":"46","6":"1","7":"0","8":"Madison","9":"Preprocessor1_Model03"},{"1":"Hamilton","2":"1.000","3":"0.000","4":"Fold04","5":"6","6":"1","7":"0","8":"Hamilton","9":"Preprocessor1_Model03"},{"1":"Hamilton","2":"1.000","3":"0.000","4":"Fold04","5":"26","6":"1","7":"0","8":"Hamilton","9":"Preprocessor1_Model03"},{"1":"Hamilton","2":"1.000","3":"0.000","4":"Fold04","5":"34","6":"1","7":"0","8":"Hamilton","9":"Preprocessor1_Model03"},{"1":"Hamilton","2":"1.000","3":"0.000","4":"Fold04","5":"39","6":"1","7":"0","8":"Hamilton","9":"Preprocessor1_Model03"},{"1":"Madison","2":"0.000","3":"1.000","4":"Fold04","5":"51","6":"1","7":"0","8":"Madison","9":"Preprocessor1_Model03"},{"1":"Hamilton","2":"1.000","3":"0.000","4":"Fold05","5":"15","6":"1","7":"0","8":"Hamilton","9":"Preprocessor1_Model03"},{"1":"Hamilton","2":"1.000","3":"0.000","4":"Fold05","5":"24","6":"1","7":"0","8":"Hamilton","9":"Preprocessor1_Model03"},{"1":"Hamilton","2":"1.000","3":"0.000","4":"Fold05","5":"30","6":"1","7":"0","8":"Hamilton","9":"Preprocessor1_Model03"},{"1":"Hamilton","2":"1.000","3":"0.000","4":"Fold05","5":"32","6":"1","7":"0","8":"Hamilton","9":"Preprocessor1_Model03"},{"1":"Hamilton","2":"0.987","3":"0.013","4":"Fold05","5":"44","6":"1","7":"0","8":"Madison","9":"Preprocessor1_Model03"},{"1":"Hamilton","2":"1.000","3":"0.000","4":"Fold06","5":"3","6":"1","7":"0","8":"Hamilton","9":"Preprocessor1_Model03"},{"1":"Hamilton","2":"1.000","3":"0.000","4":"Fold06","5":"22","6":"1","7":"0","8":"Hamilton","9":"Preprocessor1_Model03"},{"1":"Hamilton","2":"1.000","3":"0.000","4":"Fold06","5":"37","6":"1","7":"0","8":"Hamilton","9":"Preprocessor1_Model03"},{"1":"Hamilton","2":"1.000","3":"0.000","4":"Fold06","5":"38","6":"1","7":"0","8":"Hamilton","9":"Preprocessor1_Model03"},{"1":"Hamilton","2":"1.000","3":"0.000","4":"Fold06","5":"41","6":"1","7":"0","8":"Madison","9":"Preprocessor1_Model03"},{"1":"Madison","2":"0.000","3":"1.000","4":"Fold07","5":"1","6":"1","7":"0","8":"Hamilton","9":"Preprocessor1_Model03"},{"1":"Hamilton","2":"1.000","3":"0.000","4":"Fold07","5":"10","6":"1","7":"0","8":"Hamilton","9":"Preprocessor1_Model03"},{"1":"Hamilton","2":"1.000","3":"0.000","4":"Fold07","5":"27","6":"1","7":"0","8":"Hamilton","9":"Preprocessor1_Model03"},{"1":"Hamilton","2":"1.000","3":"0.000","4":"Fold07","5":"29","6":"1","7":"0","8":"Hamilton","9":"Preprocessor1_Model03"},{"1":"Madison","2":"0.103","3":"0.897","4":"Fold07","5":"43","6":"1","7":"0","8":"Madison","9":"Preprocessor1_Model03"},{"1":"Hamilton","2":"1.000","3":"0.000","4":"Fold08","5":"13","6":"1","7":"0","8":"Hamilton","9":"Preprocessor1_Model03"},{"1":"Hamilton","2":"1.000","3":"0.000","4":"Fold08","5":"14","6":"1","7":"0","8":"Hamilton","9":"Preprocessor1_Model03"},{"1":"Hamilton","2":"1.000","3":"0.000","4":"Fold08","5":"17","6":"1","7":"0","8":"Hamilton","9":"Preprocessor1_Model03"},{"1":"Hamilton","2":"1.000","3":"0.000","4":"Fold08","5":"20","6":"1","7":"0","8":"Hamilton","9":"Preprocessor1_Model03"},{"1":"Madison","2":"0.000","3":"1.000","4":"Fold08","5":"47","6":"1","7":"0","8":"Madison","9":"Preprocessor1_Model03"},{"1":"Hamilton","2":"1.000","3":"0.000","4":"Fold09","5":"7","6":"1","7":"0","8":"Hamilton","9":"Preprocessor1_Model03"},{"1":"Hamilton","2":"1.000","3":"0.000","4":"Fold09","5":"8","6":"1","7":"0","8":"Hamilton","9":"Preprocessor1_Model03"},{"1":"Hamilton","2":"1.000","3":"0.000","4":"Fold09","5":"35","6":"1","7":"0","8":"Hamilton","9":"Preprocessor1_Model03"},{"1":"Hamilton","2":"1.000","3":"0.000","4":"Fold09","5":"40","6":"1","7":"0","8":"Hamilton","9":"Preprocessor1_Model03"},{"1":"Hamilton","2":"1.000","3":"0.000","4":"Fold09","5":"45","6":"1","7":"0","8":"Madison","9":"Preprocessor1_Model03"},{"1":"Hamilton","2":"1.000","3":"0.000","4":"Fold10","5":"9","6":"1","7":"0","8":"Hamilton","9":"Preprocessor1_Model03"},{"1":"Hamilton","2":"1.000","3":"0.000","4":"Fold10","5":"18","6":"1","7":"0","8":"Hamilton","9":"Preprocessor1_Model03"},{"1":"Hamilton","2":"1.000","3":"0.000","4":"Fold10","5":"23","6":"1","7":"0","8":"Hamilton","9":"Preprocessor1_Model03"},{"1":"Hamilton","2":"1.000","3":"0.000","4":"Fold10","5":"25","6":"1","7":"0","8":"Hamilton","9":"Preprocessor1_Model03"},{"1":"Madison","2":"0.000","3":"1.000","4":"Fold10","5":"49","6":"1","7":"0","8":"Madison","9":"Preprocessor1_Model03"}],"options":{"columns":{"min":{},"max":[10]},"rows":{"min":[10],"max":[10]},"pages":{}}}
  </script>
</div>
</div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb39"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb39-1"><a href="#cb39-1" aria-hidden="true" tabindex="-1"></a>nb_predictions <span class="sc">|&gt;</span> </span>
<span id="cb39-2"><a href="#cb39-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">roc_curve</span>(author, .pred_Hamilton) <span class="sc">|&gt;</span> </span>
<span id="cb39-3"><a href="#cb39-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">autoplot</span>() </span></code><button title="Скопировать текст" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="classification_files/figure-html/unnamed-chunk-34-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
<p>Результат чуть хуже, чем дает LDA, так что применять этот алгоритм к спорным текстам мы не будем.</p>
<p>Для сравнения различных методов бывает полезно вывести на одном графике несколько моделей.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb40"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb40-1"><a href="#cb40-1" aria-hidden="true" tabindex="-1"></a>lda_predictions <span class="sc">|&gt;</span> </span>
<span id="cb40-2"><a href="#cb40-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">roc_curve</span>(author, .pred_Hamilton) <span class="sc">|&gt;</span> </span>
<span id="cb40-3"><a href="#cb40-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">model =</span> <span class="st">"LDA"</span>) <span class="sc">|&gt;</span> </span>
<span id="cb40-4"><a href="#cb40-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">bind_rows</span>(nb_predictions <span class="sc">|&gt;</span> </span>
<span id="cb40-5"><a href="#cb40-5" aria-hidden="true" tabindex="-1"></a>              <span class="fu">roc_curve</span>(author, .pred_Hamilton) <span class="sc">|&gt;</span> </span>
<span id="cb40-6"><a href="#cb40-6" aria-hidden="true" tabindex="-1"></a>              <span class="fu">mutate</span>(<span class="at">model =</span> <span class="st">"NB"</span>)) <span class="sc">|&gt;</span> </span>
<span id="cb40-7"><a href="#cb40-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggplot</span>(<span class="fu">aes</span>(<span class="at">x =</span> <span class="dv">1</span> <span class="sc">-</span> specificity, <span class="at">y =</span> sensitivity, <span class="at">col =</span> model)) <span class="sc">+</span> </span>
<span id="cb40-8"><a href="#cb40-8" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_path</span>(<span class="at">lwd =</span> <span class="fl">1.5</span>, <span class="at">alpha =</span> <span class="fl">0.8</span>) <span class="sc">+</span></span>
<span id="cb40-9"><a href="#cb40-9" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_abline</span>(<span class="at">lty =</span> <span class="dv">3</span>) <span class="sc">+</span> </span>
<span id="cb40-10"><a href="#cb40-10" aria-hidden="true" tabindex="-1"></a>  <span class="fu">coord_equal</span>() <span class="sc">+</span> </span>
<span id="cb40-11"><a href="#cb40-11" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_color_viridis_d</span>(<span class="at">option =</span> <span class="st">"plasma"</span>, <span class="at">end =</span> .<span class="dv">6</span>) <span class="sc">+</span></span>
<span id="cb40-12"><a href="#cb40-12" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_light</span>()</span></code><button title="Скопировать текст" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="classification_files/figure-html/unnamed-chunk-35-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>


</section>
</section>

</main> <!-- /main -->
<script>

/* update total correct if #webex-total_correct exists */
update_total_correct = function() {
  console.log("webex: update total_correct");

  var t = document.getElementsByClassName("webex-total_correct");
  for (var i = 0; i < t.length; i++) {
    p = t[i].parentElement;
    var correct = p.getElementsByClassName("webex-correct").length;
    var solvemes = p.getElementsByClassName("webex-solveme").length;
    var radiogroups = p.getElementsByClassName("webex-radiogroup").length;
    var selects = p.getElementsByClassName("webex-select").length;

    t[i].innerHTML = correct + " of " + (solvemes + radiogroups + selects) + " correct";
  }
}

/* webex-solution button toggling function */
b_func = function() {
  console.log("webex: toggle hide");

  var cl = this.parentElement.classList;
  if (cl.contains('open')) {
    cl.remove("open");
  } else {
    cl.add("open");
  }
}

/* check answers */
check_func = function() {
  console.log("webex: check answers");

  var cl = this.parentElement.classList;
  if (cl.contains('unchecked')) {
    cl.remove("unchecked");
    this.innerHTML = "Hide Answers";
  } else {
    cl.add("unchecked");
    this.innerHTML = "Show Answers";
  }
}

/* function for checking solveme answers */
solveme_func = function(e) {
  console.log("webex: check solveme");

  var real_answers = JSON.parse(this.dataset.answer);
  var my_answer = this.value;
  var cl = this.classList;
  if (cl.contains("ignorecase")) {
    my_answer = my_answer.toLowerCase();
  }
  if (cl.contains("nospaces")) {
    my_answer = my_answer.replace(/ /g, "")
  }

  if (my_answer == "") {
    cl.remove("webex-correct");
    cl.remove("webex-incorrect");
  } else if (real_answers.includes(my_answer)) {
    cl.add("webex-correct");
    cl.remove("webex-incorrect");
  } else {
    cl.add("webex-incorrect");
    cl.remove("webex-correct");
  }

  // match numeric answers within a specified tolerance
  if(this.dataset.tol > 0){
    var tol = JSON.parse(this.dataset.tol);
    var matches = real_answers.map(x => Math.abs(x - my_answer) < tol)
    if (matches.reduce((a, b) => a + b, 0) > 0) {
      cl.add("webex-correct");
    } else {
      cl.remove("webex-correct");
    }
  }

  // added regex bit
  if (cl.contains("regex")){
    answer_regex = RegExp(real_answers.join("|"))
    if (answer_regex.test(my_answer)) {
      cl.add("webex-correct");
    }
  }

  update_total_correct();
}

/* function for checking select answers */
select_func = function(e) {
  console.log("webex: check select");

  var cl = this.classList

  /* add style */
  cl.remove("webex-incorrect");
  cl.remove("webex-correct");
  if (this.value == "answer") {
    cl.add("webex-correct");
  } else if (this.value != "blank") {
    cl.add("webex-incorrect");
  }

  update_total_correct();
}

/* function for checking radiogroups answers */
radiogroups_func = function(e) {
  console.log("webex: check radiogroups");

  var checked_button = document.querySelector('input[name=' + this.id + ']:checked');
  var cl = checked_button.parentElement.classList;
  var labels = checked_button.parentElement.parentElement.children;

  /* get rid of styles */
  for (i = 0; i < labels.length; i++) {
    labels[i].classList.remove("webex-incorrect");
    labels[i].classList.remove("webex-correct");
  }

  /* add style */
  if (checked_button.value == "answer") {
    cl.add("webex-correct");
  } else {
    cl.add("webex-incorrect");
  }

  update_total_correct();
}

window.onload = function() {
  console.log("webex onload");
  /* set up solution buttons */
  var buttons = document.getElementsByTagName("button");

  for (var i = 0; i < buttons.length; i++) {
    if (buttons[i].parentElement.classList.contains('webex-solution')) {
      buttons[i].onclick = b_func;
    }
  }

  var check_sections = document.getElementsByClassName("webex-check");
  console.log("check:", check_sections.length);
  for (var i = 0; i < check_sections.length; i++) {
    check_sections[i].classList.add("unchecked");

    let btn = document.createElement("button");
    btn.innerHTML = "Show Answers";
    btn.classList.add("webex-check-button");
    btn.onclick = check_func;
    check_sections[i].appendChild(btn);

    let spn = document.createElement("span");
    spn.classList.add("webex-total_correct");
    check_sections[i].appendChild(spn);
  }

  /* set up webex-solveme inputs */
  var solveme = document.getElementsByClassName("webex-solveme");

  for (var i = 0; i < solveme.length; i++) {
    /* make sure input boxes don't auto-anything */
    solveme[i].setAttribute("autocomplete","off");
    solveme[i].setAttribute("autocorrect", "off");
    solveme[i].setAttribute("autocapitalize", "off");
    solveme[i].setAttribute("spellcheck", "false");
    solveme[i].value = "";

    /* adjust answer for ignorecase or nospaces */
    var cl = solveme[i].classList;
    var real_answer = solveme[i].dataset.answer;
    if (cl.contains("ignorecase")) {
      real_answer = real_answer.toLowerCase();
    }
    if (cl.contains("nospaces")) {
      real_answer = real_answer.replace(/ /g, "");
    }
    solveme[i].dataset.answer = real_answer;

    /* attach checking function */
    solveme[i].onkeyup = solveme_func;
    solveme[i].onchange = solveme_func;

    solveme[i].insertAdjacentHTML("afterend", " <span class='webex-icon'></span>")
  }

  /* set up radiogroups */
  var radiogroups = document.getElementsByClassName("webex-radiogroup");
  for (var i = 0; i < radiogroups.length; i++) {
    radiogroups[i].onchange = radiogroups_func;
  }

  /* set up selects */
  var selects = document.getElementsByClassName("webex-select");
  for (var i = 0; i < selects.length; i++) {
    selects[i].onchange = select_func;
    selects[i].insertAdjacentHTML("afterend", " <span class='webex-icon'></span>")
  }

  update_total_correct();
}

</script>
<script id="quarto-html-after-body" type="application/javascript">
window.document.addEventListener("DOMContentLoaded", function (event) {
  const toggleBodyColorMode = (bsSheetEl) => {
    const mode = bsSheetEl.getAttribute("data-mode");
    const bodyEl = window.document.querySelector("body");
    if (mode === "dark") {
      bodyEl.classList.add("quarto-dark");
      bodyEl.classList.remove("quarto-light");
    } else {
      bodyEl.classList.add("quarto-light");
      bodyEl.classList.remove("quarto-dark");
    }
  }
  const toggleBodyColorPrimary = () => {
    const bsSheetEl = window.document.querySelector("link#quarto-bootstrap");
    if (bsSheetEl) {
      toggleBodyColorMode(bsSheetEl);
    }
  }
  toggleBodyColorPrimary();  
  const icon = "";
  const anchorJS = new window.AnchorJS();
  anchorJS.options = {
    placement: 'right',
    icon: icon
  };
  anchorJS.add('.anchored');
  const isCodeAnnotation = (el) => {
    for (const clz of el.classList) {
      if (clz.startsWith('code-annotation-')) {                     
        return true;
      }
    }
    return false;
  }
  const onCopySuccess = function(e) {
    // button target
    const button = e.trigger;
    // don't keep focus
    button.blur();
    // flash "checked"
    button.classList.add('code-copy-button-checked');
    var currentTitle = button.getAttribute("title");
    button.setAttribute("title", "Скопировано");
    let tooltip;
    if (window.bootstrap) {
      button.setAttribute("data-bs-toggle", "tooltip");
      button.setAttribute("data-bs-placement", "left");
      button.setAttribute("data-bs-title", "Скопировано");
      tooltip = new bootstrap.Tooltip(button, 
        { trigger: "manual", 
          customClass: "code-copy-button-tooltip",
          offset: [0, -8]});
      tooltip.show();    
    }
    setTimeout(function() {
      if (tooltip) {
        tooltip.hide();
        button.removeAttribute("data-bs-title");
        button.removeAttribute("data-bs-toggle");
        button.removeAttribute("data-bs-placement");
      }
      button.setAttribute("title", currentTitle);
      button.classList.remove('code-copy-button-checked');
    }, 1000);
    // clear code selection
    e.clearSelection();
  }
  const getTextToCopy = function(trigger) {
      const codeEl = trigger.previousElementSibling.cloneNode(true);
      for (const childEl of codeEl.children) {
        if (isCodeAnnotation(childEl)) {
          childEl.remove();
        }
      }
      return codeEl.innerText;
  }
  const clipboard = new window.ClipboardJS('.code-copy-button:not([data-in-quarto-modal])', {
    text: getTextToCopy
  });
  clipboard.on('success', onCopySuccess);
  if (window.document.getElementById('quarto-embedded-source-code-modal')) {
    // For code content inside modals, clipBoardJS needs to be initialized with a container option
    // TODO: Check when it could be a function (https://github.com/zenorocha/clipboard.js/issues/860)
    const clipboardModal = new window.ClipboardJS('.code-copy-button[data-in-quarto-modal]', {
      text: getTextToCopy,
      container: window.document.getElementById('quarto-embedded-source-code-modal')
    });
    clipboardModal.on('success', onCopySuccess);
  }
    var localhostRegex = new RegExp(/^(?:http|https):\/\/localhost\:?[0-9]*\//);
    var mailtoRegex = new RegExp(/^mailto:/);
      var filterRegex = new RegExp('/' + window.location.host + '/');
    var isInternal = (href) => {
        return filterRegex.test(href) || localhostRegex.test(href) || mailtoRegex.test(href);
    }
    // Inspect non-navigation links and adorn them if external
 	var links = window.document.querySelectorAll('a[href]:not(.nav-link):not(.navbar-brand):not(.toc-action):not(.sidebar-link):not(.sidebar-item-toggle):not(.pagination-link):not(.no-external):not([aria-hidden]):not(.dropdown-item):not(.quarto-navigation-tool):not(.about-link)');
    for (var i=0; i<links.length; i++) {
      const link = links[i];
      if (!isInternal(link.href)) {
        // undo the damage that might have been done by quarto-nav.js in the case of
        // links that we want to consider external
        if (link.dataset.originalHref !== undefined) {
          link.href = link.dataset.originalHref;
        }
      }
    }
  function tippyHover(el, contentFn, onTriggerFn, onUntriggerFn) {
    const config = {
      allowHTML: true,
      maxWidth: 500,
      delay: 100,
      arrow: false,
      appendTo: function(el) {
          return el.parentElement;
      },
      interactive: true,
      interactiveBorder: 10,
      theme: 'quarto',
      placement: 'bottom-start',
    };
    if (contentFn) {
      config.content = contentFn;
    }
    if (onTriggerFn) {
      config.onTrigger = onTriggerFn;
    }
    if (onUntriggerFn) {
      config.onUntrigger = onUntriggerFn;
    }
    window.tippy(el, config); 
  }
  const noterefs = window.document.querySelectorAll('a[role="doc-noteref"]');
  for (var i=0; i<noterefs.length; i++) {
    const ref = noterefs[i];
    tippyHover(ref, function() {
      // use id or data attribute instead here
      let href = ref.getAttribute('data-footnote-href') || ref.getAttribute('href');
      try { href = new URL(href).hash; } catch {}
      const id = href.replace(/^#\/?/, "");
      const note = window.document.getElementById(id);
      if (note) {
        return note.innerHTML;
      } else {
        return "";
      }
    });
  }
  const xrefs = window.document.querySelectorAll('a.quarto-xref');
  const processXRef = (id, note) => {
    // Strip column container classes
    const stripColumnClz = (el) => {
      el.classList.remove("page-full", "page-columns");
      if (el.children) {
        for (const child of el.children) {
          stripColumnClz(child);
        }
      }
    }
    stripColumnClz(note)
    if (id === null || id.startsWith('sec-')) {
      // Special case sections, only their first couple elements
      const container = document.createElement("div");
      if (note.children && note.children.length > 2) {
        container.appendChild(note.children[0].cloneNode(true));
        for (let i = 1; i < note.children.length; i++) {
          const child = note.children[i];
          if (child.tagName === "P" && child.innerText === "") {
            continue;
          } else {
            container.appendChild(child.cloneNode(true));
            break;
          }
        }
        if (window.Quarto?.typesetMath) {
          window.Quarto.typesetMath(container);
        }
        return container.innerHTML
      } else {
        if (window.Quarto?.typesetMath) {
          window.Quarto.typesetMath(note);
        }
        return note.innerHTML;
      }
    } else {
      // Remove any anchor links if they are present
      const anchorLink = note.querySelector('a.anchorjs-link');
      if (anchorLink) {
        anchorLink.remove();
      }
      if (window.Quarto?.typesetMath) {
        window.Quarto.typesetMath(note);
      }
      // TODO in 1.5, we should make sure this works without a callout special case
      if (note.classList.contains("callout")) {
        return note.outerHTML;
      } else {
        return note.innerHTML;
      }
    }
  }
  for (var i=0; i<xrefs.length; i++) {
    const xref = xrefs[i];
    tippyHover(xref, undefined, function(instance) {
      instance.disable();
      let url = xref.getAttribute('href');
      let hash = undefined; 
      if (url.startsWith('#')) {
        hash = url;
      } else {
        try { hash = new URL(url).hash; } catch {}
      }
      if (hash) {
        const id = hash.replace(/^#\/?/, "");
        const note = window.document.getElementById(id);
        if (note !== null) {
          try {
            const html = processXRef(id, note.cloneNode(true));
            instance.setContent(html);
          } finally {
            instance.enable();
            instance.show();
          }
        } else {
          // See if we can fetch this
          fetch(url.split('#')[0])
          .then(res => res.text())
          .then(html => {
            const parser = new DOMParser();
            const htmlDoc = parser.parseFromString(html, "text/html");
            const note = htmlDoc.getElementById(id);
            if (note !== null) {
              const html = processXRef(id, note);
              instance.setContent(html);
            } 
          }).finally(() => {
            instance.enable();
            instance.show();
          });
        }
      } else {
        // See if we can fetch a full url (with no hash to target)
        // This is a special case and we should probably do some content thinning / targeting
        fetch(url)
        .then(res => res.text())
        .then(html => {
          const parser = new DOMParser();
          const htmlDoc = parser.parseFromString(html, "text/html");
          const note = htmlDoc.querySelector('main.content');
          if (note !== null) {
            // This should only happen for chapter cross references
            // (since there is no id in the URL)
            // remove the first header
            if (note.children.length > 0 && note.children[0].tagName === "HEADER") {
              note.children[0].remove();
            }
            const html = processXRef(null, note);
            instance.setContent(html);
          } 
        }).finally(() => {
          instance.enable();
          instance.show();
        });
      }
    }, function(instance) {
    });
  }
      let selectedAnnoteEl;
      const selectorForAnnotation = ( cell, annotation) => {
        let cellAttr = 'data-code-cell="' + cell + '"';
        let lineAttr = 'data-code-annotation="' +  annotation + '"';
        const selector = 'span[' + cellAttr + '][' + lineAttr + ']';
        return selector;
      }
      const selectCodeLines = (annoteEl) => {
        const doc = window.document;
        const targetCell = annoteEl.getAttribute("data-target-cell");
        const targetAnnotation = annoteEl.getAttribute("data-target-annotation");
        const annoteSpan = window.document.querySelector(selectorForAnnotation(targetCell, targetAnnotation));
        const lines = annoteSpan.getAttribute("data-code-lines").split(",");
        const lineIds = lines.map((line) => {
          return targetCell + "-" + line;
        })
        let top = null;
        let height = null;
        let parent = null;
        if (lineIds.length > 0) {
            //compute the position of the single el (top and bottom and make a div)
            const el = window.document.getElementById(lineIds[0]);
            top = el.offsetTop;
            height = el.offsetHeight;
            parent = el.parentElement.parentElement;
          if (lineIds.length > 1) {
            const lastEl = window.document.getElementById(lineIds[lineIds.length - 1]);
            const bottom = lastEl.offsetTop + lastEl.offsetHeight;
            height = bottom - top;
          }
          if (top !== null && height !== null && parent !== null) {
            // cook up a div (if necessary) and position it 
            let div = window.document.getElementById("code-annotation-line-highlight");
            if (div === null) {
              div = window.document.createElement("div");
              div.setAttribute("id", "code-annotation-line-highlight");
              div.style.position = 'absolute';
              parent.appendChild(div);
            }
            div.style.top = top - 2 + "px";
            div.style.height = height + 4 + "px";
            div.style.left = 0;
            let gutterDiv = window.document.getElementById("code-annotation-line-highlight-gutter");
            if (gutterDiv === null) {
              gutterDiv = window.document.createElement("div");
              gutterDiv.setAttribute("id", "code-annotation-line-highlight-gutter");
              gutterDiv.style.position = 'absolute';
              const codeCell = window.document.getElementById(targetCell);
              const gutter = codeCell.querySelector('.code-annotation-gutter');
              gutter.appendChild(gutterDiv);
            }
            gutterDiv.style.top = top - 2 + "px";
            gutterDiv.style.height = height + 4 + "px";
          }
          selectedAnnoteEl = annoteEl;
        }
      };
      const unselectCodeLines = () => {
        const elementsIds = ["code-annotation-line-highlight", "code-annotation-line-highlight-gutter"];
        elementsIds.forEach((elId) => {
          const div = window.document.getElementById(elId);
          if (div) {
            div.remove();
          }
        });
        selectedAnnoteEl = undefined;
      };
        // Handle positioning of the toggle
    window.addEventListener(
      "resize",
      throttle(() => {
        elRect = undefined;
        if (selectedAnnoteEl) {
          selectCodeLines(selectedAnnoteEl);
        }
      }, 10)
    );
    function throttle(fn, ms) {
    let throttle = false;
    let timer;
      return (...args) => {
        if(!throttle) { // first call gets through
            fn.apply(this, args);
            throttle = true;
        } else { // all the others get throttled
            if(timer) clearTimeout(timer); // cancel #2
            timer = setTimeout(() => {
              fn.apply(this, args);
              timer = throttle = false;
            }, ms);
        }
      };
    }
      // Attach click handler to the DT
      const annoteDls = window.document.querySelectorAll('dt[data-target-cell]');
      for (const annoteDlNode of annoteDls) {
        annoteDlNode.addEventListener('click', (event) => {
          const clickedEl = event.target;
          if (clickedEl !== selectedAnnoteEl) {
            unselectCodeLines();
            const activeEl = window.document.querySelector('dt[data-target-cell].code-annotation-active');
            if (activeEl) {
              activeEl.classList.remove('code-annotation-active');
            }
            selectCodeLines(clickedEl);
            clickedEl.classList.add('code-annotation-active');
          } else {
            // Unselect the line
            unselectCodeLines();
            clickedEl.classList.remove('code-annotation-active');
          }
        });
      }
  const findCites = (el) => {
    const parentEl = el.parentElement;
    if (parentEl) {
      const cites = parentEl.dataset.cites;
      if (cites) {
        return {
          el,
          cites: cites.split(' ')
        };
      } else {
        return findCites(el.parentElement)
      }
    } else {
      return undefined;
    }
  };
  var bibliorefs = window.document.querySelectorAll('a[role="doc-biblioref"]');
  for (var i=0; i<bibliorefs.length; i++) {
    const ref = bibliorefs[i];
    const citeInfo = findCites(ref);
    if (citeInfo) {
      tippyHover(citeInfo.el, function() {
        var popup = window.document.createElement('div');
        citeInfo.cites.forEach(function(cite) {
          var citeDiv = window.document.createElement('div');
          citeDiv.classList.add('hanging-indent');
          citeDiv.classList.add('csl-entry');
          var biblioDiv = window.document.getElementById('ref-' + cite);
          if (biblioDiv) {
            citeDiv.innerHTML = biblioDiv.innerHTML;
          }
          popup.appendChild(citeDiv);
        });
        return popup.innerHTML;
      });
    }
  }
});
</script>
<nav class="page-navigation">
  <div class="nav-page nav-page-previous">
      <a href="./multivar.html" class="pagination-link" aria-label="Регрессионные модели с `tidymodels`">
        <i class="bi bi-arrow-left-short"></i> <span class="nav-page-text"><span class="chapter-number">23</span>&nbsp; <span class="chapter-title">Регрессионные модели с <code>tidymodels</code></span></span>
      </a>          
  </div>
  <div class="nav-page nav-page-next">
      <a href="./multiclass.html" class="pagination-link" aria-label="Многоклассовая классификация">
        <span class="nav-page-text"><span class="chapter-number">25</span>&nbsp; <span class="chapter-title">Многоклассовая классификация</span></span> <i class="bi bi-arrow-right-short"></i>
      </a>
  </div>
</nav>
</div> <!-- /content -->




</body></html>